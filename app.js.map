{"version":3,"sources":["webpack:///./src/app.js","webpack:///../jsutils/nice.js","webpack:///../jsutils/gui.js","webpack:///../jsutils/mirrorable.js","webpack:///./src/asset.js","webpack:///../jsutils/tabs.js","webpack:///./src/side-frame.js","webpack:///./src/market-data.js","webpack:///./src/orderbook.js","webpack:///./src/balance.js","webpack:///./src/order.js","webpack:///../jsutils/form.js","webpack:///../jsutils/params.js","webpack:///./src/portfolio.js","webpack:///../jsutils/polyfill.js","webpack:///./src/anchor.js","webpack:///./src/offers.js","webpack:///./src/activity-gui.js","webpack:///./src/portfolio-gui.js","webpack:///./src/asset-gui.js","webpack:///./src/settings-gui.js","webpack:///./src/share-gui.js","webpack:///./src/share.js","webpack:///./src/strategy.js","webpack:///./src/helpers.js","webpack:///./src/footer.js"],"names":["dom","require","Form","Gui","html","Tabs","params","__","global","Portfolio","ActivityGui","PortfolioGui","SettingsGui","ShareGui","isOverflowing","license","welcome","tabs","nav","header","view","main","add","loginForm","select","location","hash","selected","fitScreen","replace","domNode","selector","ledger","addValidator","login","_callee","_regeneratorRuntime","wrap","_context","prev","next","Promise","all","__webpack_require__","e","then","t","bind","default","sent","setInfo","connect","loginAddressBox","value","publicKey","t0","console","error","setError","stop","this","_callee2","address","_args2","arguments","_context2","length","undefined","Error","disconnect","$set","resolve","portfolio","listen","initGui","remove","href","show","autocomplete","ledgerLoginButton","onclick","loginWithLedgerWallet","page","window","scrollTo","module","exports","opts","precision","isNaN","significant","str","String","firstNonZero","search","pointIndex","indexOf","Math","round","precisionAuto","Number","min","max","toFixed","Projectable","ellipsis","_","func","identifier","concat","variable","linkAttribute","obj","src","el","dest","style","substr","tagName","key","event","setTimeout","transformer","link","type","addEventListener","groupEvent","_Projectable","_this","template","values","_classCallCheck","_getPrototypeOf","call","domTree","create","innerHTML","string","expand","content","childNodes","dataset","apply","_toConsumableArray","Object","defineProperty","_assertThisInitialized","enumerable","writable","rewriteNode","attributes","filter","attribute","name","forEach","match","node","for","click","parentNode","insertBefore","nextSibling","uniqueName","childs","push","group","onchange","removeNamedItem","_attribute$value$subs","split","_attribute$value$subs2","_slicedToArray","rewriteAttributes","nodeName","object","currentNode","replacer","trap","rewriteVariable","ref","convert","compute","array","oldNodes","parent","removeChild","Array","entry","expandEllipsis","old","forget","mirror","map","rewriteEllipsis","rewriteTemplate","child","keys","keysFiltered","project","assign","_inherits","counter","srcElement","hiddenKey","setHiddenProperty","trapped","Mirrorable","_Array","_getPrototypeOf2","_len","_key","initTraps","_wrapNativeSuper","_this2","subscribers","x","_this3","exit","i","suppr","_this$trapped","_this4","removed","slice","_len2","objects","_key2","ret","splice","updateTraps","propagate","trigger","makeMethod","method","addFlag","_this$trapped2","_this5","_len3","_key3","extend","reflect","diff","prototype","removeTraps","addTraps","_entry","func1","_entry2","func2","FIAT_BASEURL","FIAT_IMAGEFORMAT","marketData","Orderbook","Asset","id","table","image","info","code","fiats","toLowerCase","cryptos","anchors","balances","offers","shares","balance","anchor","orderbook","forAsset","define","globalPrice","price","_createClass","_getInfo","_asyncToGenerator","mark","abrupt","crypto","small","addChild","reduce","sum","amount","rawLiabilities","buying","selling","refreshPrices","_ref","refreshCryptoPrices","refreshFiatPrices","asset","_x","_callee3","assets","prices","_args3","_context3","_callee4","_args4","_context4","fiat","USD","EUR","CNY","BTC","ETH","XRP","XLM","KIN","BAT","ZRX","BCH","STEEM","SBD","LINK","SLT","MOBI","SHX","RMT","TERN","PEDI","GRAT","REPO","currency","setInterval","log","_Mirrorable","options","_possibleConstructorReturn","Nav","Selector","View","append","Content","index","findIndex","destroy","className","find","generate","TabsContent","option","onselect","component","_Gui","TabsNav","links","tab","_Gui2","TabsSelector","target","selectedOptions","_Gui3","TabsView","SideFrame","url","current","close","title","sandbox","hidden","document","body","htmlOverflow","documentElement","overflow","bodyOverflow","shadow","hide","frameWindow","contentWindow","source","data","position","zIndex","right","top","width","maxWidth","height","border","background","backgroundImage","backgroundRepeat","backgroundPosition","padding","color","fontSize","fontWeight","cursor","borderBottomLeftRadius","firstChild","axios","nice","day","coingeckoCall","get","exchangeratesCall","_callee8","symbols","_args8","_context8","base","join","response","start_at","rates","cacheHistory","localStorage","JSON","stringify","cachedHistory","json","parse","assetHistory","limit","history","list","symbol","toUpperCase","stellarNative","tickers","coin_id","_ref3","localization","market_data","community_data","developer_data","sparkline","_ref4","ids","quote","vs_currencies","assetData","_x2","_ref5","_callee5","_args5","_context5","vs_currency","days","record","time","volume","total_volumes","_x3","_ref6","_callee6","_context6","_x6","_ref7","_callee7","cached","end_at","today","_args7","_context7","Date","toISOString","setDate","getDate","sort","date","getTime","_x7","cosmicLib","StellarSdk","updateOffersPrices","addOrderbook","baseAsset","quoteAsset","native","callBuilder","server","streamOptions","onmessage","ingest","stream","areOffersEquals","bids","normalizeOffers","asks","set","merged","arr","sortOffers","a","b","cumul","row","mergedRow","mergeOffers","array1","array2","side","baseAmount","basePrice","bestBid","bestAsk","spread","findOffer","last","childsNum","offer","findAsk","findBid","Anchor","Balance","entryId","asset_code","asset_issuer","known","buying_liabilities","selling_liabilities","forBalance","issuer","CosmicLink","Order","algorithm","operations","parameters","refresh","share","order","rebalancingStrategy","make","operation","newOperation","getOperation","setOperation","cost","operationDirection","op","minMax","tightenSpread","percentage","clone","refPrice","floorPrice","price_r","n","d","operationsToCosmicLink","operationsToDescription","cosmicLink","memo","accountId","addOperation","odesc","abs","offerId","operationToOdesc","desc","liabilities","outdated","description","tmp1","ask","sellAmount","bid","buyAmount","size","_construct","_loop","env","helpers","form","anim","answer","validator","inputs","submit","validators","t1","done","t2","onExit","addInput","input","required","addNode","element","isForm","infoNode","isEmbedded","hiddenBox","onsubmit","thunk","reset","validate","_setInfo","textContent","timeout","message","firstInput","text","placeHolder","box","placeholder","sessionStorage","password","username","usernameNode","readonly","addPasswordBox","initialState","checkBox","checked","random","htmlFor","continuation","button","file","label","float","rows","nameArray","focus","field","decodeURIComponent","query","encodeURIComponent","replaceState","writeQuery","Offers","testNetwork","horizon","isSupported","new","_resolve","destination","config","isAccountEmpty","account_id","accounts","account","_ingest","getInfo","delegateYield","forPortfolio","total","NodeList","predicate","TypeError","o","len","thisArg","k","kValue","configurable","varArgs","to","nextSource","nextKey","hasOwnProperty","Function","isEnumerable","propertyIsEnumerable","getOwnPropertyNames","O","v","entries","aliases","alias","shorter","USD:GDUKMGUGDZQK6YHYA5Z6AY2G4XDSZPSZ3SW5UN3ARVMO6QSRDWP5YLEX","WSD:GDSVWEA7XV6M5XNLODVTPCGMAJTNBLZBXOFNQD3BNPNYALEYBNT6CE2V","USD:GDSRCV5VTM3U7Y3L6DFRP3PEGBNQMGOWSRTGSBWX6Z3H6C7JHRI4XFJP","USD:GBUYUAI75XXWDZEKLY66CFYKQPET5JR4EENXZBUZ3YXZ7DS56Z4OKOFU","USD:GBSTRUSD7IRX73RQZBL3RQUH6KS3O4NYFY3QCALDLZD77XMZOPWAVTUK","CNY:GAREELUB43IRHWEASCFBLKHURCGMHE5IF6XSE7EXDLACYHGRHM43RFOX","XCN:GCNY5OXYSY4FKHOPT2SPOQZAOEIGXB5LBYW3HVU3OWSTQITS65M5RCNY","BCNY:GBCNYBHAAPDSU3UIHXXQTHYZVSBJBI4YUNWXMKJBCPDHTVYR75G6NFHD","EURT:GAP5LETOV6YIE62YAM56STDANPRDO7ZFDBGSNHJQIYGGKSMOZAHOOS2S","SLT:GCKA6K5PCQ6PNF5RQBF7PQDJWRHO6UOGFMRLK3DYHDOI244V47XKQ4GP","MOBI:GA6HCMBLTZS5VYYBCATRBRZ3BZJMAFUDKYYF6AH6MVCMGWMRDNSWJPIH","SHX:GDSTRSHXHGJ7ZIVRBXEYE5Q74XUVCUSEKEBR7UCHEUUEK72N7I7KJ6JH","RMT:GDEGOXPCHXWFYY234D2YZSPEJ24BX42ESJNVHY5H7TWWQSYRN5ZKZE3N","TERN:GDGQDVO6XPFSY4NMX75A7AOVYCF5JYGW2SHCJJNWCQWIDGOZB53DGP6C","PEDI:GBVUDZLMHTLMZANLZB6P4S4RYF52MVWTYVYXTQ2EJBPBX4DZI2SDOLLY","GRAT:GAJ7V3EMD3FRWAPBEJAP7EC4223XI5EACDZ46RFMY5DYOMCIMWEFR5II","REPO:GCZNF24HPMYTV6NOEHI7Q5RJFFUI23JKUKY3H3XTQAFBQIBOHD5OXG3B","BTC:GBSTRH4QOTWNSVA6E4HFERETX4ZLSR3CIUBLK7AXYII277PFJC4BBYOG","BTC:GATEMHCCKCY67ZUCKTROYN24ZYT5GK4EQZ65JJLDHKHRUZI3EUEKMTCH","BTC:GAUTUYY2THLF7SGITDFMXJVYH3LHDSMGEAKSBU267M2K7A3W543CKUEF","BTC:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P","BTC:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5","ETH:GBSTRH4QOTWNSVA6E4HFERETX4ZLSR3CIUBLK7AXYII277PFJC4BBYOG","ETH:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P","ETH:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5","ETH:GBETHKBL5TCUTQ3JPDIYOZ5RDARTMHMEKIO2QZQ7IOZ4YC5XV3C2IKYU","ETH:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR","LTC:GC5LOR3BK6KIOK7GKAUD5EGHQCMFOGHJTC7I3ELB66PTDFXORC2VM5LP","LTC:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5","LTC:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P","XRP:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5","XRP:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P","KIN:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR","BAT:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR","ZRX:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR","BCH:GAEGOS7I6TYZSVHPSN76RSPIVL3SELATXZWLFO4DIAFYJF7MPAHFE7H4","STEEM:GB3KBOFUCVTWEZ7YIZ7PAKLQMKPCTGWU3LOMANMCT7V6I3AAK4USTEEM","SBD:GB3KBOFUCVTWEZ7YIZ7PAKLQMKPCTGWU3LOMANMCT7V6I3AAK4USTEEM","LINK:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR","loopcall","Offer","intern","recordToId","rawPrice","update","opened","records","rawAmount","last_modified_time","assetToId","ActivityOffers","globalCurrency","network","uri","ActivityOffer","toLocaleDateString","number","Orders","_Gui4","ActivityOrders","Transfers","_Gui5","ActivityTransfers","Highcharts","AssetGui","summary","Summary","coingecko","chart","Chart","makeAssetPoint","assetPoint","y","niceAmount","nicePrice","PortfolioSummary","Table","Graph","PortfolioTable","assetsGui","assetGui","simpleView","detailledView","PortfolioGraph","makePie","showInLegend","legend","dataLabels","enabled","innerWidth","format","align","verticalAlign","layout","distance","container","backgroundColor","colors","tooltip","pointFormat","plotOptions","pie","allowPointSelect","animation","point","events","legendItemClick","series","colorByPoint","ignoreHiddenPoint","credits","PortfolioChart","_this6","makeChart","stockChart","rangeSelector","yAxis","labels","resize","offset","msg","cell","amounts","priceDetails","feed","anchorName","simple","class","anchorTotal","anchorHeader","reload","i18n","Share","RebalanceGui","errors","modified","hideRebalance","hideApply","setupGui","Setup","toString","listOperations","remaining","pop","RebalanceTable","sortShares","shareGui","goal","descriptionToList","ShareSetup","assetName","mode","switchMode","strategy","rebalance","fromString","isValid","hasChanged","beautify","toTemplate","root","fromTemplate","delta","used","computed","strat","targets","space","makeTotal100","scrollHeight","clientHeight","scrollWidth","clientWidth","MYPUBKEY","Footer","icons","Icon","svg","donateIcon","prompt","confirm","demoConfig","footer","displayDemo","displayLicense","displayAbout"],"mappings":"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","file":"app.js","sourcesContent":["\"use_strict\"\n/**\n * Login interface\n */\nconst dom = require(\"@cosmic-plus/jsutils/dom\")\nconst Form = require(\"@cosmic-plus/jsutils/form\")\nconst Gui = require(\"@cosmic-plus/jsutils/gui\")\nconst html = require(\"@cosmic-plus/jsutils/html\")\nconst Tabs = require(\"@cosmic-plus/jsutils/tabs\")\nconst params = require(\"@cosmic-plus/jsutils/params\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst global = require(\"./global\")\nconst Portfolio = require(\"./portfolio\")\n\nconst ActivityGui = require(\"./activity-gui\")\nconst PortfolioGui = require(\"./portfolio-gui\")\nconst SettingsGui = require(\"./settings-gui\")\nconst ShareGui = require(\"./share-gui\")\nconst { isOverflowing } = require(\"./helpers\")\n\nrequire(\"./footer\")\n\n/**\n * License\n */\n\nconst license = new Gui(`\n<section><h2>License</h2>\n  <section><h3>MIT License</h3>\n\n  <p>Copyright (c) 2019 Antoine Bodin &lt;<a\n  href=\"mailto:mister.ticot@cosmic.plus\">mister.ticot@cosmic.plus</a>&gt;</p>\n\n  <p>Permission is hereby granted, free of charge, to any person obtaining a\n  copy of this software and associated documentation files (the \"Software\"), to\n  deal in the Software without restriction, including without limitation the\n  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n  sell copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:</p>\n\n  <p>The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.</p>\n\n  <p>THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\n  FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\n  COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\n  IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>\n`)\n\n/**\n * Beta 1 Welcome\n */\n\nconst welcome = new Gui(`\n<section><h2>February, 16th − Beta 1 Release</h2>\n  <section><h3>Welcome!</h3>\n\n    <p>Equilibre.io is a portfolio balancer for the Stellar Decentralized\n    EXchange. Define how you want to split your portfolio, and it will help you\n    maintaining the balance. (i.e.: 1/4 Bitcoin, 1/4 Lumens, 1/4 US Dollars, 1/4\n    Renmibi)</p>\n\n    <p>Regularly balancing an investment portfolio is known to boost its\n    performances, providing you choose wisely the assets to bet on. Equilibre.io\n    also let you spread your position over several anchors, for a better fund\n    safety.</p>\n\n    <p>Equilibre.io is still under testing & development. If you use it now,\n    I'll ask you to consider yourself as a tester. Please report any bug you\n    could encounter, and double-check transactions before signing them.</p>\n\n    <p>Your feedback matters to me and will be listened to.</p>\n\n    <p>Respectfully, <br>MisterTicot</p>\n\n  </section>\n\n  <section><h3>To Be Implemented</h3>\n    <ul>\n      <li>Interface to add/remove assets</li>\n      <li>Portfolio historic value</li>\n      <li>Customizable rebalancing periodicity</li>\n      <li>Better position spreading over anchors</li>\n      <li>Pie graph for rebalancing tab</li>\n    </ul>\n  </section>\n\n  <section><h3>Known Limitations</h3>\n    <ul>\n\n      <li>It is required to \"Cancel All\" offers between applying a new balance\n      setup</li>\n\n      <li>When setting up a position \"by amount\", the algorithm will not pick\n      the exact amount but will try to make profit by providing small amount of\n      liquidity. (Which is bad)</li>\n\n      <li>There may be a delay between validating a rebalancing operation &\n      having the interface reflecting it.</li>\n\n    </ul>\n  </section>\n</section>\n`)\n\n/**\n * Init\n */\nconst tabs = global.tabs = new Tabs({ nav: dom.header, view: dom.main })\ntabs.add(\"#welcome\", __(\"Welcome\"), welcome)\ntabs.add(\"#login\", __(\"Login\"), dom.loginForm)\ntabs.add(\"#license\", null, license)\ntabs.add(\"#about\", null, welcome)\n\ntabs.select(location.hash)\nif (!tabs.selected) tabs.select(\"#welcome\")\n\ntabs.fitScreen = function () {\n  if (isOverflowing(dom.header)) {\n    html.replace(tabs.nav.domNode, tabs.selector.domNode)\n  }\n}\ntabs.fitScreen()\n\nconst loginForm = new Form(dom.loginForm).addValidator(login)\nhtml.show(dom.loginForm)\ndom.loginForm.autocomplete = \"on\"\nif (params.address) {\n  tabs.select(\"#login\")\n  dom.loginAddressBox.value = params.address\n  login()\n} else {\n  dom.ledgerLoginButton.onclick = () => loginWithLedgerWallet()\n}\n\ntabs.listen(\"select\", page => {\n  location.hash = page\n  window.scrollTo(0, 0)\n})\n\n/**\n * Functions\n */\n\nlet ledger\nasync function loginWithLedgerWallet () {\n  ledger = await getLedgerModule()\n  loginForm.setInfo(__(\"Please open the Stellar App in your Ledger Wallet\"))\n  try {\n    await ledger.connect()\n    dom.loginAddressBox.value = ledger.publicKey\n    login()\n  } catch (error) {\n    console.error(error)\n    loginForm.setError(error)\n  }\n}\n\nasync function login (address = dom.loginAddressBox.value) {\n  if (!address) throw new Error(__(\"Please enter an address.\"))\n  if (ledger) ledger.disconnect()\n\n  loginForm.setInfo(__(\"Connecting to your account...\"))\n  params.$set({ address })\n\n  try {\n    global.portfolio = await Portfolio.resolve(address)\n    global.portfolio.listen(\"open\", initGui)\n  } catch (error) {\n    console.error(error)\n    loginForm.setError(error)\n  }\n}\n\nfunction initGui () {\n  const portfolio = global.portfolio\n\n  const selected = location.hash\n  tabs.remove(\"#welcome\")\n  tabs.remove(\"#login\")\n  tabs.add(\"#portfolio\", __(\"Portfolio\"), new PortfolioGui(portfolio))\n  tabs.add(\"#rebalance\", __(\"Rebalance\"), new ShareGui(portfolio))\n  tabs.add(\"#activity\", __(\"Activity\"), new ActivityGui(portfolio))\n  tabs.add(\"#settings\", __(\"Settings\"), new SettingsGui())\n  tabs.add(\"#logout\", __(\"Logout\"), () => {\n    location.replace(location.href.replace(/\\?.*$/, \"#login\"))\n  })\n  tabs.fitScreen()\n\n  tabs.select(selected)\n  if (!tabs.selected) tabs.select(\"#portfolio\")\n}\n\n/**\n * Module loading\n */\n\nfunction getLedgerModule () {\n  return import(/* webpackChunkName: \"ledger\" */ \"@cosmic-plus/ledger-wallet\").then(\n    ledger => ledger.default\n  )\n}\n","\"use_strict\"\n/**\n * Nice formating of numbers.\n *\n * @example\n * nice(35)                     // => 35.00\n * nice(35, 4)                  // => 35.0000\n * nice(35, { significant: 2})  // => 35\n * nice(35, { min: 3 })         // => 35.000\n * nice(35, { max: 1 })         // => 35.0\n *\n * @param  {String|Number} value The value to format\n * @param  {Number} [precision] Short form for `options.precision`\n * @param  {Object} [options]\n * @param  {Number} [options.precision=null] How much digit after the dot.\n *     Override options.significant.\n * @param  {Number} [options.significant=4] How much significant numbers (+/-\n *     one).\n * @param  {Number} [options.min=null] Minimum number of digits after the dot.\n * @param  {Number} [options.max=null] Maximum number of digits after the dot.\n * @return {String} The formatted value\n */\nmodule.exports = function (value, opts = {}) {\n  if (typeof opts === \"number\") opts = { precision: opts }\n\n  if (value === undefined || isNaN(value)) return \"...\"\n  else if (value == 0) return 0\n\n  let precision = opts.precision || precisionAuto(Number(value), opts)\n  if (opts.min) precision = Math.max(opts.min, precision)\n  if (opts.max) precision = Math.min(opts.max, precision)\n  return Number(value).toFixed(precision)\n}\n\nfunction precisionAuto (value, opts) {\n  if (!opts.significant) opts.significant = 4\n  let precision = 0\n\n  const str = String(value)\n  const firstNonZero = str.search(/[^0.]/)\n  if (firstNonZero) {\n    precision = firstNonZero + opts.significant - 2\n  } else {\n    const pointIndex = str.indexOf(\".\")\n    if (pointIndex === -1) {\n      precision = opts.significant - str.length\n    } else if (pointIndex < opts.significant) {\n      precision = opts.significant - pointIndex\n    }\n  }\n\n  if (precision) precision = Math.round(precision / 2) * 2\n  return precision > 0 ? precision : 0\n}\n","\"use_strict\"\n/**\n * Component-driven GUI Development\n *\n * API:\n *\n * Reference: -ref=%alias\n * Group:     -group=%alias\n * Label:     -label=\"text\"\n *\n * Attribute: %attr | attr=%alias | attr=%func:alias\n * Content: %alias | %func:alias | %{alias} | %{func:alias}\n *          %alias... | %func:alias... | %{alias...} | %{func:alias...}\n * Escape: \\%example | \\%{example}\n */\n\nconst html = require(\"./html\")\nconst Projectable = require(\"./projectable\")\n\n/**\n * Class\n */\n\nmodule.exports = class Gui extends Projectable {\n  constructor (template = \"\", values) {\n    super()\n    const domTree = html.create(\"template\")\n    domTree.innerHTML = expand(\n      template.replace(/^[\\s\\n]*/, \"\").replace(/[\\s\\n]*$/, \"\")\n    )\n\n    // IE doesn't use .content for template tag\n    const content = domTree.content || domTree\n    if (\n      content.childNodes.length > 1\n      || content.childNodes[0].dataset.type === \"ellipsis\"\n    ) {\n      this.domNode = html.create(\"div\", null, ...content.childNodes)\n    } else {\n      this.domNode = content.childNodes[0]\n    }\n\n    Object.defineProperty(this, \"domNode\", {\n      enumerable: false,\n      writable: false\n    })\n\n    rewriteNode(this, this.domNode)\n\n    if (values) {\n      const keys = Object.keys(this)\n      const keysFiltered = keys.filter(key => key !== \"style\")\n      if (values instanceof Projectable) values.project(keysFiltered, this)\n      else keysFiltered.forEach(key => this[key] = values[key])\n      if (keys.indexOf(\"style\") !== -1) Object.assign(this.style, values.style)\n    }\n\n    this.listen(\"destroy\", () => this.domNode.innerHTML = null)\n  }\n}\n\n/**\n * Parser\n */\n\nfunction expand (template) {\n  return (\n    template\n      // firefox fix\n      .replace(/\\s(on\\w+)=(%\\w+)/g, \" .$1=$2\")\n      // Apply only on content outside of HTML tags.\n      .replace(/(^|>)[^<>]*(<|$)/g, string =>\n        string\n          // %function:identifier...\n          .replace(/%(\\w+):(\\w+)\\.\\.\\./g, ellipsis)\n          // %identifier...\n          .replace(/%()(\\w+)\\.\\.\\./g, ellipsis)\n          // %{function:identifier...}\n          .replace(/%{(\\w+):(\\w+)\\.\\.\\.}/g, ellipsis)\n          // %{identifier...}\n          .replace(/%{()(\\w+)\\.\\.\\.}/g, ellipsis)\n          // %function:identifier\n          .replace(/%(\\w+):(\\w+)/g, variable)\n          // %identifier\n          .replace(/%()(\\w+)/g, variable)\n          // %{function:identifier}\n          .replace(/%{(\\w+):(\\w+)}/g, variable)\n          // %{identifier}\n          .replace(/%{()(\\w+)}/g, variable)\n      )\n  )\n}\n\nfunction ellipsis (_, func, identifier) {\n  return `<template data-type=\"ellipsis\" data-func=\"${func}\">${identifier}</template>`\n}\n\nfunction variable (_, func, identifier) {\n  return `<template data-type=\"variable\" data-func=\"${func}\">${identifier}</template>`\n}\n\n/**\n * Rewriter\n */\n\nfunction rewriteNode (obj, el) {\n  if (el.attributes) rewriteAttributes(obj, el)\n  if (el.nodeName === \"TEMPLATE\") rewriteTemplate(obj, el)\n  el.childNodes.forEach(child => rewriteNode(obj, child))\n}\n\nfunction rewriteAttributes (obj, el) {\n  Object.values(el.attributes)\n    .filter(attribute => attribute.name)\n    .forEach(attribute => {\n      if (attribute.name === \"-ref\" && attribute.value.match(/^%\\w+$/)) {\n        obj[attribute.value.substr(1)] = el\n      } else if (attribute.name === \"-label\") {\n        const node = html.create(\n          \"label\",\n          { for: el, onclick: () => el.click() },\n          html.create(\"span\", null, attribute.value)\n        )\n        el.parentNode.insertBefore(node, el.nextSibling)\n        // TODO: better aliases for -group\n      } else if (\n        attribute.name === \"-group\"\n        && attribute.value.match(/^%\\w+$/)\n      ) {\n        const key = attribute.value.substr(1)\n        if (!obj[key]) obj[key] = { name: uniqueName(), childs: [] }\n        obj[key].childs.push(el)\n        el.group = obj[key]\n        el.name = obj[key].name\n        el.onchange = groupEvent\n      } else if (attribute.name.match(/^%\\w+$/)) {\n        const src = attribute.name.substr(1)\n        linkAttribute(obj, src, el, src)\n        el.attributes.removeNamedItem(attribute.name)\n      } else if (attribute.value.match(/^%\\w+:\\w+$/)) {\n        const dest = attribute.name\n        const [func, src] = attribute.value.substr(1).split(\":\")\n        linkAttribute(obj, src, el, dest, obj[func].bind(obj))\n      } else if (attribute.value.match(/^%\\w+$/)) {\n        const dest = attribute.name\n        const src = attribute.value.substr(1)\n        linkAttribute(obj, src, el, dest)\n      }\n    })\n}\n\nfunction linkAttribute (obj, src, el, dest, func) {\n  if (dest === \"class\") dest = \"className\"\n  if (dest === \"style\") obj[src] = el.style\n  if (dest.substr(0, 3) === \".on\") dest = dest.substr(1)\n\n  // Make sure two-way binding happens before onchange/onclick event.\n  // TODO: check if a clearer way exists.\n  if (\n    (el.tagName === \"INPUT\" || el.tagName === \"SELECT\")\n    && dest.substr(0, 2) === \"on\"\n  ) {\n    const key = dest\n    dest = `.${dest}`\n    el[key] = event => setTimeout(() => el[dest] && el[dest](event), 1)\n  }\n\n  const transformer = func ? func.bind(obj) : functionBinder.bind(obj)\n  obj.link(src, el, dest, transformer, null, true)\n\n  // Two-ways binding.\n  if (\n    el.tagName === \"SELECT\"\n    && (dest === \"value\" || dest === \"selectedIndex\" || dest === \"selectedOptions\")\n  ) {\n    el.addEventListener(\"change\", () => obj[src] = el[dest])\n  } else if (\n    el.tagName === \"INPUT\"\n    && el.type !== \"radio\"\n    && (el.type !== \"checkbox\" && dest === \"value\"\n      || el.type === \"checkbox\" && dest === \"checked\")\n  ) {\n    el.addEventListener(\"change\", () => obj[src] = el[dest])\n  } else if (\n    el.tagName === \"INPUT\"\n    && el.type === \"radio\"\n    && dest === \"checked\"\n  ) {\n    el.addEventListener(\"change\", event => {\n      obj[src] = el[dest]\n      groupEvent(event)\n    })\n  }\n}\n\nfunction rewriteTemplate (object, el) {\n  if (el.dataset.type === \"variable\") rewriteVariable(object, el)\n  else if (el.dataset.type === \"ellipsis\") rewriteEllipsis(object, el)\n}\n\nfunction rewriteVariable (object, el) {\n  let currentNode = el\n\n  const key = el.innerHTML\n  const func = el.dataset.func && object[el.dataset.func].bind(object)\n  const replacer = func\n    ? () => currentNode = html.replace(currentNode, func(object[key]))\n    : () => currentNode = html.replace(currentNode, object[key])\n\n  object.trap(key, replacer, null, true)\n\n  // Two-way binding\n  // if (parent.tagName === \"TEXTAREA\" &&)\n}\n\nfunction rewriteEllipsis (obj, el) {\n  const key = el.innerHTML\n  const func = el.dataset.func && obj[el.dataset.func].bind(obj)\n\n  let ellipsis = [],\n    ref = html.convert(\"\")\n  html.replace(el, ref)\n  const compute = array => {\n    ellipsis = expandEllipsis(ref, ellipsis, array)\n  }\n\n  const update = function (event) {\n    // TODO: better memory management\n    if (event.old && typeof event.old.forget === \"function\") {\n      event.old.forget(\"change\", compute)\n    }\n    if (event.value && typeof event.value.mirror === \"function\") {\n      if (func) event.value.mirror(func.bind(this)).listen(\"change\", compute)\n      else event.value.listen(\"change\", compute)\n    }\n    if (func && event.value) compute(event.value.map(func))\n    else compute(event.value)\n  }\n  obj.trap(key, update, null, true)\n}\n\nfunction expandEllipsis (ref, oldNodes, array = []) {\n  const parent = ref.parentNode\n  oldNodes.forEach(node => {\n    if (node.parentNode === parent) {\n      parent.removeChild(node)\n    }\n  })\n\n  if (!(array instanceof Array)) array = [array]\n  const ellipsis = []\n  array.forEach(entry => {\n    const node = html.convert(entry)\n    ellipsis.push(node)\n    parent.insertBefore(node, ref)\n  })\n\n  return ellipsis\n}\n\n/**\n * Helpers\n */\n\nconst uniqueName = (function () {\n  let counter = 0\n  return function () {\n    counter++\n    return `group.${counter}`\n  }\n})()\n\nfunction groupEvent (event) {\n  if (!event) return\n  const el = event.srcElement\n  el.group.value = el.value\n  el.group.childs.forEach(child => {\n    if (child !== el && child.onchange) child.onchange()\n  })\n}\n\nfunction functionBinder (value) {\n  if (typeof value === \"function\") return value.bind(this)\n  else return value\n}\n","\"use_strict\"\n/**\n * Mirrorable arrays\n */\n\nconst hiddenKey = require(\"./misc\").setHiddenProperty\nconst Projectable = require(\"./projectable\")\n\nconst trapped = Projectable.trapped\n\nconst Mirrorable = module.exports = class Mirrorable extends Array {\n  constructor (...params) {\n    super(...params)\n    hiddenKey(this, trapped, [])\n    hiddenKey(this, \"subscribers\", [])\n    initTraps(this)\n  }\n\n  mirror (func) {\n    const array = new Mirrorable()\n    this.subscribers.push([array, func])\n    this.project(\"*\", array, func)\n    array.trap(\"*\")\n    hiddenKey(array, \"destroy\", () => {\n      this.subscribers = this.subscribers.filter(x => x[0] !== array)\n    })\n    return array\n  }\n\n  feed (object, key, func) {\n    const compute = func\n      ? () => object[key] = func(this)\n      : () => object[key] = this\n    this.listen(\"change\", compute)\n    compute()\n  }\n\n  guard (params) {\n    if (params.exit) this.listen(\"remove\", params.exit)\n    if (params.entry) {\n      this.listen(\"add\", params.entry)\n      this.forEach(value => params.entry(value))\n    }\n  }\n\n  splice (i, suppr, ...objects) {\n    if (this.length > this[trapped].length) initTraps(this)\n    const removed = this.slice(i, suppr)\n    const ret = this[trapped].splice(i, suppr, ...objects)\n    updateTraps(this)\n    propagate(this, objects, (array, values) => {\n      array.splice(i, suppr, ...values)\n    })\n    removed.forEach(value => this.trigger(\"remove\", value))\n    objects.forEach(value => this.trigger(\"add\", value))\n    this.trigger(\"change\")\n    return ret\n  }\n}\n\nProjectable.extend(Mirrorable)\n\n/**\n * Methods that must to be reflected to subscribers\n */\n\nfunction makeMethod (method, addFlag) {\n  return function (...params) {\n    if (this.length > this[trapped].length) initTraps(this)\n    const ret = this[trapped][method](...params)\n    updateTraps(this)\n    propagate(this, params, (array, values) => array[method](...values))\n    this.trigger(\"change\")\n    if (addFlag) params.forEach(value => this.trigger(\"add\", value))\n    else this.trigger(\"remove\", ret)\n    return ret\n  }\n}\n\nconst methods1 = [\"push\", \"unshift\"]\nconst methods2 = [\"pop\", \"shift\"]\nmethods1.forEach(\n  method => Mirrorable.prototype[method] = makeMethod(method, true)\n)\nmethods2.forEach(method => Mirrorable.prototype[method] = makeMethod(method))\n\n/**\n * Helpers\n */\n\nfunction initTraps (obj) {\n  obj.forEach((_, key) => obj.trap(String(key), reflect, null, true))\n}\n\nfunction updateTraps (obj) {\n  const diff = obj[trapped].length - obj.length\n  if (diff < 0) removeTraps(obj)\n  else if (diff > 0) addTraps(obj)\n}\n\nfunction addTraps (obj) {\n  for (let key = obj.length; key < obj[trapped].length; key++) {\n    obj[key] = obj[trapped][key]\n    delete obj[trapped][key]\n    obj.trap(String(key), reflect, null, true)\n  }\n}\n\nfunction removeTraps (obj) {\n  for (let key = obj[trapped].length; key < obj.length; key++) {\n    obj.forget(`change:${key}`)\n  }\n  Array.prototype.splice.call(\n    obj,\n    obj[trapped].length,\n    obj.length - obj[trapped].length\n  )\n}\n\nfunction reflect (event) {\n  const { object, key, value } = event\n  object.subscribers.forEach(entry => {\n    const [array, func] = entry\n    array[key] = func ? func(value) : value\n  })\n}\n\nfunction propagate (object, params, func1) {\n  object.subscribers.forEach(entry => {\n    const [array, func2] = entry\n    const values = func2 && params ? params.map(func2) : params\n    func1(array, values)\n  })\n}\n","\"use_strict\"\n/**\n * Asset class\n */\n\nconst AUTO_REFRESH_PRICES = true\nconst CRYPTO_PRICES_REFRESH_DELAY = 60 * 1000\nconst FIAT_PRICES_REFRESH_DELAY = 60 * 60 * 1000\nconst FIAT_BASEURL = \"https://www.xe.com/themes/xe/images/flags/svg/\"\nconst FIAT_IMAGEFORMAT = \".svg\"\n\nconst Mirrorable = require(\"@cosmic-plus/jsutils/mirrorable\")\nconst Projectable = require(\"@cosmic-plus/jsutils/projectable\")\n\nconst global = require(\"./global\")\nconst marketData = require(\"./market-data\")\nconst Orderbook = require(\"./orderbook\")\n\n/**\n * Class\n */\n\nconst Asset = module.exports = class Asset extends Projectable {\n  static resolve (id) {\n    return Asset.table[id] || new Asset(id)\n  }\n\n  constructor (id) {\n    super()\n\n    this.id = id\n    Asset.table[id] = this\n\n    // Empty image by default\n    this.image = \"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=\"\n\n    if (Asset.info[id]) {\n      this.code = id\n      Object.assign(this, Asset.info[id])\n      if (this.type === \"fiat\") {\n        Asset.fiats.push(this)\n        this.image = `${FIAT_BASEURL}${id.toLowerCase()}${FIAT_IMAGEFORMAT}`\n      } else {\n        Asset.cryptos.push(this)\n        this.type = \"crypto\"\n      }\n    } else {\n      this.code = id.replace(/:.*/, \"\")\n      this.name = this.code\n      this.type = \"unknown\"\n    }\n\n    this.anchors = new Mirrorable()\n    this.balances = new Mirrorable()\n    this.offers = new Mirrorable()\n    this.shares = new Mirrorable()\n\n    this.balances.mirror(balance => {\n      this.anchors.push(balance.anchor)\n      balance.trap(\"amount\", () => this.compute(\"amount\"))\n      balance.trap([\"buying\", \"selling\"], () => this.compute(\"liabilities\"))\n    })\n\n    this.orderbook = Orderbook.forAsset(this)\n    this.define(\"price\", \"globalPrice\", () => {\n      return this.globalPrice || this.orderbook.price\n    })\n    this.orderbook.trap(\"price\", () => this.compute(\"price\"))\n  }\n\n  async getInfo () {\n    // Happens once & only for cryptos.\n    if (this.name || this.type !== \"crypto\") return\n    this.info = await marketData.crypto.info(this)\n    this.name = this.info.name\n    this.image = this.info.image.small\n  }\n\n  addOrderbook (orderbook) {\n    this.orderbook.addChild(orderbook)\n  }\n}\n\nAsset.define(\"amount\", \"balances\", function () {\n  return this.balances && this.balances.reduce((sum, el) => sum + el.amount, 0)\n})\n\nAsset.define(\"value\", [\"amount\", \"price\"], function () {\n  return this.amount === 0 ? 0 : this.amount * this.price\n})\n\nAsset.define(\"liabilities\", [\"balances\", \"price\"], function () {\n  if (this.balances) {\n    const rawLiabilities = this.balances.reduce(\n      (sum, entry) => sum + entry.buying - entry.selling,\n      0\n    )\n    return this.price * rawLiabilities\n  }\n})\n\nAsset.define(\"isSupported\", [\"type\", \"price\"], function () {\n  return this.type !== \"unknown\" || this.price\n})\n\n/**\n * Utilities\n */\n\nAsset.refreshPrices = async function (array) {\n  if (!array) {\n    await Asset.refreshCryptoPrices()\n    await Asset.refreshFiatPrices()\n  } else {\n    await Asset.refreshCryptoPrices(\n      array.filter(asset => asset.type === \"crypto\").map(asset => asset.code)\n    )\n    await Asset.refreshFiatPrices(\n      array.filter(asset => asset.type === \"fiat\").map(asset => asset.code)\n    )\n  }\n}\n\nAsset.refreshCryptoPrices = async function (assets = Asset.cryptos) {\n  if (!assets.length) return\n  const prices = await marketData.crypto.prices(assets)\n  assets.forEach(asset => asset.globalPrice = prices[asset.code])\n}\n\nAsset.refreshFiatPrices = async function (fiats = Asset.fiats) {\n  if (!fiats.length) return\n  const prices = await marketData.fiat.prices(fiats)\n  fiats.forEach(asset => asset.price = asset.globalPrice = prices[asset.code])\n}\n\n/**\n * Known Assets\n */\n\nAsset.info = {\n  USD: { type: \"fiat\", name: \"US Dollar\" },\n  EUR: { type: \"fiat\", name: \"Euro\" },\n  CNY: { type: \"fiat\", name: \"Renminbi\" },\n\n  BTC: { id: \"bitcoin\" },\n  ETH: { id: \"ethereum\" },\n  XRP: { id: \"ripple\" },\n  XLM: { id: \"stellar\" },\n  KIN: { id: \"kin\" },\n  BAT: { id: \"basic-attention-token\" },\n  ZRX: { id: \"0x\" },\n  BCH: { id: \"bitcoin-cash\" },\n  STEEM: { id: \"steem\" },\n  SBD: { id: \"steem-dollar\" },\n  LINK: { id: \"chainlink\" },\n\n  SLT: { id: \"smartlands\" },\n  MOBI: { id: \"mobius\" },\n  SHX: { id: \"stronghold-token\" },\n  RMT: { id: \"sureremit\" },\n  TERN: { id: \"ternio\" },\n  PEDI: { id: \"pedity\" },\n  GRAT: { id: \"gratz\" },\n  REPO: { id: \"repo\" }\n}\n\n/**\n * Init\n */\n\nAsset.table = {}\nAsset.cryptos = []\nAsset.fiats = []\nnew Asset(global.currency)\n\n// Automatic global price refresh\nif (AUTO_REFRESH_PRICES) {\n  setInterval(Asset.refreshCryptoPrices, CRYPTO_PRICES_REFRESH_DELAY)\n  setInterval(Asset.refreshFiatPrices, FIAT_PRICES_REFRESH_DELAY)\n}\n\n// eslint-disable-next-line no-console\nconsole.log(Asset.table)\n","\"use_strict\"\n/**\n * Generic tabbed browsing Gui.\n */\n\nconst html = require(\"./html\")\nconst Mirrorable = require(\"./mirrorable\")\nconst Gui = require(\"./gui\")\n\nconst Tabs = module.exports = class Tabs extends Mirrorable {\n  constructor (options = {}) {\n    super()\n    this.nav = new Tabs.Nav(this)\n    this.selector = new Tabs.Selector(this)\n    this.view = new Tabs.View(this)\n    if (options.nav) html.append(options.nav, this.nav)\n    if (options.selector) html.append(options.selector, this.selector)\n    if (options.view) html.append(options.view, this.view)\n  }\n\n  add (id, name, content, select) {\n    this.push(new Tabs.Content(this, id, name, content))\n    if (select || !this.selected) this.select(id)\n  }\n\n  remove (id) {\n    const index = this.findIndex(content => content.id === id)\n    const content = this[index]\n    if (this.selected === content) this.select()\n    if (index != null) this.splice(index, 1)\n  }\n\n  clear () {\n    this.splice(0, this.length)\n  }\n\n  select (id) {\n    if (this.selected) {\n      this.selected.destroy()\n      if (this.selected.link) this.selected.link.className = \"\"\n    }\n    const selected = this.find(content => content.id === id)\n    if (selected) {\n      selected.generate()\n      if (selected.link) selected.link.className = \"selected\"\n    }\n    this.selected = selected\n    this.trigger(\"select\", id)\n  }\n}\n\nTabs.Content = class TabsContent {\n  constructor (tabs, id, name, content) {\n    this.id = id\n    this.name = name\n    this.content = content\n    if (content.parentNode && content.parentNode.removeChild) {\n      content.parentNode.removeChild(content)\n    }\n\n    this.select = () => tabs.selected === this || tabs.select(id)\n\n    if (name) {\n      this.link = html.create(\"a\", { onclick: this.select }, name)\n      this.option = html.create(\n        \"option\",\n        { onselect: this.select, value: id },\n        name\n      )\n    }\n  }\n\n  generate () {\n    if (typeof this.content === \"function\") {\n      this.component = this.content()\n      this.domNode = html.convert(this.component)\n    } else if (!this.domNode) {\n      this.domNode = html.convert(this.content)\n    }\n  }\n\n  destroy () {\n    if (this.component && this.component.destroy) this.component.destroy()\n  }\n}\n\nTabs.Nav = class TabsNav extends Gui {\n  constructor (tabs) {\n    super(`<nav class=\"TabsNav\">%links...</nav>`)\n    this.links = tabs.mirror(tab => tab.link)\n  }\n}\n\nTabs.Selector = class TabsSelector extends Gui {\n  constructor (tabs) {\n    super(\n      `<select class=\"TabsSelector\" %onchange value=%selected>%options...</select>`\n    )\n    this.onchange = event => event.target.selectedOptions[0].onselect()\n    this.options = tabs.mirror(content => content.option)\n    tabs.project(\"selected\", this, content => content && content.id)\n  }\n}\n\nTabs.View = class TabsView extends Gui {\n  constructor (tabs) {\n    super(`<div class=\"TabsView\">%content</div>`)\n    tabs.link(\"selected\", this, \"content\", x => x && x.domNode)\n  }\n}\n","\"use_strict\"\n/**\n * Signing Side Frame\n */\nconst html = require(\"@cosmic-plus/jsutils/html\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\n/**\n * Class\n */\n\nclass SideFrame {\n  constructor (url) {\n    if (SideFrame.current) SideFrame.current.close()\n    SideFrame.current = this\n\n    this.domNode = html.create(\"iframe\", {\n      title: \"Signing Frame\",\n      src: url,\n      sandbox: \"allow-same-origin allow-scripts allow-forms allow-popups\",\n      hidden: true\n    })\n    Object.assign(this.domNode.style, SideFrame.style)\n    html.append(document.body, this.domNode)\n\n    this.show()\n  }\n\n  show () {\n    if (!this.domNode.hidden) return\n\n    this.htmlOverflow = document.documentElement.style.overflow\n    this.bodyOverflow = document.body.style.overflow\n    document.documentElement.style.overflow = \"hidden\"\n    document.body.style.overflow = \"hidden\"\n\n    SideFrame.shadow.onclick = () => this.close()\n    SideFrame.close.onclick = () => this.close()\n    html.show(SideFrame.shadow, SideFrame.close, this.domNode)\n  }\n\n  hide () {\n    if (this.domNode.hidden) return\n\n    document.documentElement.style.overflow = this.htmlOverflow\n    document.body.style.overflow = this.bodyOverflow\n\n    SideFrame.shadow.onclick = null\n    html.hide(SideFrame.shadow, SideFrame.close, this.domNode)\n  }\n\n  close () {\n    SideFrame.current = null\n    this.hide()\n    html.destroy(this.domNode)\n  }\n}\n\n/**\n * Event\n */\n\nwindow.addEventListener(\"message\", event => {\n  const frameWindow =\n    SideFrame.current && SideFrame.current.domNode.contentWindow\n\n  if (event.source === frameWindow) {\n    switch (event.data) {\n    case \"show\":\n      SideFrame.current.show()\n      break\n    case \"hide\":\n      SideFrame.current.hide()\n      break\n    case \"close\":\n      SideFrame.current.close()\n      break\n    }\n  }\n})\n\n/**\n * Frame style\n */\n\nSideFrame.style = {\n  position: \"fixed\",\n  zIndex: 998,\n  right: 0,\n  top: 0,\n  width: \"30em\",\n  maxWidth: \"100%\",\n  height: \"100vh\",\n  border: \"0.1em solid hsl(240, 10%, 75%)\",\n  background: \"hsl(240, 40%, 98%)\",\n  backgroundImage: `url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12em\" height=\"12em\" viewBox=\"0 0 18055.55 18055.55\" shape-rendering=\"geometricPrecision\" text-rendering=\"geometricPrecision\" image-rendering=\"optimizeQuality\" fill-rule=\"evenodd\" clip-rule=\"evenodd\"><path d=\"M6184.01 6244.26l-5076.93 5077.09c-1542.18 1542.18-1542.18 4042.74 0 5584.91 1542.18 1542.18 4042.74 1542.18 5584.91 0l5050.06-5050.22c-946.39 926.55-2243.37 1281.63-3458.3 1065.06l-2788.46 2788.46c-881.29 881.29-2310.22 881.29-3191.52 0-881.29-881.29-881.29-2310.22 0-3191.51l2788.62-2788.62 2311.35-2311.19c883.05-858.58 2294.87-850.9 3168.48 22.71 880.17 880.17 881.29 2306.54 3.52 3188.31l2288.31-2288.47c-136.75-767.89-501.74-1503.15-1095.13-2096.54-593.23-593.23-1328.33-958.22-2096.22-1095.13-1271.39-226.64-2574.93 181.38-3488.69 1095.13z\" fill=\"#c1c1c1\"/><path d=\"M11772.44 11825.98l5076.93-5077.09c1542.18-1542.18 1542.18-4042.74 0-5584.91-1542.18-1542.18-4042.74-1542.18-5584.91 0L6214.4 6214.2c946.39-926.56 2243.37-1281.63 3458.3-1065.07l2788.46-2788.46c881.29-881.29 2310.22-881.29 3191.52 0 881.29 881.29 881.29 2310.22 0 3191.52l-2788.62 2788.62L10552.71 10652c-883.05 858.57-2294.87 850.9-3168.48-22.71-880.17-880.17-881.29-2306.55-3.52-3188.31L5092.4 9729.45c136.75 767.89 501.74 1503.15 1095.13 2096.54 593.23 593.23 1328.33 958.22 2096.22 1095.13 1271.39 226.64 2574.93-181.37 3488.69-1095.13z\" fill=\"#9f9f9f\"/><path d=\"M12651.33 7587.95l-1418.38 1418.38c7.84 577.72-204.89 1157.83-638.02 1603.44l2269.12-2268.96c-45.58-255.91-116.44-508.14-212.72-752.85zm-909.28 4268.09c-810.76 793.48-1919.32 1194.94-3038.77 1116.89-139.79-9.76-279.9-26.87-419.53-51.82l-509.1 509.1c365.47 95.48 749.17 146.35 1144.56 146.35 448 0 880.65-65.26 1289.15-186.81l1533.7-1533.7z\" fill=\"#a6a6a6\"/><path d=\"M6214.4 6214.2c810.76-793.48 1919.32-1194.94 3038.77-1116.89 139.79 9.76 279.9 26.87 419.53 51.82l439.2-439.2c-379.87-103.8-779.89-159.3-1192.7-159.3-416.81 0-820.35 56.46-1203.57 162.34L6214.4 6214.2zm509.1 2788.78c7.36-557.41 220.08-1112.57 638.02-1542.5L5092.4 9729.44c42.87 240.56 108.12 478.07 195.77 708.87L6723.5 9002.98z\" fill=\"#888888\"/></svg>')`,\n  backgroundRepeat: \"no-repeat\",\n  backgroundPosition: \"center\",\n  padding: 0\n}\n\n/**\n * Closing button\n */\n\nSideFrame.close = html.create(\"span\", { hidden: true }, `× ${__(\"Close\")}`)\nObject.assign(SideFrame.close.style, {\n  position: \"fixed\",\n  zIndex: 999,\n  top: \"0.1em\",\n  right: \"0.1em\",\n  color: \"hsl(0, 0%, 40%)\",\n  fontSize: \"0.9em\",\n  fontWeight: \"bold\",\n  cursor: \"pointer\",\n  background: \"hsl(0, 0%, 95%)\",\n  borderBottomLeftRadius: \"0.1em\",\n  padding: \"0.1em 0.3em\"\n})\ndocument.body.insertBefore(SideFrame.close, document.body.firstChild)\n\n/**\n * Shadow Layer\n */\n\nSideFrame.shadow = html.create(\"div\", { hidden: true })\nObject.assign(SideFrame.shadow.style, {\n  position: \"fixed\",\n  zIndex: 997,\n  top: 0,\n  width: \"100%\",\n  height: \"100%\",\n  background: \"rgba(0,0,0,0.2)\"\n})\ndocument.body.insertBefore(SideFrame.shadow, document.body.firstChild)\n\n/**\n * Export\n */\n\nmodule.exports = SideFrame\n","\"use_strict\"\n/**\n * Markets statistics & data\n *\n * @exports marketData\n */\nconst marketData = exports\n\nconst axios = require(\"@cosmic-plus/base/axios\")\nconst nice = require(\"@cosmic-plus/jsutils/nice\")\nconst { day } = require(\"@cosmic-plus/jsutils/misc\")\n\nconst global = require(\"./global\")\n\n/**\n * Generic price/history\n */\n\nmarketData.assetHistory = function (asset, limit = 1000) {\n  if (asset.type === \"crypto\") return marketData.crypto.history(asset, limit)\n  else if (asset.type === \"fiat\") return marketData.fiat.history(asset, limit)\n}\n\n/**\n * Crypto price/history by \"https://www.coingecko.com\"\n */\n\nmarketData.crypto = {}\n\nfunction coingeckoCall (page, params) {\n  return axios.get(`https://api.coingecko.com/api/v3/${page}`, { params })\n}\n\nmarketData.crypto.list = async function () {\n  const response = await coingeckoCall(\"coins/list\")\n  const list = {}\n  response.data.forEach(entry => {\n    const symbol = entry.symbol.toUpperCase()\n    list[symbol] = { id: entry.id, name: entry.name }\n  })\n  return list\n}\n\nmarketData.crypto.stellarNative = async function () {\n  const response = await coingeckoCall(\"exchanges/stellar_term\")\n  return response.data.tickers.map(x => x.coin_id).filter(x => x)\n}\n\nmarketData.crypto.info = async function (asset) {\n  const response = await coingeckoCall(`coins/${asset.id}`, {\n    localization: false,\n    tickers: false,\n    market_data: false,\n    community_data: false,\n    developer_data: false,\n    sparkline: false\n  })\n  return response.data\n}\n\nmarketData.crypto.prices = async function (assets) {\n  const ids = assets.map(asset => asset.id).join(\",\")\n  const quote = global.currency.toLowerCase()\n  const response = await coingeckoCall(\"simple/price\", {\n    ids,\n    vs_currencies: quote\n  })\n  const prices = {}\n  assets.forEach(asset => {\n    const assetData = response.data[asset.id]\n    if (assetData) prices[asset.code] = assetData[quote]\n  })\n  return prices\n}\n\nmarketData.crypto.history = async function (asset, limit = 1000) {\n  const response = await coingeckoCall(`coins/${asset.id}/market_chart`, {\n    vs_currency: global.currency,\n    days: limit\n  })\n  const data = response.data.prices.map((record, index) => {\n    return {\n      time: record[0],\n      price: record[1],\n      // volume: response.data.total_volumes[index][1]\n      volume: +nice(response.data.total_volumes[index][1] / record[1])\n    }\n  })\n  return data\n}\n\n/**\n * Fiat prices / history by \"https://exchangeratesapi.io\"\n */\n\nmarketData.fiat = {}\n\nasync function exchangeratesCall (page, symbols, params = {}) {\n  params.base = global.currency\n  if (typeof symbols === \"string\") {\n    params.symbols = symbols\n  } else {\n    if (global.currency === \"EUR\") symbols = symbols.filter(x => x !== \"EUR\")\n    params.symbols = symbols.join(\",\")\n  }\n  params.source = \"equilibre.io\"\n\n  return axios\n    .get(`https://api.exchangeratesapi.io/${page}`, { params })\n    .then(response => {\n      if (global.currency === \"EUR\" && !response.data.start_at) {\n        response.data.rates.EUR = 1\n      }\n      return response\n    })\n}\n\nmarketData.fiat.prices = async function (assets) {\n  const symbols = assets.map(asset => asset.code)\n  const response = await exchangeratesCall(\"latest\", symbols)\n  const data = response.data.rates\n  for (let symbol in data) {\n    data[symbol] = nice(1 / data[symbol], 8)\n  }\n  return data\n}\n\nmarketData.fiat.history = async function (asset, limit = 1000) {\n  const cached = cachedHistory(asset)\n  if (cached) return cached\n\n  const end_at = new Date().toISOString().slice(0, 10)\n  const today = new Date(end_at)\n  today.setDate(today.getDate() - limit)\n  const start_at = today.toISOString().slice(0, 10)\n  const response = await exchangeratesCall(\"history\", asset.code, {\n    start_at,\n    end_at\n  })\n\n  const data = Object.keys(response.data.rates)\n    .sort()\n    .map(date => {\n      return {\n        time: new Date(date).getTime(),\n        price: +nice(1 / response.data.rates[date][asset.code], 8)\n      }\n    })\n  cacheHistory(asset, data)\n  return data\n}\n\n/**\n * Helpers\n */\n\nfunction cacheHistory (asset, data) {\n  localStorage[`prices.${asset.code}`] = JSON.stringify([day(), data])\n}\n\nfunction cachedHistory (asset) {\n  const json = localStorage[`prices.${asset.code}`]\n  if (!json) return\n  const data = JSON.parse(json)\n  if (data[0] === day()) return data[1]\n}\n","\"use_strict\"\n/**\n * Orderbook class\n */\n\nconst cosmicLib = require(\"cosmic-lib\")\nconst nice = require(\"@cosmic-plus/jsutils/nice\")\nconst Projectable = require(\"@cosmic-plus/jsutils/projectable\")\nconst StellarSdk = require(\"@cosmic-plus/base/stellar-sdk\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst Orderbook = module.exports = class Orderbook extends Projectable {\n  static forBalance (balance, quote) {\n    if (balance.asset === quote) return\n    const orderbook = new Orderbook(balance.asset, quote)\n    balance.orderbook = orderbook\n    balance.asset.addOrderbook(orderbook)\n    orderbook.balance = balance\n\n    const baseAsset = new StellarSdk.Asset(balance.code, balance.anchor.address)\n    const quoteAsset = StellarSdk.Asset.native()\n\n    const server = cosmicLib.resolve.server()\n    const callBuilder = server.orderbook(baseAsset, quoteAsset)\n    const streamOptions = { onmessage: offers => orderbook.ingest(offers) }\n    this.close = callBuilder.stream(streamOptions)\n\n    return orderbook\n  }\n\n  static forAsset (asset) {\n    return new Orderbook(asset)\n  }\n\n  constructor (base, quote) {\n    super()\n\n    this.base = base\n    this.quote = quote\n\n    if (quote) {\n      this.type = \"native\"\n      this.name = `${base.code}/${quote.code}`\n      this.quote.trap(\"price\", () => this.updateOffersPrices())\n    } else {\n      this.type = \"agregated\"\n      this.name = `${base.code} (${__(\"Agregated\")})`\n      this.childs = []\n    }\n  }\n\n  ingest (offers) {\n    if (!areOffersEquals(this.bids, offers.bids)) {\n      this.bids = normalizeOffers(offers.bids, this.quote, this.balance, \"bids\")\n    }\n    if (!areOffersEquals(this.asks, offers.asks)) {\n      this.asks = normalizeOffers(offers.asks, this.quote, this.balance, \"asks\")\n    }\n  }\n\n  updateOffersPrices () {\n    if (this.bids) {\n      this.set(\"bids\", updateOffersPrices(this.bids, this.quote))\n    }\n    if (this.asks) {\n      this.set(\"asks\", updateOffersPrices(this.asks, this.quote))\n    }\n  }\n\n  mergeOffers (type) {\n    if (this.childs.length < 2) {\n      this.set(type, this.childs[0] && this.childs[0][type])\n      return\n    }\n\n    /// Merge order books\n    const merged = this.childs.reduce((arr, x) => {\n      return x[type] ? arr.concat(x[type]) : arr\n    }, [])\n    if (!merged.length) {\n      this[type] = null\n      return\n    }\n\n    const sortOffers =\n      type === \"bids\"\n        ? (a, b) => b.price - a.price\n        : (a, b) => a.price - b.price\n\n    /// Update cumulative properties\n    let cumul = 0,\n      volume = 0\n    this.set(\n      type,\n      merged.sort(sortOffers).map(row => {\n        const mergedRow = Object.assign({}, row)\n        mergedRow.cumul = cumul += +row.amount\n        mergedRow.volume = volume += +row.amount * row.price\n        return mergedRow\n      })\n    )\n  }\n\n  addChild (orderbook) {\n    this.childs.push(orderbook)\n    orderbook.trap(\"bids\", () => this.mergeOffers(\"bids\"))\n    orderbook.trap(\"asks\", () => this.mergeOffers(\"asks\"))\n  }\n}\n\nOrderbook.define(\"bestBid\", \"bids\", function () {\n  return this.bids && this.bids[0] && this.bids[0].price\n})\nOrderbook.define(\"bestAsk\", \"asks\", function () {\n  return this.asks && this.asks[0] && this.asks[0].price\n})\nOrderbook.define(\"price\", [\"bestBid\", \"bestAsk\"], function () {\n  return (this.bestBid + this.bestAsk) / 2\n})\nOrderbook.define(\"spread\", [\"bestBid\", \"bestAsk\"], function () {\n  return this.bestAsk - this.bestBid\n})\nOrderbook.define(\"spread%\", [\"spread\", \"bestAsk\"], function () {\n  return 100 * this.spread / this.bestAsk\n})\n\n/**\n * Utilities\n */\n\n/**\n * Look for the best first offer in **orderbook** **side** that match **filter**\n * (if provided) among child orderbooks.\n *\n * @param  {Orderbook} orderbook [description]\n * @param  {String}    side      `bids` or `asks`\n * @param  {Function}  [filter]  A filter that is passed by the returned offer\n * @return {Object}    An orderbook offer\n */\nOrderbook.prototype.findOffer = function (side, filter) {\n  const offers = this[side]\n  const childsNum = this.childs.length || 1\n  const anchors = {}\n\n  let last\n  for (let index in offers) {\n    const offer = offers[index]\n    if (filter && !filter(offer)) continue\n    const anchor = offer.balance.anchor.address\n    if (!anchors[anchor]) {\n      anchors[anchor] = true\n      last = offer\n    }\n    if (Object.keys(anchors).length === childsNum) break\n  }\n  return last\n}\n\nOrderbook.prototype.findAsk = function (filter) {\n  return this.findOffer(\"asks\", filter)\n}\nOrderbook.prototype.findBid = function (filter) {\n  return this.findOffer(\"bids\", filter)\n}\n\n/**\n * Helpers\n */\n\nfunction areOffersEquals (array1, array2) {\n  if (!array1) return false\n  if (array1.length !== array2.length) return false\n  for (let index in array1.length) {\n    if (array1[index].amount !== array2[index].amount) return false\n    if (array1[index].price !== array2[index].price) return false\n  }\n  return true\n}\n\nfunction normalizeOffers (offers, quote, balance, side) {\n  offers.forEach(row => {\n    row.volume = undefined\n    row.cumul = undefined\n    row.baseAmount = +row.amount\n    row.basePrice = +row.price\n    row.balance = balance\n    row.side = side\n  })\n  return updateOffersPrices(offers, quote)\n}\n\nfunction updateOffersPrices (offers, quote) {\n  let cumul = 0,\n    volume = 0\n  offers.forEach(row => {\n    if (row.side === \"asks\") row.amount = row.baseAmount\n    else row.amount = +nice(row.baseAmount / row.basePrice, 7)\n    row.cumul = cumul += +row.amount\n    row.price = +nice(row.basePrice * quote.price, 7)\n    row.volume = volume += +nice(+row.amount * row.price, 7)\n  })\n  return offers\n}\n","\"use_strict\"\n/**\n * Balance entry\n */\nconst Mirrorable = require(\"@cosmic-plus/jsutils/mirrorable\")\nconst Projectable = require(\"@cosmic-plus/jsutils/projectable\")\n\nconst Anchor = require(\"./anchor\")\nconst Asset = require(\"./asset\")\nconst Orderbook = require(\"./orderbook\")\n\nconst Balance = module.exports = class Balance extends Projectable {\n  static resolve (code, issuer) {\n    const id = code ? `${code}:${issuer}` : \"XLM\"\n    return Balance.table[id]\n  }\n\n  static ingest (entry) {\n    const id = entryId(entry)\n    const balance = Balance.table[id]\n    if (!balance) return new Balance(entry, id)\n\n    balance.amount = +entry.balance\n    balance.buying = +entry.buying_liabilities\n    balance.selling = +entry.selling_liabilities\n    return balance\n  }\n\n  constructor (entry) {\n    super()\n\n    this.id = entryId(entry)\n    this.code = entry.asset_code || \"XLM\"\n    this.anchor = Anchor.resolve(entry.asset_issuer || \"stellar.org\")\n    Balance.table[this.id] = this\n\n    if (this.id === \"XLM\" || this.id in Anchor.known) {\n      this.asset = Asset.resolve(Anchor.known[this.id] || this.code)\n      this.known = true\n    } else {\n      this.asset = Asset.resolve(this.id)\n      this.known = false\n    }\n    this.amount = +entry.balance\n    this.buying = +entry.buying_liabilities\n    this.offers = new Mirrorable()\n    this.selling = +entry.selling_liabilities\n\n    this.asset.balances.push(this)\n\n    if (this.code === \"XLM\") {\n      this.asset.project(\"price\", this)\n    } else {\n      this.orderbook = Orderbook.forBalance(this, Asset.resolve(\"XLM\"))\n      this.orderbook.project(\"price\", this)\n    }\n  }\n}\n\nBalance.table = {}\nBalance.define(\"value\", [\"amount\", \"price\"], function () {\n  return this.amount === 0 ? 0 : this.amount * this.price\n})\n\n/**\n * Helpers\n */\n\nfunction entryId (entry) {\n  return entry.asset_code ? `${entry.asset_code}:${entry.asset_issuer}` : \"XLM\"\n}\n","\"use_strict\"\n/**\n * Order class\n */\n\nconst cosmicLib = require(\"cosmic-lib\")\nconst CosmicLink = cosmicLib.CosmicLink\nconst Mirrorable = require(\"@cosmic-plus/jsutils/mirrorable\")\nconst nice = require(\"@cosmic-plus/jsutils/nice\")\nconst Projectable = require(\"@cosmic-plus/jsutils/projectable\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst global = require(\"./global\")\n\nconst Order = module.exports = class Order extends Projectable {\n  static rebalance (share) {\n    if (share.asset.code === \"XLM\") return\n\n    const order = new Order(\n      global.rebalancingStrategy,\n      share.asset.orderbook,\n      share\n    )\n    share.trap([\"value\", \"target\"], () => order.refresh())\n    share.asset.trap(\"liabilities\", () => order.refresh())\n    return order\n  }\n\n  constructor (method, orderbook, ...parameters) {\n    super()\n    this.algorithm = algorithm[method]\n    this.operations = new Mirrorable()\n    this.orderbook = orderbook\n    this.parameters = parameters\n\n    this.orderbook.listen(\"update\", () => this.refresh())\n    this.operations.listen(\"update\", () =>\n      this.compute([\"cosmicLink\", \"description\"])\n    )\n\n    this.refresh()\n  }\n\n  refresh () {\n    this.operations.splice(0, this.operations.length)\n    this.operations.trigger(\"update\")\n    this.type = \"\"\n    this.compute(\"offers\")\n    this.algorithm(this, ...this.parameters)\n    this.trigger(\"refresh\")\n  }\n\n  /**\n   * Operations Management\n   */\n\n  getOperation (offer, make) {\n    const id = `${offer.balance.anchor.id}:${make ? offer.price : \"take\"}`\n    const operation = this.operations.find(x => x.id === id)\n    if (operation) {\n      return operation\n    } else {\n      const newOperation = { id }\n      this.operations.push(newOperation)\n      return newOperation\n    }\n  }\n\n  addOperation (offer, amount) {\n    const operation = this.getOperation(offer, amount > 0)\n    this.setOperation(operation, offer, Number(amount) || operation.amount)\n  }\n\n  setOperation (operation, offer, amount) {\n    operation.amount = amount\n    operation.cost = amount * offer.price\n    operation.offer = offer\n    this.operations.trigger(\"update\")\n  }\n}\n\nOrder.define(\"cosmicLink\", \"operations\", function () {\n  return Order.operationsToCosmicLink(this.operations)\n})\nOrder.define(\"description\", \"operations\", function () {\n  return Order.operationsToDescription(this.operations)\n})\n\n/**\n * Utilities\n */\n\nOrder.operationsToCosmicLink = function (operations = []) {\n  const cosmicLink = new CosmicLink({\n    memo: \"Equilibre.io\",\n    source: global.portfolio.accountId\n  })\n  operations.forEach(operation => {\n    cosmicLink.addOperation(\"manageOffer\", operationToOdesc(operation))\n  })\n\n  return cosmicLink\n}\n\nOrder.operationsToDescription = function (operations = []) {\n  const desc = []\n  operations.forEach(op => {\n    if (operationDirection(op) === \"buy\") {\n      desc.push(`\n${__(\"Buy\")} ${nice(op.amount)} ${op.offer.balance.code} ${__(\"at\")} \\\n${nice(op.offer.price)} ${global.currency}\n      `)\n    } else {\n      desc.push(`\n${__(\"Sell\")} ${nice(op.amount)} ${op.offer.balance.code} ${__(\"at\")} \\\n${nice(op.offer.price)} ${global.currency}\n      `)\n    }\n  })\n  return desc\n}\n\n/**\n * Helpers\n */\n\nfunction operationDirection (op) {\n  if (\n    op.amount > 0 && op.offer.side === \"bids\"\n    || op.amount < 0 && op.offer.side === \"asks\"\n  ) {\n    return \"buy\"\n  } else {\n    return \"sell\"\n  }\n}\n\nfunction operationToOdesc (operation) {\n  const offer = operation.offer\n  const base = offer.balance.code + \":\" + offer.balance.anchor.address\n  const quote = \"XLM\"\n\n  let odesc\n  if (operationDirection(operation) === \"buy\") {\n    odesc = {\n      buying: base,\n      selling: quote,\n      amount: operation.amount * offer.price_r.n / offer.price_r.d,\n      price: { n: offer.price_r.d, d: offer.price_r.n }\n    }\n  } else {\n    odesc = {\n      buying: quote,\n      selling: base,\n      amount: operation.amount,\n      price: offer.price_r\n    }\n  }\n  odesc.amount = Math.abs(odesc.amount).toFixed(7)\n  odesc.offerId = operation.offer.id\n\n  return odesc\n}\n\nfunction floorPrice (offer, price) {\n  const refPrice = offer.balance.asset.price\n  const side = offer.side\n  if (side === \"bids\") return minMax(price, refPrice * 0.975, refPrice)\n  else return minMax(price, refPrice, refPrice * 1.025)\n}\n\nfunction minMax (value, min, max) {\n  return nice(Math.min(Math.max(value, min), max), 7)\n}\n\n/**\n * Create a copy of **offer** with a delta to global price reduced by\n * **percentage**.\n */\nfunction tightenSpread (offer, percentage = 1) {\n  const quote = offer.balance.orderbook.quote\n  const clone = Object.assign({}, offer)\n  const diff = (offer.balance.asset.price - offer.price) / 100 * percentage\n  clone.price = floorPrice(offer, nice(offer.price + diff, { significant: 9 }))\n  clone.price_r = {\n    n: nice(clone.price * 1000000000, 0),\n    d: nice(quote.price * 1000000000, 0)\n  }\n  // Ten characters maximum\n  while (clone.price_r.n > 999999999 || clone.price_r.d > 999999999) {\n    clone.price_r.n = nice(clone.price_r.n / 10, 0)\n    clone.price_r.d = nice(clone.price_r.d / 10, 0)\n  }\n  return clone\n}\n\n/**\n * Orders types\n */\n\nconst algorithm = {}\n\nalgorithm.balance = function (order, share) {\n  const asset = share.asset\n  const orderbook = asset.orderbook\n  const offers = asset.offers\n\n  if (asset.liabilities) {\n    const currentOffers = offers.filter(offer => !offer.outdated)\n    if (currentOffers.length) {\n      order.description = [__(\"Rebalancing...\")]\n      return\n    }\n  }\n\n  if (!orderbook.bids || !orderbook.asks || !share.target) return\n  if (!orderbook.bids.length || !orderbook.asks.length) return\n\n  const tmp1 = orderbook.findOffer(\"asks\", offer => {\n    const ask = tightenSpread(offer)\n    const sellAmount = (ask.price * asset.amount - share.target) / ask.price\n    return ask.balance.amount > sellAmount && offer.amount > sellAmount * 0.01\n  })\n\n  if (tmp1) {\n    const ask = tightenSpread(tmp1)\n    const sellAmount = (ask.price * asset.amount - share.target) / ask.price\n    const replace = offers.find(offer => offer.selling.asset_code)\n    ask.id = replace && replace.id\n    if (sellAmount * ask.basePrice > 1) order.addOperation(ask, sellAmount)\n  }\n\n  const tmp2 = orderbook.findOffer(\"bids\")\n  const bid = tightenSpread(tmp2)\n  if (bid.price * asset.amount < share.target) {\n    // TODO: don't let buyAmount exceed its share of XLM\n    const buyAmount = (share.target - bid.price * asset.amount) / bid.price\n    const replace = offers.find(offer => offer.buying.asset_code)\n    bid.id = replace && replace.id\n    if (buyAmount * bid.basePrice > 1) order.addOperation(bid, buyAmount)\n  }\n}\n\nalgorithm.limit = function (order, size = order.asset.size) {\n  order.type = \"maker\"\n  if (!order.offers) return\n\n  const offer = order.orderbook.findOffer(this.side)\n  order.addOperation(offer, size)\n}\n\nalgorithm.market = function (order, size = order.asset.size) {\n  order.type = \"taker\"\n  if (!order.offers) return\n  const orderbook = order.orderbook\n  const offer = orderbook.findOffer(this.side, offer => offer.cumul > size)\n  order.addOperation(offer, size)\n}\n\nalgorithm.deepLimit = function (order, size = order.asset.size) {\n  order.type = \"maker\"\n  if (!order.offers) return\n  const orderbook = order.orderbook\n  const offer = orderbook.findOffer(this.side, offer => offer.cumul > size)\n  order.addOperation(offer, size)\n}\n\n/**\n * Append algorithms to Order class\n */\n\nfor (let key in algorithm) {\n  if (!Order[key]) Order[key] = (...parameters) => new Order(key, ...parameters)\n}\n","\"use_strict\"\n/**\n * The Form class ease the creation of html forms.\n */\nconst env = require(\"./env\")\nconst html = require(\"./html\")\nconst helpers = require(\"./misc\")\n\nmodule.exports = class Form {\n  constructor (element) {\n    this.isForm = true\n    this.inputs = {}\n    this.validators = []\n\n    if (element) {\n      if (element.tagName !== \"FORM\") throw new Error(\"Not a form\")\n      this.node = element\n      this.node.autocomplete = \"off\"\n\n      for (let index in this.node.childNodes) {\n        const child = this.node.childNodes[index]\n        if (child.name) this.inputs[child.name] = child\n        if (child.className === \"info\") this.infoNode = child\n      }\n    } else {\n      this.node = html.create(\"form\", { autocomplete: \"off\" })\n    }\n\n    // Avoid password autofill in framed session (prevent click-jacking)\n    if (env.isEmbedded) {\n      const hiddenBox = html.create(\"input\", { type: \"password\", hidden: true })\n      this.node.insertBefore(hiddenBox, this.firstChild)\n    }\n\n    if (!this.infoNode) {\n      this.infoNode = html.create(\"span\", \".info\")\n      this.node.insertBefore(this.infoNode, this.firstChild)\n    }\n\n    this.node.onsubmit = () => this.submit(this)\n  }\n\n  addValidator (thunk) {\n    this.validators.push(thunk)\n    return this\n  }\n\n  reset () {\n    this.node.reset()\n    this.setError(\"\")\n    return this\n  }\n  submit () {\n    validate(this)\n    return false\n  }\n\n  putInfoNode () {\n    html.append(this.node, this.infoNode)\n    return this\n  }\n  async setInfo (info) {\n    this.infoNode.textContent = info\n    this.infoNode.className = \"info\"\n    await helpers.timeout(30)\n    return this\n  }\n  setError (error) {\n    if (error.message) this.infoNode.textContent = error.message\n    else this.infoNode.textContent = error\n    this.infoNode.className = \"error\"\n    return this\n  }\n\n  addNode (name, element) {\n    html.append(this.node, element)\n    if (name) {\n      if (!this.firstInput) this.firstInput = element\n      this.inputs[name] = element\n      element.name = name\n    }\n    return this\n  }\n  addTitle (text) {\n    this.addNode(\"\", html.create(\"h3\", false, text))\n    return this\n  }\n  addMessage (message) {\n    this.addNode(\"\", html.create(\"span\", false, message))\n    return this\n  }\n  addSeparator () {\n    html.append(this.node, html.create(\"hr\"))\n    return this\n  }\n\n  addTextBox (name, placeHolder) {\n    const box = addInput(this, name, \"text\")\n    if (placeHolder) box.placeholder = placeHolder\n    return this\n  }\n  addPasswordBox (name, placeholder = \"Authenticator password\") {\n    const box = addInput(this, name, \"password\")\n    if (sessionStorage.password) box.value = sessionStorage.password\n    box.placeholder = placeholder\n    return this\n  }\n  addAutofillPasswordBox (username, placeholder = \"Authenticator password\") {\n    const usernameNode = html.create(\"input\", {\n      readonly: true,\n      name: \"username\",\n      value: username\n    })\n    this.addNode(\"\", usernameNode).addPasswordBox(\"password\", placeholder)\n    html.hide(usernameNode)\n    return this\n  }\n  addCheckBox (name, text, initialState) {\n    const checkBox = addInput(this, name, \"checkbox\")\n    checkBox.checked = initialState\n    checkBox.required = false\n    checkBox.id = \"form-checkbox-\" + name + Math.random()\n    this.addNode(\"\", html.create(\"label\", { htmlFor: checkBox.id }, text))\n    return this\n  }\n  addButton (name, text, continuation) {\n    const button = addInput(this, name, \"button\")\n    button.value = text\n    button.onclick = continuation\n    return this\n  }\n  addFileSelector (name, text) {\n    const button = addInput(this, \"\", \"button\")\n    const file = addInput(this, name, \"file\")\n    const label = html.create(\"label\", null, \"No file selected\")\n    this.addNode(\"\", label)\n    html.hide(file)\n    button.value = text\n    button.onclick = () => file.click()\n    button.style.float = \"left\"\n    file.onchange = () => label.textContent = file.value.replace(/^.*\\\\/, \"\")\n    return this\n  }\n  addTextArea (name, placeHolder, rows) {\n    const parameters = { placeholder: placeHolder, rows: rows }\n    this.addNode(name, html.create(\"textarea\", parameters))\n    return this\n  }\n  addSubmit (text) {\n    const parameters = { type: \"submit\", textContent: text || \"✔ Confirm\" }\n    this.addNode(\"submit\", html.create(\"button\", parameters))\n    return this\n  }\n\n  optional (nameArray) {\n    nameArray.forEach(name => this.inputs[name].required = false)\n    return this\n  }\n  select () {\n    const element = this.firstInput\n    if (element) element.focus()\n    if (element.name === \"password\") {\n      helpers.timeout(30).then(() => {\n        if (element.value !== \"\") element.nextSibling.focus()\n      })\n    }\n    return this\n  }\n}\n\nasync function validate (form) {\n  let anim\n  if (form.inputs.submit) {\n    anim = html.create(\"span\", \".CL_loadingAnim\")\n    anim.style.position = \"fixed\"\n    html.append(form.inputs.submit, anim)\n  }\n\n  let answer\n  for (let index in form.validators) {\n    const validator = form.validators[index]\n    try {\n      answer = await validator(answer)\n    } catch (error) {\n      console.error(error)\n      form.setError(error)\n      if (anim) html.destroy(anim)\n      return\n    }\n  }\n\n  if (form.onExit) form.onExit()\n  if (anim) html.destroy(anim)\n}\n\nfunction addInput (form, name, type) {\n  const input = html.create(\"input\", { type: type, required: true })\n  form.addNode(name, input)\n  return input\n}\n","\"use strict\"\n/**\n * Exports parsed query string parameters. If the same parameter is defined\n * twice, the last value is exported.\n *\n * @exports params\n */\nconst params = module.exports\n\nconst hiddenKey = require(\"./misc\").setHiddenProperty\n\nif (location.search) {\n  const vars = location.search.substr(1).split(\"&\")\n  vars.forEach(entry => {\n    const field = entry.split(\"=\", 1)[0]\n    const value = entry.substr(field.length + 1)\n    params[field] = decodeURIComponent(value)\n  })\n}\n\nhiddenKey(params, \"$set\", function (obj) {\n  Object.keys(obj).forEach(key => {\n    const value = obj[key]\n    if (value == null) delete params[key]\n    else params[key] = value\n  })\n  writeQuery()\n})\n\nfunction writeQuery () {\n  let query = \"\"\n  for (let field in params) {\n    query += `&${field}=${encodeURIComponent(params[field])}`\n  }\n  query = \"?\" + query.substr(1)\n  if (location.hash) query += location.hash\n  history.replaceState(\"\", null, query)\n}\n","\"use_strict\"\n/**\n * Compute portfolio data from Account object.\n */\nconst axios = require(\"@cosmic-plus/base/axios\")\nconst cosmicLib = require(\"cosmic-lib\")\nconst Mirrorable = require(\"@cosmic-plus/jsutils/mirrorable\")\nconst Projectable = require(\"@cosmic-plus/jsutils/projectable\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst Asset = require(\"./asset\")\nconst Balance = require(\"./balance\")\nconst global = require(\"./global\")\n// const History = require(\"./portfolio-history\")\nconst Offers = require(\"./offers\")\n\n/**\n * Class\n */\n\nmodule.exports = class Portfolio extends Projectable {\n  static async resolve (address) {\n    const portfolio = new Portfolio()\n    portfolio.address = cosmicLib.config.source = address\n\n    await testNetwork()\n\n    const destination = await cosmicLib.resolve.address(address)\n    if (destination.memo)\n      throw new Error(__(\"Invalid federated address: shared account.\"))\n    if (await cosmicLib.resolve.isAccountEmpty(destination.account_id))\n      throw new Error(__(\"Empty account\"))\n\n    portfolio.accountId = destination.account_id\n\n    const server = cosmicLib.resolve.server()\n    const callBuilder = server.accounts().accountId(portfolio.accountId)\n    const streamOptions = { onmessage: account => portfolio.ingest(account) }\n    this.close = callBuilder.stream(streamOptions)\n\n    return portfolio\n  }\n\n  constructor () {\n    super()\n\n    // eslint-disable-next-line no-console\n    console.log(this)\n\n    this.assets = new Mirrorable()\n    this.balances = new Mirrorable()\n\n    this.define(\"total\", \"assets\", () => {\n      return this.assets\n        .filter(asset => asset.isSupported)\n        .reduce((sum, x) => sum + x.value, 0)\n    })\n    this.assets.mirror(asset =>\n      asset.trap(\"value\", () => this.compute(\"total\"))\n    )\n\n    this.new = true\n  }\n\n  async ingest (account) {\n    this.account = account\n\n    for (let index in account.balances) {\n      const balance = Balance.ingest(account.balances[index])\n      if (this.assets.indexOf(balance.asset) === -1) {\n        await balance.asset.getInfo()\n        this.assets.push(balance.asset)\n        this.balances.push(balance)\n        // TODO: check if following line trigger too much rebalancing\n        this.trap(\"total\", () => balance.asset.compute(\"share\"))\n      } else if (this.balances.indexOf(balance) === -1) {\n        this.balances.push(balance)\n      }\n    }\n\n    if (this.new) {\n      delete this.new\n      await Asset.refreshPrices()\n      this.offers = await Offers.forPortfolio(this)\n      this.trigger(\"open\")\n    }\n  }\n}\n\n/**\n * Extension\n */\n\nAsset.define(\"share\", \"value\", function () {\n  return global.portfolio && 100 * this.value / global.portfolio.total\n})\n\n/**\n * Helpers\n */\n\nasync function testNetwork () {\n  const horizon = cosmicLib.resolve.horizon()\n  try {\n    await axios.get(horizon)\n  } catch (error) {\n    throw new Error(__(\"Can't connect to the Stellar blockchain\"))\n  }\n}\n","\"use_strict\"\n\nif (!NodeList.prototype.forEach) {\n  NodeList.prototype.forEach = Array.prototype.forEach\n}\n\n/// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find\nif (!Array.prototype.find) {\n  Object.defineProperty(Array.prototype, \"find\", {\n    value: function (predicate) {\n      // 1. Let O be ? ToObject(this value).\n      if (this == null) {\n        throw new TypeError(\"\\\"this\\\" is null or not defined\")\n      }\n\n      var o = Object(this)\n\n      // 2. Let len be ? ToLength(? Get(O, \"length\")).\n      var len = o.length >>> 0\n\n      // 3. If IsCallable(predicate) is false, throw a TypeError exception.\n      if (typeof predicate !== \"function\") {\n        throw new TypeError(\"predicate must be a function\")\n      }\n\n      // 4. If thisArg was supplied, let T be thisArg; else let T be undefined.\n      var thisArg = arguments[1]\n\n      // 5. Let k be 0.\n      var k = 0\n\n      // 6. Repeat, while k < len\n      while (k < len) {\n        // a. Let Pk be ! ToString(k).\n        // b. Let kValue be ? Get(O, Pk).\n        // c. Let testResult be ToBoolean(? Call(predicate, T, « kValue, k, O »)).\n        // d. If testResult is true, return kValue.\n        var kValue = o[k]\n        if (predicate.call(thisArg, kValue, k, o)) {\n          return kValue\n        }\n        // e. Increase k by 1.\n        k++\n      }\n\n      // 7. Return undefined.\n      return undefined\n    },\n    configurable: true,\n    writable: true\n  })\n}\n\n/// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\nif (typeof Object.assign !== \"function\") {\n  // Must be writable: true, enumerable: false, configurable: true\n  Object.defineProperty(Object, \"assign\", {\n    // eslint-disable-next-line no-unused-vars\n    value: function assign (target, varArgs) {\n      // .length of function is 2\n      \"use strict\"\n      if (target == null) {\n        // TypeError if undefined or null\n        throw new TypeError(\"Cannot convert undefined or null to object\")\n      }\n\n      var to = Object(target)\n\n      for (var index = 1; index < arguments.length; index++) {\n        var nextSource = arguments[index]\n\n        if (nextSource != null) {\n          // Skip over if undefined or null\n          for (var nextKey in nextSource) {\n            // Avoid bugs when hasOwnProperty is shadowed\n            if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\n              to[nextKey] = nextSource[nextKey]\n            }\n          }\n        }\n      }\n      return to\n    },\n    writable: true,\n    configurable: true\n  })\n}\n\n// https://github.com/tc39/proposal-object-values-entries/blob/master/polyfill.js\nconst reduce = Function.bind.call(Function.call, Array.prototype.reduce)\nconst isEnumerable = Function.bind.call(\n  Function.call,\n  Object.prototype.propertyIsEnumerable\n)\nconst concat = Function.bind.call(Function.call, Array.prototype.concat)\nconst keys = Object.getOwnPropertyNames\n\nif (!Object.values) {\n  Object.values = function values (O) {\n    return reduce(\n      keys(O),\n      (v, k) =>\n        concat(v, typeof k === \"string\" && isEnumerable(O, k) ? [O[k]] : []),\n      []\n    )\n  }\n}\n\nif (!Object.entries) {\n  Object.entries = function entries (O) {\n    return reduce(\n      keys(O),\n      (e, k) =>\n        concat(\n          e,\n          typeof k === \"string\" && isEnumerable(O, k) ? [[k, O[k]]] : []\n        ),\n      []\n    )\n  }\n}\n","\"use_strict\"\n/**\n * Anchor class\n */\nconst aliases = require(\"@cosmic-plus/base/aliases\")\nconst helpers = require(\"@cosmic-plus/jsutils/misc\")\nconst Projectable = require(\"@cosmic-plus/jsutils/projectable\")\n\n/**\n * Class\n */\n\nconst Anchor = module.exports = class Anchor extends Projectable {\n  static resolve (address) {\n    return Anchor.all[address] || new Anchor(address)\n  }\n\n  constructor (address) {\n    super()\n\n    this.address = address\n    this.alias = aliases.all[address]\n    this.name = helpers.shorter(this.alias || this.address)\n    Anchor.all[address] = this\n\n    this.assets = {}\n  }\n}\n\nAnchor.all = {}\n\n/**\n * Known Anchors\n */\n\nAnchor.known = {\n  \"USD:GDUKMGUGDZQK6YHYA5Z6AY2G4XDSZPSZ3SW5UN3ARVMO6QSRDWP5YLEX\": \"USD\",\n  \"WSD:GDSVWEA7XV6M5XNLODVTPCGMAJTNBLZBXOFNQD3BNPNYALEYBNT6CE2V\": \"USD\",\n  \"USD:GDSRCV5VTM3U7Y3L6DFRP3PEGBNQMGOWSRTGSBWX6Z3H6C7JHRI4XFJP\": \"USD\",\n  \"USD:GBUYUAI75XXWDZEKLY66CFYKQPET5JR4EENXZBUZ3YXZ7DS56Z4OKOFU\": \"USD\",\n  \"USD:GBSTRUSD7IRX73RQZBL3RQUH6KS3O4NYFY3QCALDLZD77XMZOPWAVTUK\": \"USD\",\n  \"CNY:GAREELUB43IRHWEASCFBLKHURCGMHE5IF6XSE7EXDLACYHGRHM43RFOX\": \"CNY\",\n  \"XCN:GCNY5OXYSY4FKHOPT2SPOQZAOEIGXB5LBYW3HVU3OWSTQITS65M5RCNY\": \"CNY\",\n  \"BCNY:GBCNYBHAAPDSU3UIHXXQTHYZVSBJBI4YUNWXMKJBCPDHTVYR75G6NFHD\": \"CNY\",\n  \"EURT:GAP5LETOV6YIE62YAM56STDANPRDO7ZFDBGSNHJQIYGGKSMOZAHOOS2S\": \"EUR\",\n\n  \"SLT:GCKA6K5PCQ6PNF5RQBF7PQDJWRHO6UOGFMRLK3DYHDOI244V47XKQ4GP\": null,\n  \"MOBI:GA6HCMBLTZS5VYYBCATRBRZ3BZJMAFUDKYYF6AH6MVCMGWMRDNSWJPIH\": null,\n  \"SHX:GDSTRSHXHGJ7ZIVRBXEYE5Q74XUVCUSEKEBR7UCHEUUEK72N7I7KJ6JH\": null,\n  \"RMT:GDEGOXPCHXWFYY234D2YZSPEJ24BX42ESJNVHY5H7TWWQSYRN5ZKZE3N\": null,\n  \"TERN:GDGQDVO6XPFSY4NMX75A7AOVYCF5JYGW2SHCJJNWCQWIDGOZB53DGP6C\": null,\n  \"PEDI:GBVUDZLMHTLMZANLZB6P4S4RYF52MVWTYVYXTQ2EJBPBX4DZI2SDOLLY\": null,\n  \"GRAT:GAJ7V3EMD3FRWAPBEJAP7EC4223XI5EACDZ46RFMY5DYOMCIMWEFR5II\": null,\n  \"REPO:GCZNF24HPMYTV6NOEHI7Q5RJFFUI23JKUKY3H3XTQAFBQIBOHD5OXG3B\": null,\n\n  \"BTC:GBSTRH4QOTWNSVA6E4HFERETX4ZLSR3CIUBLK7AXYII277PFJC4BBYOG\": null,\n  \"BTC:GATEMHCCKCY67ZUCKTROYN24ZYT5GK4EQZ65JJLDHKHRUZI3EUEKMTCH\": null,\n  \"BTC:GAUTUYY2THLF7SGITDFMXJVYH3LHDSMGEAKSBU267M2K7A3W543CKUEF\": null,\n  \"BTC:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P\": null,\n  \"BTC:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5\": null,\n  \"ETH:GBSTRH4QOTWNSVA6E4HFERETX4ZLSR3CIUBLK7AXYII277PFJC4BBYOG\": null,\n  \"ETH:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P\": null,\n  \"ETH:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5\": null,\n  \"ETH:GBETHKBL5TCUTQ3JPDIYOZ5RDARTMHMEKIO2QZQ7IOZ4YC5XV3C2IKYU\": null,\n  \"ETH:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR\": null,\n  \"LTC:GC5LOR3BK6KIOK7GKAUD5EGHQCMFOGHJTC7I3ELB66PTDFXORC2VM5LP\": null,\n  \"LTC:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5\": null,\n  \"LTC:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P\": null,\n  \"XRP:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5\": null,\n  \"XRP:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P\": null,\n  \"KIN:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR\": null,\n  \"BAT:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR\": null,\n  \"ZRX:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR\": null,\n  \"BCH:GAEGOS7I6TYZSVHPSN76RSPIVL3SELATXZWLFO4DIAFYJF7MPAHFE7H4\": null,\n  \"STEEM:GB3KBOFUCVTWEZ7YIZ7PAKLQMKPCTGWU3LOMANMCT7V6I3AAK4USTEEM\": null,\n  \"SBD:GB3KBOFUCVTWEZ7YIZ7PAKLQMKPCTGWU3LOMANMCT7V6I3AAK4USTEEM\": null,\n  \"LINK:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR\": null\n}\n","\"use_strict\"\n/**\n * Account offers\n */\n\nconst cosmicLib = require(\"cosmic-lib\")\nconst loopcall = require(\"@cosmic-plus/loopcall\")\nconst Mirrorable = require(\"@cosmic-plus/jsutils/mirrorable\")\nconst nice = require(\"@cosmic-plus/jsutils/nice\")\nconst Projectable = require(\"@cosmic-plus/jsutils/projectable\")\nconst { day } = require(\"@cosmic-plus/jsutils/misc\")\n\nconst Asset = require(\"./asset\")\nconst Balance = require(\"./balance\")\n\n/**\n * Class\n */\n\nclass Offer extends Projectable {\n  static async forPortfolio (portfolio) {\n    const offers = new Mirrorable()\n    const server = cosmicLib.resolve.server()\n    const callBuilder = server.offers(\"accounts\", portfolio.accountId)\n    await Offer.update(callBuilder, offers)\n    setInterval(() => Offer.update(callBuilder, offers), 5000)\n    return offers\n  }\n\n  static async update (callBuilder, offers) {\n    offers.forEach(offer => offer.opened = false)\n    await loopcall(callBuilder).then(records => {\n      records.forEach(record => Offer.ingest(record, offers))\n    })\n    offers.filter(offer => !offer.opened).forEach(offer => offer.destroy())\n  }\n\n  static async ingest (record, offers) {\n    const offer = Offer.table[recordToId(record)]\n    if (offer) offer.update(record)\n    else new Offer(record, offers)\n  }\n\n  constructor (record, offers) {\n    super()\n\n    const quote = Asset.resolve(\"XLM\")\n    const asset = record.buying.asset_code ? record.buying : record.selling\n    this.balance = Balance.resolve(asset.asset_code, asset.asset_issuer)\n    this.asset = this.balance.asset\n    this.side = record.buying.asset_code ? \"buy\" : \"sell\"\n    this.intern = recordToId(record)\n\n    this.define(\n      \"price\",\n      \"rawPrice\",\n      this.side === \"sell\"\n        ? () => quote.price * this.rawPrice\n        : () => quote.price / this.rawPrice\n    )\n    quote.trap(\"price\", () => this.compute(\"price\"))\n\n    this.update(record)\n\n    this.balance.offers.push(this)\n    this.asset.offers.push(this)\n    if (offers) offers.push(this)\n    Offer.table[this.intern] = this\n\n    this.listen(\"destroy\", () => {\n      this.balance.offers.splice(this.balance.offers.indexOf(this), 1)\n      this.asset.offers.splice(this.asset.offers.indexOf(this), 1)\n      if (offers) offers.splice(offers.indexOf(this), 1)\n      delete Offer.table[this.intern]\n    })\n  }\n\n  update (record) {\n    this.opened = true\n    Object.assign(this, record)\n    this.rawPrice = record.price\n    this.compute(\"price\")\n    this.rawAmount = record.amount\n    if (this.side === \"buy\") {\n      this.amount = nice(this.rawAmount * this.rawPrice, 7)\n    }\n\n    this.date = day(this.last_modified_time)\n    this.outdated = this.date !== day()\n  }\n}\n\nOffer.table = {}\n\n/**\n * Helpers\n */\n\nfunction recordToId (record) {\n  return `${record.id}/${assetToId(record.buying)}/${assetToId(record.selling)}`\n}\n\nfunction assetToId (asset) {\n  return asset.asset_issuer\n    ? `${asset.asset_code}:${asset.asset_issuer}`\n    : \"XLM\"\n}\n\n/**\n * Export\n */\n\nmodule.exports = Offer\n","\"use_strict\"\n/**\n * Activity Gui\n */\n\nconst Gui = require(\"@cosmic-plus/jsutils/gui\")\nconst nice = require(\"@cosmic-plus/jsutils/nice\")\nconst Tabs = require(\"@cosmic-plus/jsutils/tabs\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\nconst { CosmicLink } = require(\"cosmic-lib\")\n\nconst SideFrame = require(\"./side-frame\")\nconst global = require(\"./global\")\n\n/**\n * Class\n */\n\nclass ActivityGui extends Gui {\n  constructor (portfolio) {\n    super(`\n<section>\n  <h2>${__(\"Activity\")}</h2>\n  %selector\n  %view\n</section>\n    `)\n\n    this.portfolio = portfolio\n\n    const tabs = new Tabs()\n    // tabs.project([\"selector\", \"view\"], this)\n    tabs.project(\"view\", this)\n\n    tabs.add(\n      \"offers\",\n      __(\"Open Orders\"),\n      new ActivityGui.Offers(portfolio),\n      \"select\"\n    )\n    // tabs.add(\"orders\", __(\"Orders\"), new ActivityGui.Orders(portfolio))\n    // tabs.add(\"transfers\", __(\"Transfers\"), new ActivityGui.Transfers(portfolio))\n    // tabs.select(__(\"Orders\"))\n  }\n}\n\nActivityGui.Offers = class ActivityOffers extends Gui {\n  constructor (portfolio) {\n    super(`\n<section>\n  <table>\n    <tr>\n      <th>${__(\"Date\")}</th>\n      <th>${__(\"Asset\")}</th>\n      <th>${__(\"Direction\")}</th>\n      <th>${__(\"Amount\")}</th>\n      <th>${__(\"Price\")} (${global.currency})</th>\n    </tr>\n    %formatOffer:offers...\n    <tr><td colspan=\"5\" align=\"center\" onclick=%cancelOffers>\n      <h3>${__(\"Cancel All\")}</h3>\n    </td></tr>\n  </table>\n</section>\n\n<p class=\"note\">\n  ${__(\"All orders are passed against Stellar Lumens (XLM).\")}\n  ${__(\n    \"For your comfort, prices are displayed in their %%globalCurrency equivalent.\"\n  )}\n  ${__(\n    \"However, those converted values will change according to XLM price movement.\"\n  )}\n</p>\n    `)\n\n    this.portfolio = portfolio\n    this.offers = portfolio.offers\n    this.globalCurrency = global.currency\n  }\n\n  formatOffer (offer) {\n    return new ActivityGui.Offer(offer)\n  }\n\n  cancelOffers () {\n    if (!this.offers.length) return\n\n    const memo = \"Equilibre.io\"\n    const network = \"public\"\n    const source = this.portfolio.accountId\n    const operations = this.offers.map(offer => {\n      return { type: \"manageOffer\", offerId: offer.id, amount: 0 }\n    })\n\n    const cosmicLink = new CosmicLink({ memo, network, source, operations })\n    new SideFrame(cosmicLink.uri)\n  }\n}\n\nActivityGui.Offer = class ActivityOffer extends Gui {\n  constructor (offer) {\n    super(\n      `\n<tr>\n  <td>%formatDate:last_modified_time</td>\n  <td>\n    <img src=%image alt=\"\">\n    <span>%name / %anchor</span>\n  </td>\n  <td>%side</td>\n  <td align=\"right\">%nice:amount</td>\n  <td align=\"right\">%nice:price</td>\n</tr>\n    `,\n      offer\n    )\n\n    this.offer = offer\n\n    this.image = offer.asset.image\n    this.name = offer.asset.code\n    this.side = offer.side === \"buy\" ? __(\"Buy\") : __(\"Sell\")\n    this.anchor = offer.balance.anchor.name\n    this.date = new Date(offer.last_modified_time).toLocaleDateString()\n  }\n\n  nice (number) {\n    return nice(number)\n  }\n\n  formatDate (value) {\n    const date = value ? new Date(value) : new Date()\n    return date.toLocaleDateString()\n  }\n}\n\nActivityGui.Orders = class ActivityOrders extends Gui {\n  constructor (portfolio) {\n    super(`\n<table>\n  <tr>\n    <th>${__(\"Date\")}</th>\n    <th>${__(\"Asset\")}</th>\n    <th>${__(\"Direction\")}</th>\n    <th>${__(\"Amount\")}</th>\n    <th>${__(\"Price\")}</th>\n  </tr>\n  <tr>\n    <td colspan=\"6\"><h3><i18n>${__(\"Open Orders\")}</i18n></h3></td>\n  </tr>\n  %openOrders...\n  <tr>\n    <td colspan=\"6\"><h3><i18n>${__(\"Completed Orders\")}</i18n></h3></td>\n  </tr>\n  %completedOrders...\n</table>\n    `)\n    this.portfolio = portfolio\n  }\n}\n\nActivityGui.Transfers = class ActivityTransfers extends Gui {\n  constructor (portfolio) {\n    super(`\n<table>\n  <tr>\n    <th>${__(\"Date\")}</th>\n    <th>${__(\"Asset\")}</th>\n    <th>${__(\"With\")}</th>\n    <th>${__(\"Amount\")}</th>\n  </tr>\n  %transfers...\n</table>\n    `)\n    this.portfolio = portfolio\n  }\n}\n\n/**\n * Export\n */\n\nmodule.exports = ActivityGui\n","\"use_strict\"\n/**\n * Portfolio Graphical User Interface\n */\nconst Highcharts = require(\"highcharts/highstock\")\n\nconst Gui = require(\"@cosmic-plus/jsutils/gui\")\nconst nice = require(\"@cosmic-plus/jsutils/nice\")\nconst Tabs = require(\"@cosmic-plus/jsutils/tabs\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst AssetGui = require(\"./asset-gui\")\nconst global = require(\"./global\")\nconst marketData = require(\"./market-data\")\n\n/**\n * Class\n */\n\nclass PortfolioGui extends Gui {\n  constructor (portfolio) {\n    super(`\n<section><h2>${__(\"Portfolio\")}: %total %currency</h2>\n  %summary\n  %chart\n\n  <p class=\"note\" align=\"center\">\n    ${__(\"Anchor prices are from Stellar DEX\")} /\n    ${__(\"Global prices are from %%coingecko when available.\")}\n    </p>\n\n</section>`)\n\n    this.portfolio = portfolio\n\n    portfolio.project(\"total\", this, x => nice(x, 2))\n    this.currency = global.currency\n    this.summary = new PortfolioGui.Summary(this)\n    this.coingecko = new Gui(\n      `<a target=\"_blank\" rel=\"noopener\" href=\"https://coingecko.com\">coingecko</a>`\n    )\n  }\n\n  select (asset) {\n    if (this.chart) this.chart.destroy()\n    if (asset && asset.globalPrice && asset.code !== global.currency) {\n      this.chart = new PortfolioGui.Chart(asset)\n    } else {\n      this.chart = null\n    }\n  }\n}\n\nPortfolioGui.Summary = class PortfolioSummary extends Gui {\n  constructor (parent) {\n    const tabs = new Tabs()\n    super(`%nav <section>%view</section>`, tabs)\n\n    tabs.add(\"table\", __(\"Table\"), new PortfolioGui.Table(parent))\n    tabs.add(\"graph\", __(\"Graph\"), () => new PortfolioGui.Graph(parent))\n    tabs.listen(\"select\", id => localStorage[\"PortfolioSummary.tab\"] = id)\n    tabs.select(localStorage[\"PortfolioSummary.tab\"] || \"table\")\n  }\n}\n\nPortfolioGui.Table = class PortfolioTable extends Gui {\n  constructor (parent) {\n    super(`\n<table>\n  <tr>\n    <th>${__(\"Name\")}</th>\n    <th>${__(\"Anchor\")}</th>\n    <th>${__(\"Amount\")}</th>\n    <th>${__(\"Price\")}</th>\n    <th>${__(\"Value\")}</th>\n  </tr>\n  %assetsGui...\n</table>\n`)\n\n    this.parent = parent\n\n    this.assetsGui = parent.portfolio.assets.mirror(asset => {\n      const assetGui = new AssetGui(asset)\n      assetGui.domNode.onclick = () => this.select(assetGui)\n      return assetGui\n    })\n\n    parent.portfolio.trap(\"total\", () => this.sort())\n  }\n\n  sort () {\n    this.assetsGui.sort((a, b) => b.asset.value - a.asset.value)\n  }\n\n  select (assetGui) {\n    if (this.selected) {\n      this.selected.domNode.className = \"\"\n      this.selected.simpleView()\n    }\n\n    if (this.selected === assetGui) {\n      this.parent.select()\n      this.selected = null\n    } else {\n      this.parent.select(assetGui.asset)\n      assetGui.domNode.className = \"selected\"\n      this.selected = assetGui\n      assetGui.detailledView()\n    }\n  }\n}\n\nPortfolioGui.Graph = class PortfolioGraph extends Gui {\n  constructor (parent) {\n    super(`<div -ref=%container align=\"center\"></div>`)\n    this.parent = parent\n    this.listen(\"destroy\", () => this.chart && this.chart.destroy())\n    parent.portfolio.trap(\"total\", () => {\n      // For some unknow reason the timeout makes the chart draw better.\n      setTimeout(() => this.makePie(), 1)\n    })\n  }\n\n  makePie () {\n    if (this.chart) this.chart.destroy()\n\n    // Responsive setup\n    let showInLegend,\n      legend,\n      dataLabels = {\n        enabled: true,\n        style: { fontSize: \"14px\" }\n      }\n    if (innerWidth > 600) {\n      showInLegend = false\n      legend = null\n      dataLabels.format =\n        \"{point.niceAmount} {point.code}<br>({point.percentage:.0f}%)\"\n    } else {\n      showInLegend = true\n      legend = {\n        enabled: true,\n        align: \"center\",\n        verticalAlign: \"top\",\n        layout: \"horizontal\"\n      }\n      dataLabels.format = \"{point.percentage:.0f}%\"\n      dataLabels.distance = -20\n    }\n\n    this.chart = Highcharts.chart(this.container, {\n      title: \"\",\n      chart: {\n        type: \"pie\",\n        backgroundColor: \"#fbfbfd\"\n      },\n      colors: [\n        \"rgba(231,  76,  60, 0.8)\",\n        \"rgba(230, 126,  34, 0.8)\",\n        \"rgba(242, 202,  39, 0.8)\",\n        \"rgba(46,  204, 112, 0.8)\",\n        \"rgba(52,  152, 219, 0.8)\",\n        \"rgba(155,  89, 182, 0.8)\",\n\n        \"rgba(231,  76,  60, 0.6)\",\n        \"rgba(230, 126,  34, 0.6)\",\n        \"rgba(242, 202,  39, 0.6)\",\n        \"rgba(46,  204, 112, 0.6)\",\n        \"rgba(52,  152, 219, 0.6)\",\n        \"rgba(155,  89, 182, 0.6)\",\n\n        \"rgba(231,  76,  60, 0.4)\",\n        \"rgba(230, 126,  34, 0.4)\",\n        \"rgba(242, 202,  39, 0.4)\",\n        \"rgba(46,  204, 112, 0.4)\",\n        \"rgba(52,  152, 219, 0.4)\",\n        \"rgba(155,  89, 182, 0.4)\"\n      ],\n      tooltip: {\n        style: { fontSize: \"14px\" },\n        pointFormat: `\n${__(\"Amount\")}: {point.niceAmount} {point.code}<br>\n${__(\"Price\")}: {point.nicePrice} ${global.currency}<br>\n<b>${__(\"Value\")}: {point.y} ${global.currency}</b>\n`\n      },\n      plotOptions: {\n        pie: {\n          allowPointSelect: true,\n          animation: false,\n          cursor: \"pointer\",\n          showInLegend,\n          legend,\n          dataLabels,\n          point: {\n            events: {\n              select: x => this.parent.select(x.target.options),\n              legendItemClick: x => {\n                this.parent.select(x.target.options)\n                return false\n              }\n            }\n          }\n        }\n      },\n\n      series: [\n        {\n          name: __(\"Amount\"),\n          colorByPoint: true,\n          ignoreHiddenPoint: true,\n          data: this.parent.portfolio.assets\n            .filter(asset => asset.value)\n            .map(makeAssetPoint)\n            .sort((a, b) => b.value - a.value)\n        }\n      ],\n      credits: { enabled: false }\n    })\n  }\n}\n\nfunction makeAssetPoint (asset) {\n  const assetPoint = Object.create(asset)\n  assetPoint.y = Number(nice(asset.value, 2))\n  assetPoint.niceAmount = nice(asset.amount)\n  assetPoint.nicePrice = nice(asset.price)\n  return assetPoint\n}\n\nPortfolioGui.Chart = class PortfolioChart extends Gui {\n  constructor (asset) {\n    super(`\n      <section><h3>${asset.code} ${__(\"to\")} ${global.currency}</h3>\n        <div -ref=%container><p>${__(\"Loading...\")}</p></div>\n      </section>\n    `)\n\n    this.asset = asset\n    this.listen(\"destroy\", () => this.chart && this.chart.destroy())\n    marketData.assetHistory(asset).then(data => this.makeChart(data))\n  }\n\n  makeChart (data) {\n    this.chart = Highcharts.stockChart(this.container, {\n      rangeSelector: { selected: 2 },\n      chart: {\n        backgroundColor: \"#fbfbfd\"\n      },\n      yAxis: [\n        { labels: { align: \"left\" }, height: \"80%\", resize: { enabled: true } },\n        { labels: { align: \"left\" }, top: \"80%\", height: \"20%\", offset: 0 }\n      ],\n      series: [\n        {\n          type: \"spline\",\n          name: \"Price\",\n          data: data.map(x => [x.time, +nice(x.price)])\n        },\n        {\n          type: \"column\",\n          name: \"Volume\",\n          data: data.map(x => [x.time, x.volume]),\n          yAxis: 1\n        }\n      ],\n      credits: { enabled: false }\n    })\n  }\n}\n\n/**\n * Export\n */\n\nmodule.exports = PortfolioGui\n","\"use_strict\"\n/**\n * Asset GUI\n */\nconst Gui = require(\"@cosmic-plus/jsutils/gui\")\nconst html = require(\"@cosmic-plus/jsutils/html\")\nconst nice = require(\"@cosmic-plus/jsutils/nice\")\nconst msg = require(\"@cosmic-plus/i18n\").__\n\n/**\n * Class\n */\n\nclass AssetGui extends Gui {\n  constructor (asset) {\n    super(`\n<tr %style>\n  <td align=\"left\">\n    <img src=%image alt=\"\">\n    <span>%name</span>\n  </td>\n  <td align=\"left\">\n    <div hidden=%simple>%anchors...</div>\n    <div %class>%anchorTotal</div>\n  </td>\n  <td align=\"right\">\n    <div hidden=%simple>%amounts...</div>\n    <div %class>%amountTotal</div>\n  </td>\n  <td align=\"right\">\n    <div hidden=%simple>%prices...</div>\n    <div %class title=%priceDetails>%priceTotal</div>\n  </td>\n  <td align=\"right\">\n    <div hidden=%simple>%values...</div>\n    <div %class>%valueTotal</div>\n  </td>\n</tr>\n    `)\n\n    this.asset = asset\n\n    this.image = asset.image\n    this.name = asset.code\n    this.anchors = asset.balances.mirror(x => cell(x.anchor, \"name\"))\n    this.amounts = asset.balances.mirror(x => cell(x, \"amount\", nice))\n    this.prices = asset.balances.mirror(x => priceCell(x, \"price\", nice))\n    this.values = asset.balances.mirror(x => cell(x, \"value\", x => nice(x, 2)))\n    asset.link(\"amount\", this, \"amountTotal\", nice)\n    asset.link(\"price\", this, \"priceTotal\", nice)\n    asset.link(\"value\", this, \"valueTotal\", x => nice(x, 2))\n    asset.anchors.feed(this, \"anchorHeader\", anchorName)\n\n    this.priceDetails = \"\"\n    const orderbook = this.asset.orderbook\n    if (orderbook) {\n      orderbook.trap(\n        [\"bestAsk\", \"bestBid\", \"spread%\"],\n        () => this.priceDetails = priceDetails(orderbook)\n      )\n    }\n\n    this.simpleView()\n  }\n\n  simpleView () {\n    this.simple = true\n    this.class = \"\"\n    this.anchorTotal = this.anchorHeader\n  }\n\n  detailledView () {\n    this.simple = false\n    this.class = \"footer\"\n    this.anchorTotal = \"Total\"\n  }\n}\n\n/**\n * Export\n */\n\nmodule.exports = AssetGui\n\n/**\n * Helpers\n */\n\nfunction anchorName (anchors) {\n  if (anchors.length === 1) return anchors[0].name\n  else return `${msg(\"Multiple\")} (${anchors.length})`\n}\n\nfunction cell (object, key, func) {\n  const node = html.create(\"div\", null, object[key])\n  object.link(key, node, \"textContent\", func)\n  return node\n}\n\nfunction priceCell (object, key, func) {\n  const node = cell(object, \"price\", func)\n  object.trap(\"orderbook\", () => {\n    if (object.orderbook)\n      object.orderbook.trap(\n        [\"bestAsk\", \"bestBid\", \"spread%\"],\n        () => node.title = priceDetails(object.orderbook)\n      )\n  })\n  return node\n}\n\nfunction priceDetails (orderbook) {\n  if (orderbook.base.code === \"XLM\") return \"\"\n  return `\nBuy: ${nice(orderbook.bestBid)} \\\n- Sell: ${nice(orderbook.bestAsk)} \\\n- Spread: ${nice(orderbook[\"spread%\"], 2)}%\n  `\n}\n","\"use_strict\"\n/**\n * Settings Graphical User Interface\n */\nconst Gui = require(\"@cosmic-plus/jsutils/gui\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst global = require(\"./global\")\n\n/**\n * Class\n */\n\nclass SettingsGui extends Gui {\n  constructor () {\n    super(`\n      <section><h2>${__(\"Settings\")}</h2>\n        <section><h3>${__(\"General Settings\")}</h3>\n          <form>\n            <label><span>${__(\"Language\")}:</span>\n              <select value=%language>\n                <option value=\"us\">English</option>\n                <option value=\"fr\">Français</option>\n              </select>\n            </label>\n            <label><span>${__(\"Currency\")}:</span>\n              <select value=%currency>\n                <option value=\"CNY\">CNY</option>\n                <option value=\"EUR\">EUR</option>\n                <option value=\"USD\">USD</option>\n              </select>\n            </label>\n          </form>\n        </section>\n      </section>\n    `)\n\n    // Two-way binding\n    global.project([\"currency\", \"language\"], this)\n    this.project([\"currency\", \"language\"], global)\n\n    // Refresh interface\n    this.listen(\"change:currency\", () => location.reload())\n    this.listen(\"change:language\", () => location.reload())\n  }\n}\n\n/**\n * Export\n */\n\nmodule.exports = SettingsGui\n","\"use_strict\"\n/**\n * Share Graphical User Interface\n */\nconst Gui = require(\"@cosmic-plus/jsutils/gui\")\nconst i18n = require(\"@cosmic-plus/i18n\")\nconst html = require(\"@cosmic-plus/jsutils/html\")\nconst nice = require(\"@cosmic-plus/jsutils/nice\")\nconst { __ } = i18n\n\nconst SideFrame = require(\"./side-frame\")\nconst global = require(\"./global\")\nconst Order = require(\"./order\")\nconst Share = require(\"./share\")\n\n/**\n * Class\n */\n\nclass RebalanceGui extends Gui {\n  constructor (portfolio) {\n    super(`\n<section class=\"RebalanceGui\">\n  <h2>${__(\"Rebalance\")}</h2>\n  %table\n  <section hidden=%hideSection>\n    <div class=\"errors\">%formatError:errors...</div>\n    <form onsubmit=%rebalance hidden=%hideRebalance>\n      <button type=\"submit\" disabled=%block>${__(\"Rebalance\")}</button>\n    </form>\n    <form onsubmit=%apply hidden=%hideApply>\n      <button type=\"submit\" disabled=%block>${__(\"Apply\")}</button>\n      <button onclick=%cancel>${__(\"Cancel\")}</button>\n    </form>\n  </section>\n  %setupGui\n</section>\n    `)\n\n    this.portfolio = portfolio\n    const template = localStorage[`target:${portfolio.account.id}`]\n    this.share = Share.forPortfolio(portfolio, template)\n\n    this.table = new RebalanceGui.Table(this)\n    this.table.project(\"selected\", this)\n    this.project(\"selected\", this.table)\n\n    this.errors = this.share.errors\n    this.errors.feed(this, \"block\", errors => !!errors.length)\n\n    this.define(\"hideRebalance\", [\"selected\", \"modified\"], () => {\n      return this.selected || this.modified\n    })\n    this.define(\"hideApply\", [\"selected\", \"modified\"], () => {\n      return this.selected || !this.modified\n    })\n    this.define(\"hideSection\", [\"hideRebalance\", \"hideApply\"], () => {\n      return this.hideRebalance && this.hideApply\n    })\n\n    this.share.project(\"modified\", this)\n\n    this.define(\"setupGui\", \"selected\", () => {\n      if (this.setupGui) this.setupGui.destroy()\n      return this.selected && new ShareGui.Setup(this.selected, this)\n    })\n  }\n\n  formatError (error) {\n    return new Gui(`<div class=\"error\">%error</div>`, { error })\n  }\n\n  cancel () {\n    location.reload()\n    return false\n  }\n\n  apply () {\n    try {\n      const accountId = this.portfolio.account.id\n      localStorage[\n        `target:${accountId}`\n      ] = this.share.template = this.share.toString()\n      this.share.modified = false\n    } catch (error) {\n      console.error(error)\n    }\n    return false\n  }\n\n  rebalance () {\n    try {\n      const operations = listOperations(this.share)\n      const outdated = this.portfolio.offers.filter(offer => offer.outdated)\n      const remaining = outdated.filter(offer => {\n        return !operations.find(op => op.offer.id === offer.id)\n      })\n      operations.forEach(op => {\n        if (!op.offer.id && remaining.length) op.offer.id = remaining.pop().id\n      })\n\n      if (!operations.length) return false\n      const cosmicLink = Order.operationsToCosmicLink(operations)\n      remaining.forEach(offer => {\n        cosmicLink.addOperation(\"manageOffer\", { amount: 0, offerId: offer.id })\n      })\n      if (cosmicLink) new SideFrame(cosmicLink.uri)\n    } catch (error) {\n      console.error(error)\n    }\n    return false\n  }\n}\n\nfunction listOperations (share) {\n  let operations = []\n  share.childs.forEach(child => {\n    if (child.order) operations = operations.concat(child.order.operations)\n  })\n  return operations\n}\n\nRebalanceGui.Table = class RebalanceTable extends Gui {\n  constructor (parent) {\n    super(`\n<section class=\"RebalanceTable\">\n  <table>\n    <tr>\n      <th>${__(\"Name\")}</th>\n      <th>${__(\"Goal\")}</th>\n      <th>${__(\"Divergence\")}</th>\n      <th>${__(\"Operation\")}</th>\n    </tr>\n    %formatShare:shares...\n    <tr hidden=true>\n      <td align=\"center\" colspan=\"4\"><h3>${__(\"Add Asset\")}</h3></td>\n    </tr>\n  </table>\n</section>\n    `)\n\n    this.selected = undefined\n    this.shares = parent.share.childs\n    this.sortShares(this.shares)\n    parent.share.listen(\"update\", () => this.sortShares(this.shares))\n  }\n\n  formatShare (share) {\n    const shareGui = new ShareGui(share)\n    shareGui.domNode.onclick = () => this.selected = share\n    return shareGui\n  }\n\n  sortShares (array) {\n    return array.sort((a, b) => b.goal - a.goal || a.globalPrice)\n  }\n}\n\nclass ShareGui extends Gui {\n  constructor (share) {\n    super(`\n<tr class=\"ShareGui\">\n  <td align=\"left\">\n    <img src=%image alt=\"\">\n    <span>%name</span>\n  </td>\n  <td align=\"right\">%goal%</td>\n  <td align=\"right\">%divergence</td>\n  <td align=\"right\">%description...</td>\n</tr>\n    `)\n\n    this.share = share\n\n    this.image = share.asset.image\n    this.name = share.name || share.asset && share.asset.code\n    share.project(\"goal\", this, x => nice(x, 2))\n    share.project(\"divergence\", this, x => {\n      return x == null ? \"-\" : nice(x * 100, 2) + \"%\"\n    })\n\n    share.trap(\"order\", () => {\n      if (!share.order) {\n        this.cosmicLink = this.description = null\n      } else {\n        share.order.project(\"cosmicLink\", this)\n        share.order.project(\"description\", this, descriptionToList)\n      }\n    })\n  }\n}\n\nShareGui.Setup = class ShareSetup extends Gui {\n  constructor (share, parent) {\n    super(`\n<section>\n  <form onsubmit=%close>\n    <h3>%assetName</h3>\n    <hr>\n    <label><span>${__(\"Size\")}:</span>\n      <input class=\"half\" type=\"number\" step=\"any\" min=\"0\" %max value=%size\n       placeholder=%goal onchange=%switchMode>\n      <select class=\"half\" onchange=%setMode value=%mode>\n        <option value=\"equal\">${__(\"Equal Share\")}</option>\n        <option value=\"percentage\">${__(\"Percentage\")}</option>\n        <option value=\"amount\">${__(\"Amount\")}</option>\n      </select>\n    </label>\n\n    <hr>\n\n    <input type=\"submit\" value=\"${__(\"Close\")}\">\n  </form>\n</section>\n    `)\n\n    this.parent = parent\n    this.share = share\n\n    this.assetName = share.asset.name\n\n    share.project(\"goal\", this, x => nice(x, 2))\n\n    share.project(\"size\", this)\n    this.project(\"size\", share, x => x != null ? Number(x) : null)\n\n    share.project(\"mode\", this, mode => mode || \"equal\")\n    this.project(\"mode\", share)\n  }\n\n  switchMode () {\n    if (this.size && this.mode === \"equal\") this.mode = \"percentage\"\n  }\n\n  setMode () {\n    switch (this.mode) {\n    case \"equal\":\n      this.size = null\n      break\n    case \"percentage\":\n      this.size = +nice(100 * this.share.value / global.portfolio.total, 2)\n      this.max = 100\n      break\n    case \"amount\":\n      this.size = this.share.asset.amount\n      this.max = null\n      break\n    }\n  }\n\n  close () {\n    this.switchMode()\n    this.parent.selected = null\n    return false\n  }\n}\n\n/**\n * Helpers\n */\n\nfunction descriptionToList (description) {\n  return description.map(e => html.create(\"div\", null, e))\n}\n\n/**\n * Export\n */\n\nmodule.exports = RebalanceGui\n","\"use_strict\"\n/**\n * Share class.\n *\n * A (portfolio) Share object represents a statically or dynamically allocated\n * share of the user portfolio. It is a theoric goal that the rebalancing\n * process aims to reach as much as possible.\n *\n * A Share may be composed by several Share subentries, in such a way that the\n * complete portfolio balancing target ends up being a tree made of Shares.\n */\nconst Mirrorable = require(\"@cosmic-plus/jsutils/mirrorable\")\nconst nice = require(\"@cosmic-plus/jsutils/nice\")\nconst Projectable = require(\"@cosmic-plus/jsutils/projectable\")\n\nconst Asset = require(\"./asset\")\nconst Order = require(\"./order\")\nconst strategy = require(\"./strategy\")\n\n/**\n * Share sizing attributes:\n * size, sizeMin, sizeMax, sizeLock\n * amountMin, amountMax, amountLock\n *\n * Strategies: equal, marketCap,... (inertia, change7D, RSI)\n * Filters: change30d, RSI\n */\n\nconst Share = module.exports = class Share extends Projectable {\n  static forPortfolio (portfolio, template) {\n    const share = template ? Share.fromString(template) : new Share()\n    share.portfolio = portfolio\n    share.errors = new Mirrorable()\n    share.goal = 100\n\n    portfolio.share = share\n    portfolio.trap(\"total\", () => share.compute(portfolio.total))\n\n    // Add/Remove assets after trustline change.\n    portfolio.assets.forEach(asset => {\n      if (\n        !share.childs.find(child => asset === child.asset)\n        && asset.isSupported\n      )\n        share.childs.push(new Share(asset))\n    })\n    share.childs.forEach((child, index) => {\n      if (\n        !portfolio.assets.find(asset => asset === child.asset)\n        || !child.asset.isSupported\n      )\n        share.childs.splice(index, 1)\n    })\n    portfolio.assets.listen(\"add\", asset => {\n      if (asset.isValid) share.childs.push(new Share(asset))\n    })\n    portfolio.assets.listen(\"remove\", asset => {\n      const index = share.childs.findIndex(child => child.asset === asset)\n      share.childs.splice(index, 1)\n    })\n\n    return share\n  }\n\n  constructor (asset) {\n    super()\n\n    if (asset) {\n      this.asset = asset\n      this.mode = \"amount\"\n      this.size = asset.amount\n      this.order = Order.rebalance(this)\n      asset.shares.push(this)\n      asset.project(\"value\", this)\n    } else {\n      this.childs = new Mirrorable()\n      this.childs.listen(\"add\", child => {\n        child.parent = this\n        this.compute()\n      })\n    }\n\n    // Normalize & compute\n    this.trap(\"size\", () => {\n      if (this.size) {\n        this.size = Math.max(0, this.size)\n        if (this.mode === \"percentage\") this.size = Math.min(100, this.size)\n      }\n      this.compute()\n    })\n  }\n\n  get root () {\n    if (this.parent) return this.parent.root\n    else return this\n  }\n\n  compute () {\n    if (this.parent) {\n      this.parent.compute()\n    } else if (this.portfolio && this.portfolio.total) {\n      this.errors.splice(0, this.errors.length)\n      this.modified = this.hasChanged()\n      strategy.apply(this, this.portfolio.total)\n    }\n  }\n\n  hasChanged () {\n    return this.template !== this.toString()\n  }\n\n  static fromString (string) {\n    const template = JSON.parse(string)\n    const share = Share.fromTemplate(template)\n    share.template = string\n    return share\n  }\n\n  static fromTemplate (template) {\n    if (typeof template === \"string\") template = { asset: template }\n\n    const share = template.asset\n      ? new Share(Asset.resolve(template.asset))\n      : new Share()\n\n    share.size = template.size\n    share.mode = template.mode\n\n    if (!template.asset) {\n      share.name = template.group\n      template.childs.forEach(entry =>\n        share.childs.push(Share.fromTemplate(entry))\n      )\n    }\n\n    return share\n  }\n\n  toString (beautify) {\n    const template = this.toTemplate()\n    return JSON.stringify(template, null, beautify && 2)\n  }\n\n  toTemplate () {\n    let template = {}\n\n    if (this.size != null) template.size = this.size\n    if (this.mode != null && this.mode !== \"equal\") template.mode = this.mode\n\n    if (this.asset) {\n      template.asset = this.asset.code\n      if (Object.keys(template).length === 1) template = template.asset\n    } else if (this.childs) {\n      if (this.name) template.group = this.name\n      template.childs = this.childs.map(share => share.toTemplate())\n    }\n\n    return template\n  }\n}\n\nShare.define(\"delta\", [\"value\", \"target\"], function () {\n  return +nice(this.value - this.target, 7)\n})\nShare.define(\"divergence\", [\"delta\", \"target\"], function () {\n  return this.target ? this.delta / this.target : null\n})\n\n/*\n[\n  {\n    \"group\": \"Fiats\"\n    \"size\": \"50\",\n    \"childs\": [\n      { \"asset\": \"USD\", \"size\": \"30\", \"min\": { \"amount\": \"2000\" }},\n      { \"asset\": \"EUR\", \"size\": \"20\", \"min\": { \"amount\": \"500\" }},\n      { \"asset\": \"CNY\", \"size\": \"20\" },\n      { \"asset\": \"GBP\", \"size\": \"20\" }\n  },\n  {\n    //\"group\": \"Native\"\n    \"size\": \"25\",\n    \"strategy\": \"marketCap\",\n    \"childs\": [\"XLM\", \"SLT\", \"MOBI\"]\n  },\n  {\n    //\"group\": \"Tether\",\n    \"size\": \"25\",\n    \"strategy\": [[\"marketCap\", 25], [\"equal\", 25], [\"change7D\", 25], [\"inertia\", 25]],\n    \"childs\": [{ \"asset\": \"BTC\", \"min\": { \"amount\": \"0.05\", \"size\": \"20\" }}, \"ETH\", [10, \"byMarketCap\"]]\n  }\n]\n\n[\n  {\n    \"group\": \"Fiat\",\n    \"size\": 50,\n    \"strategy\": \"equal\",\n    \"childs\": [\"USD\", \"EUR\", \"GBP\", \"CNY\"]\n  },\n  {\n    \"group\": \"Native\",\n    \"size\": 20,\n    \"strategy\": [[\"marketCap\", 25], [\"equal\", 25], [\"inertia\", 50]]\n  }\n  { \"asset\": \"BTC\", \"size\": 10 },\n  { \"asset\": \"ETH\", \"size\": 5 },\n  { \"asset\": \"XRP\", \"size\": 3 }\n]\n\n*/\n","\"use_strict\"\n/**\n * Rebalancing strategies\n */\nconst strategy = exports\n\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nstrategy.apply = function (share, total) {\n  if (!share.childs) return share.target = total\n\n  let used = 0\n  const computed = []\n  const remaining = []\n  const strat = share.mode || \"equal\"\n\n  share.childs.forEach(child => {\n    if (child.mode === \"skip\" || child.mode === \"amount\") {\n      child.target =\n        child.size != null\n          ? child.asset.price * child.size\n          : child.asset.price * child.asset.amount\n      child.goal = 100 * child.target / total\n      if (child.goal > 100) {\n        child.root.errors.push(\n          `${child.asset.code}: ${__(\"Order over portfolio total\")}`\n        )\n      }\n      used += child.goal\n    } else if (child.size != null) {\n      child.goal = child.size\n      used += child.size\n      computed.push(child)\n    } else {\n      remaining.push(child)\n    }\n  })\n\n  if (total < 0) throw new Error(\"Rebalancing impossible\")\n\n  if (used > 100 || used !== 100 && !remaining.length) {\n    makeTotal100(computed, used)\n    remaining.forEach(share => share.goal = 0)\n  } else if (remaining.length) {\n    method[strat](remaining, 100 - used)\n  }\n\n  computed.concat(remaining).forEach(child => {\n    strategy.apply(child, total * child.goal / 100)\n  })\n}\n\nfunction makeTotal100 (targets, used) {\n  const space = 100 - used\n  targets.forEach(target => target.goal += space * target.goal / used)\n}\n\n/*******************************************************************************\n * Strategies\n */\n\nconst method = {}\n\nmethod.equal = function (shares, space) {\n  const goal = space / shares.length\n  shares.forEach(share => share.goal = goal)\n}\n","\"use_strict\"\n/**\n * Various helpers\n */\n\nconst helpers = exports\n\nhelpers.isOverflowing = function (element) {\n  return (\n    element.scrollHeight > element.clientHeight\n    || element.scrollWidth > element.clientWidth\n  )\n}\n","\"use_strict\"\n/**\n * Footer\n */\nconst { CosmicLink } = require(\"cosmic-lib\")\n\nconst Gui = require(\"@cosmic-plus/jsutils/gui\")\nconst html = require(\"@cosmic-plus/jsutils/html\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst global = require(\"./global\")\nconst SideFrame = require(\"./side-frame\")\n\nconst MYPUBKEY = \"GAWO2C52D57XBT7SQL6YB3XPHFLFD2J4Z5RN7HPFZSHXJMXH72HRXNV3\"\n\n/**\n * Class\n */\n\nclass Footer extends Gui {\n  constructor (icons, links) {\n    super(\n      `\n<footer id=\"footer\" class=\"scrollable\">\n  <div class=\"nobreak\">%icons...</div>\n  %links\n</footer>\n    `,\n      { icons, links }\n    )\n  }\n}\n\n/**\n * Footer Icons\n */\n\nclass Icon extends Gui {\n  constructor (title, href, svg) {\n    super(\n      `<a class=\"Icon\" %href %title target=\"_blank\" rel=\"noopener\">%svg</a>`,\n      { title, href, svg }\n    )\n  }\n}\n\n/**\n * Donate\n */\n\nfunction donate () {\n  const amount = prompt(`\\\n${__(\"Equilibre.io runs on donation.\")}\n\n${__(\n    \"Please contribute to its development according to what you think the service worth.\"\n  )}\n\n${__(\"Enter an amount (in Lumens)\")}:\n`)\n\n  if (isNaN(Number(amount))) {\n    confirm(`${__(\"Not a valid amount\")}: ${amount}`)\n  } else if (amount) {\n    const cosmicLink = new CosmicLink({\n      memo: __(\"Donation to Equilibre.io\"),\n      network: \"public\"\n    }).addOperation(\"payment\", { amount, destination: MYPUBKEY })\n    new SideFrame(cosmicLink.uri)\n  }\n}\n\nconst donateIcon = new Gui(`<a class=\"Icon\" %title %onclick>%svg</a>`, {\n  title: __(\"Donate\"),\n  svg: new Gui(\n    `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"none\" d=\"M0 0h512v512H0z\"/><path d=\"M211.719 367.797C219.469 379.281 224 393.109 224 408c0 39.734-32.266 72-72 72-39.758 0-72-32.266-72-72 0-23.172 11.148-43.563 28.164-56.734 1.852 5.594 4.336 11.125 8.289 15.906 7.055 8.516 20.336 18.266 43.531 16.344 7.578-.641 15.844-2.547 24.586-5.641 8.875-3.078 18.508-6.5 27.149-10.078zM389.875 32.578c-13.344 3.797-24.156 10.672-38.813 18.328-90 47-196.25 39.25-220 77-27.469 51.672-48.883 89.203-48.945 107.625-.016.063-.055.094-.07.141.586 19.953 19.625 58.438 29.07 75.969 6.789-15.516 17.492-29.219 32.25-40.688 7.414-5.766 13.289-9.922 18.617-13.5-3.016-9.25-6.945-20.016-10.875-28.203 10.742-7.391 26.078-26.484 31.398-40.313 13.227.094 30.25-3.172 44.773-6.938 6.406 6.844 12.977 13.563 21.766 20.016-3.961 14.344-7.07 27.063-23.438 38.359-22.313 15.438-42.734 21.578-69.484 43.109-16.086 12.953-26.07 28.203-30.625 45.641-3.148 12.094 4.734 53.016 58 33.141 10.023-3.75 23.398-8.531 34.875-14.25 23.797-11.813 52.922-40.781 61-44.828 15.234-7.641 49.813-10.656 86.313-35.016 12.531-8.375 22.063-20.688 26.477-33.625 33.242-64.828 60.883-59.656 68.633-72.563C477.734 133.734 423.563 23 389.875 32.578z\"/></svg>`\n  ),\n  onclick: donate\n})\n\n/**\n * Icons\n *\n * SVG from @fortawesome/font-awesome-free\n * CC BY 4.0 License (https://creativecommons.org/licenses/by/4.0/)\n */\n\nconst icons = [\n  new Icon(\n    \"Keybase\",\n    \"https://keybase.io/team/cosmic_plus\",\n    new Gui(\n      `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 412.3 512\"><path d=\"M177.2 430.9c0 9.8-8 17.8-17.8 17.8s-17.8-8-17.8-17.8 8-17.8 17.8-17.8c9.8-.1 17.8 7.9 17.8 17.8zM270 413c-9.8 0-17.8 8-17.8 17.8s8 17.8 17.8 17.8 17.8-8 17.8-17.8-8-17.8-17.8-17.8zm142.3-36c0 38.9-7.6 73.9-22.2 103h-27.3c23.5-38.7 30.5-94.8 22.4-134.3-16.1 29.5-52.1 38.6-85.9 28.8-127.8-37.5-192.5 19.7-234.6 50.3l18.9-59.3-39.9 42.3c4.8 26.7 15.7 51.3 31.2 72.3H46.1c-9.7-15.8-17.2-33-22.2-51.3L.1 454c0-74.9-5.5-147.6 61.5-215.2 20.2-20.4 43.7-36.2 69.1-46.7-6.8-13.5-9.5-29.2-7.8-46l-19.9-1.2c-17.9-1.1-31.6-16.5-30.6-34.4v-.1L74 84.2c1.1-17.1 15.4-30.6 32.5-30.6 1.3 0-.3-.1 28.2 1.7 13.9.8 21.5 9.8 22.8 11.4 7.1-10.4 14.5-20.5 24.6-34.5l20.6 12.1c-13.6 29-9.1 36.2-9 36.3 3.9 0 13.9-.5 32.4 5.7C246 92.9 262 107 271 126c.4.9 15.5 29 1.2 62.6 19 6.1 51.3 19.9 82.4 51.8 36.6 37.6 57.7 87.4 57.7 136.6zM128 122.3c3.2-10 7.7-19.7 13.1-29.4.1-2 2.2-13.1-7.8-13.8-28.5-1.8-26.3-1.6-26.7-1.6-4.6 0-8.3 3.5-8.6 8.1l-1.6 26.2c-.3 4.7 3.4 8.8 8.1 9.1l23.5 1.4zm25.8 61.8c5.6 9.4 14.1 16.1 22.3 20 0-21.2 28.5-41.9 52.8-17.5l8.4 10.3c20.8-18.8 19.4-45.3 12.1-60.9-13.8-29.1-46.9-32-54.3-31.7-10.3.4-19.7-5.4-23.7-15.3-13.7 21.2-37.2 62.5-17.6 95.1zm82.9 68.4L217 268.6c-1.9 1.6-2.2 4.4-.6 6.3l8.9 10.9c1 1.2 3.8 2.7 6.3.6l19.6-16 5.5 6.8c4.9 6 13.8-1.4 9-7.3-63.6-78.3-41.5-51.1-55.3-68.1-4.7-6-13.9 1.4-9 7.3 1.9 2.3 18.4 22.6 19.8 24.3l-9.6 7.9c-4.6 3.8 2.6 13.3 7.4 9.4l9.7-8 8 9.8zm118.4 25.7c-16.9-23.7-42.6-46.7-73.4-60.4-7.9-3.5-15-6.1-22.9-8.6-2 2.2-4.1 4.3-6.4 6.2l31.9 39.2c10.4 12.7 8.5 31.5-4.2 41.9-1.3 1.1-13.1 10.7-29 4.9-2.9 2.3-10.1 9.9-22.2 9.9-8.6 0-16.6-3.8-22.1-10.5l-8.9-10.9c-6.3-7.8-7.9-17.9-5-26.8-8.2-9.9-8.3-21.3-4.6-30-7.2-1.3-26.7-6.2-42.7-21.4-55.8 20.7-88 64.4-101.3 91.2-14.9 30.2-18.8 60.9-19.9 90.2 8.2-8.7-3.9 4.1 114-120.9l-29.9 93.6c57.8-31.1 124-36 197.4-14.4 23.6 6.9 45.1 1.6 56-13.9 11.1-15.6 8.5-37.7-6.8-59.3zM110.6 107.3l15.6 1 1-15.6-15.6-1-1 15.6z\"/></svg>`\n    )\n  ),\n  new Icon(\n    \"Telegram\",\n    \"https://t.me/cosmic_plus\",\n    new Gui(\n      `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"><path d=\"M446.7 98.6l-67.6 318.8c-5.1 22.5-18.4 28.1-37.3 17.5l-103-75.9-49.7 47.8c-5.5 5.5-10.1 10.1-20.7 10.1l7.4-104.9 190.9-172.5c8.3-7.4-1.8-11.5-12.9-4.1L117.8 284 16.2 252.2c-22.1-6.9-22.5-22.1 4.6-32.7L418.2 66.4c18.4-6.9 34.5 4.1 28.5 32.2z\"/></svg>`\n    )\n  ),\n  new Icon(\n    \"Reddit\",\n    \"https://reddit.com/r/cosmic_plus\",\n    new Gui(\n      `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path d=\"M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z\"/></svg>`\n    )\n  ),\n  new Icon(\n    \"Twitter\",\n    \"https://twitter.com/cosmic_plus\",\n    new Gui(\n      `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path d=\"M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z\"/></svg>`\n    )\n  ),\n  new Icon(\n    \"Medium\",\n    \"https://medium.com/cosmic-plus\",\n    new Gui(\n      `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"><path d=\"M0 32v448h448V32H0zm372.2 106.1l-24 23c-2.1 1.6-3.1 4.2-2.7 6.7v169.3c-.4 2.6.6 5.2 2.7 6.7l23.5 23v5.1h-118V367l24.3-23.6c2.4-2.4 2.4-3.1 2.4-6.7V199.8l-67.6 171.6h-9.1L125 199.8v115c-.7 4.8 1 9.7 4.4 13.2l31.6 38.3v5.1H71.2v-5.1l31.6-38.3c3.4-3.5 4.9-8.4 4.1-13.2v-133c.4-3.7-1-7.3-3.8-9.8L75 138.1V133h87.3l67.4 148L289 133.1h83.2v5z\"/></svg>`\n    )\n  ),\n  new Icon(\n    \"GitHub\",\n    \"https://github.com/cosmic-plus/webapp-equilibre-io\",\n    new Gui(\n      `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 496 512\"><path d=\"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z\"/></svg>`\n    )\n  ),\n  new Icon(\n    __(\"Website\"),\n    \"https://cosmic.plus\",\n    new Gui(\n      `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 496 512\"><path d=\"M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z\"/></svg>`\n    )\n  ),\n  new Icon(\n    __(\"Email\"),\n    \"mailto:mister.ticot@cosmic.plus\",\n    new Gui(\n      `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path d=\"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z\"/></svg>`\n    )\n  ),\n  donateIcon\n]\n\n/**\n * Demo Page\n */\nfunction displayDemo () {\n  localStorage[`target:${MYPUBKEY}`] = demoConfig\n  location.href = `?address=${MYPUBKEY}`\n}\n\nconst demoConfig = `{\"childs\":[\"EUR\",\"CNY\",\"USD\",{\"size\":12.5,\"mode\":\"percentage\",\"asset\":\"XLM\"},{\"size\":12.5,\"mode\":\"percentage\",\"asset\":\"ETH\"},{\"size\":12.5,\"mode\":\"percentage\",\"asset\":\"BTC\"},{\"size\":4,\"mode\":\"percentage\",\"asset\":\"SLT\"},{\"size\":4,\"mode\":\"percentage\",\"asset\":\"REPO\"},{\"size\":2.25,\"mode\":\"percentage\",\"asset\":\"PEDI\"},{\"size\":2.25,\"mode\":\"percentage\",\"asset\":\"TERN\"}]}`\n\n/**\n * Links\n */\nconst links = new Gui(\n  `\n<p>\n  <a target=\"_blank\" rel=\"noopener\" href=\"https://cosmic.plus\">${__(\n    \"A Cosmic.Plus Software\"\n  )}</a>\n  − <a onclick=%displayDemo>${__(\"Demo\")}</a>\n  − <a target=\"_blank\" rel=\"noopener\" href=\"https://nucleo.fi/leaderboard/top/?span=3m\">Performance</a>\n  − <a onclick=%displayLicense>${__(\"License\")}</a>\n  − <a onclick=%displayAbout>${__(\"About\")}</a>\n</p>\n`,\n  {\n    displayDemo,\n    displayLicense: () => global.tabs.select(\"#license\"),\n    displayAbout: () => global.tabs.select(\"#about\")\n  }\n)\n\n/**\n * Create footer\n */\n\nconst footer = new Footer(icons, links)\nhtml.append(document.body, footer)\n"],"sourceRoot":""}