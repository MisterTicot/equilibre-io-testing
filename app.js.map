{"version":3,"sources":["webpack:///./src/app.js","webpack:///../domutils/es5/gui.js","webpack:///../jsutils/es5/nice.js","webpack:///./src/helpers/misc.js","webpack:///../node-cosmic-lib/es5/specs.js","webpack:///./src/logic/asset.js","webpack:///../node-cosmic-lib/es5/resolve.js","webpack:///../node-cosmic-lib/es5/index.js","webpack:///../node-cosmic-lib/es5/status.js","webpack:///../jsutils/es5/mirrorable.js","webpack:///../node-cosmic-lib/es5/decode.js","webpack:///../base/es5/stellar-sdk.js","webpack:///../jsutils/es5/env.js","webpack:///../node-cosmic-lib/es5/config.js","webpack:///../node-cosmic-lib/es5/convert.js","webpack:///../node-cosmic-lib/es5/check.js","webpack:///./src/logic/balance.js","webpack:///../node-cosmic-lib/es5/format.js","webpack:///../node-cosmic-lib/es5/signers-utils.js","webpack:///../node-cosmic-lib/es5/normalize.js","webpack:///../node-cosmic-lib/es5/destruct.js","webpack:///../node-cosmic-lib/es5/sep7-utils.js","webpack:///./src/logic/anchor.js","webpack:///./src/widgets/helpers/highstock-theme.js","webpack:///../domutils/es5/tabs.js","webpack:///../base/es5/axios.js","webpack:///../node-cosmic-lib/es5/event.js","webpack:///../node-cosmic-lib/es5/construct.js","webpack:///../node-cosmic-lib/es5/encode.js","webpack:///../node-cosmic-lib/es5/parse.js","webpack:///../node-cosmic-lib/es5/expand.js","webpack:///./src/logic/history.js","webpack:///./src/logic/orderbook.js","webpack:///../loopcall/es5/index.js","webpack:///./src/helpers/click-wall.js","webpack:///./src/helpers/form.js","webpack:///./src/helpers/html-extra.js","webpack:///./src/helpers/dialog.js","webpack:///../domutils/es5/params.js","webpack:///./src/logic/portfolio.js","webpack:///../node-cosmic-lib/es5/cosmiclink.js","webpack:///../node-cosmic-lib/es5/helpers/side-frame.js","webpack:///../node-cosmic-lib/es5/helpers/click-wall.js","webpack:///../node-cosmic-lib/bundled/cosmic-link.svg.js","webpack:///../node-cosmic-lib/es5/action.js","webpack:///../node-cosmic-lib/es5/load.js","webpack:///./src/logic/market-data.js","webpack:///../base/es5/aliases.js","webpack:///./src/logic/offers.js","webpack:///./src/logic/portfolio-historic-value.js","webpack:///./src/logic/portfolio-historic-balances.js","webpack:///./src/helpers/bind-dom-key.js","webpack:///./src/helpers/handle-extra-attributes.js","webpack:///./src/activity-gui.js","webpack:///./src/widgets/active-offers-table.js","webpack:///./src/portfolio-gui.js","webpack:///./src/widgets/asset-price-chart.js","webpack:///./src/widgets/portfolio-pie-chart.js","webpack:///./src/widgets/portfolio-historic-value-chart.js","webpack:///./src/widgets/portfolio-table.js","webpack:///./src/settings-gui.js","webpack:///./src/rebalance-gui.js","webpack:///./src/helpers/modal.js","webpack:///./src/logic/target.js","webpack:///./src/logic/order.js","webpack:///./src/logic/strategy.js","webpack:///./src/widgets/target-setup.js","webpack:///./src/widgets/target-setup-anchors.js","webpack:///./src/widgets/target-setup-size.js","webpack:///./src/widgets/targets-controls.js","webpack:///./src/widgets/targets-table.js","webpack:///./src/widgets/asset-selector.js","webpack:///./bundled/welcome.html","webpack:///./bundled/disclaimer.html","webpack:///./src/footer.js","webpack:///./src/helpers/donate.js","webpack:///./src/helpers/icon.js"],"names":["ledger","trezor","dom","require","Gui","html","Tabs","params","__","global","Portfolio","ClickWall","Form","ActivityGui","PortfolioGui","SettingsGui","RebalanceGui","license","welcome","disclaimer","disconnectHardwareWallets","loginForm","then","info","connect","publicKey","login","error","getTrezorModule","disconnect","address","$set","clickWall","enable","resolve","portfolio","setTimeout","listen","initGui","destroy","selected","location","hash","tabs","remove","add","replace","href","content","reflow","select","MYPUBKEY","displayDemo","localStorage","demoConfig","register","Asset","knownAssets","fiat","type","isTether","foreign","currency","nav","header","selector","view","main","loginTab","demoLink","onclick","show","onsubmit","loginWithLedger","loginWithTrezor","page","window","scrollTo","_slicedToArray","_toConsumableArray","_classCallCheck","_possibleConstructorReturn","_getPrototypeOf","_assertThisInitialized","_inherits","Projectable","ellipsis","_","prevchar","func","identifier","concat","variable","linkAttribute","obj","src","el","dest","style","substr","tagName","key","event","transformer","bind","functionBinder","link","addEventListener","groupEvent","module","exports","_Projectable","_this","template","arguments","length","undefined","values","this","call","domTree","create","innerHTML","string","expand","childNodes","dataset","domNode","apply","Object","defineProperty","enumerable","writable","rewriteNode","attributes","filter","attribute","name","forEach","value","match","node","click","parentNode","insertBefore","nextSibling","uniqueName","childs","push","group","onchange","removeNamedItem","_attribute$value$subs","split","_attribute$value$subs2","_src","_dest","_src2","rewriteAttributes","nodeName","object","currentNode","replacer","trap","init","rewriteVariable","ref","convert","compute","array","oldNodes","parent","removeChild","Array","entry","expandEllipsis","old","forget","mirror","map","rewriteEllipsis","rewriteTemplate","child","keys","keysFiltered","project","indexOf","assign","counter","srcElement","precisionAuto","opts","significant","precision","str","String","firstNonZero","search","pointIndex","Math","round","isNaN","Number","min","max","toFixed","misc","positive","number","negative","fixed7","clamp","absoluteMin","value1","value2","abs","arrayContains","arrayRemove","item","index","splice","arrayOnlyInFirst","array1","array2","arraySum","reduce","sum","x","arrayScale","targetSum","specs","field","transactionOptionalFields","fieldDesc","network","horizon","callback","memo","source","sequence","minTime","maxTime","fee","isTransactionField","find","operationMandatoryFields","accountMerge","allowTrust","bumpSequence","changeTrust","createAccount","createPassiveOffer","createPassiveSellOffer","inflation","manageData","manageOffer","manageBuyOffer","manageSellOffer","pathPayment","payment","setOptions","operationOptionalFields","operationFields","isOperationField","operation","fieldType","amount","asset","assetCode","assetIssuer","authorize","bumpTo","buyAmount","buying","clearFlags","destAsset","destAmount","destination","highThreshold","homeDomain","inflationDest","limit","lowThreshold","masterWeight","medThreshold","memoBinary","memoHash","memoId","memoReturn","memoText","memoType","offerId","price","path","selling","sendAsset","sendMax","setFlags","signer","signerHash","signerKey","signerType","signerTx","signerWeight","startingBalance","trustor","types","_loop","_field","neutralAccountId","FIAT_BASEURL","FIAT_IMAGEFORMAT","Mirrorable","marketData","Orderbook","id","table","image","code","fiats","toLowerCase","useGlobalPrice","cryptos","anchors","balances","offers","balance","watch","orderbook","forAsset","define","globalPrice","streamPrice","crypto","small","historicPrice","assetHistory","amountMin","rawLiabilities","assets","defaults","getAllInfo","getInfo","refreshPrices","refreshCryptoPrices","refreshFiatPrices","prices","setInterval","console","log","_regeneratorRuntime","_asyncToGenerator","StellarSdk","status","_addressResolver","mark","_callee5","conf","account","accountId","wrap","_context5","prev","next","FederationServer","sent","account_id","Error","memo_type","aliases","alias","abrupt","t0","shorter","fail","stop","accountResolver","_x6","_x7","_x8","_accountResolver","_callee6","quietFlag","server","accountResponse","_context6","loadAccount","response","makeAccountResponse","Account","cache","signers","public_key","weight","resolveTxSource","_x14","_x15","_resolveTxSource","_callee7","_context7","signersTableToSignersList","signersTable","current","Server","useNetwork","warn","passphrase","networkPassphrase","currentPassphrase","Network","use","currentNetwork","networkName","promise","_x","_x2","addressResolver","_ref","_callee","_context","_x3","_x4","_x5","isAccountEmpty","txSourceAccount","_ref2","_callee2","baseAccount","_context2","sub","_baseAccount","_x9","_x10","_x11","txSources","transaction","extra","operations","a","txSigners","_ref3","_callee3","_context3","t1","done","_x12","_x13","txSignersList","_ref4","_callee4","_context4","_x16","_x17","_cosmicplus","setHiddenProperty","env","exportModule","config","layer","_len","_key","_config","exposeModule","withConfig","library","prototype","__proto__","_this$module","_class","CosmicLink","isBrowser","load","_require","isWebHandlerSupported","registerWebHandler","sep7Utils","errorContinuation","continuation","errors","update","_statusNode","grab","textContent","errorStatus","addClass","errorsNode","lineNode","append","makeHtmlNode","statusNode","statusLine","errorLine","_createClass","_wrapNativeSuper","hiddenKey","trapped","_Array","_getPrototypeOf2","initTraps","_this2","subscribers","_this3","i","suppr","_this$trapped","_this4","removed","slice","_len2","objects","_key2","ret","updateTraps","propagate","trigger","makeMethod","method","addFlag","_this$trapped2","_this5","_len3","_key3","returned","extend","reflect","diff","untrap","removeTraps","addTraps","_entry","func1","_entry2","func2","decode","check","normalize","query","parser","tdesc","param","odesc","decodeURIComponent","process","assetLower","temp","issuer","assetsList","matched","Date","toISOString","numerator","denominator","n","d","nodeRequire","document","isNode","versions","isEmbedded","self","top","stealth_require","eval","setupNetwork","Networks","PUBLIC","TESTNET","all","addAliases","definitions","set","removeAliases","clickHandlers","defaultClickHandlers","setClickHandler","clearClickHandler","construct","destruct","encode","uriToQuery","uri","queryToTdesc","tdescToJson","JSON","stringify","tdescToTransaction","transactionToXdr","toEnvelope","toXDR","xdrToSep7","xdr","options","locker","sep7","encodeURIComponent","pubkey","msg","url","originDomain","signature","xdrToTransaction","Transaction","strip","signatures","xdrToQuery","transactionToTdesc","jsonToTdesc","json","parse","tdescToQuery","queryToUri","_typeof","errDesc","isValid","txField","e","operationType","operationField","message","num","integer","parseInt","utf8","isUtf8","base64","isBase64","assetsArray","_boolean","buffer","date","flags","threshold","Anchor","Balance","anchor","makeId","known","record","recordToParams","hasTrustline","forBalance","addChild","target","opening","action","targetAmount","balanceTargetDeviation","targetMin","targetMax","targetMinDiff","targetMaxDiff","fromRecord","asset_type","asset_code","asset_issuer","buying_liabilities","selling_liabilities","format","nice","signersUtils","parentProperty","element","property","infoNode","trNode","domainNode","verifySep7","className","_index","opNode","retNode","sourceNode","addressNode","meaning","operationMeaning","fieldNode","txt","signersNode","utils","signersList","sources","div","accountSignersNode","title","titleNode","listNode","signerNode","hasSigned","firstChild","makeAccountSignersNode","parentOdesc","parentIndex","parentTdesc","eventObject","constructor","cosmicLink","callClickHandler","_resolveAddressAndUpdate","animation","errorNode","resolveAddressAndUpdate","nicified","assetNode","assetsArrayNode","toLocaleString","valueNode","typeNode","value3","StrKey","decodeSha256Hash","toString","weightNode","_resolve","SignersUtils","_resolve2","extendFlag","txHash","utilities","hasSigner","keypair","Keypair","fromPublicKey","verify","removeEmptyFields","dateFields","shifted","setMinutes","getMinutes","XLM","tx","neutralAccount","stripNeutralAccount","stripNeutralSequence","_memo","_switch","timeBounds","op","line","assetPath","timestamp","sdkMemo","_arm","_value","sdkSequence","sdkSigner","ed25519PublicKey","sha256Hash","preAuthTx","Buffer","timeout","handler","description","navigator","registerProtocolHandler","parseRequest","sep7Request","parseLink","_sep7","parsePayLink","parseTxLink","parseLinkCommons","from","mode","verifySignature","signLink","domain","payload","makePayload","sign","getDomainKeypair","toml","signingKey","StellarTomlResolver","URI_REQUEST_SIGNING_KEY","alloc","helpers","emit","addAsset","tetherCode","isArray","Highstock","theme","rangeSelector","inputBoxBorderColor","buttonTheme","fill","states","hover","color","chart","backgroundColor","fontFamily","xAxis","lineColor","tickColor","yAxis","maskFill","outlineColor","gridLineColor","series","tooltip","fontSize","scrollbar","enabled","credits","plotOptions","column","dataGrouping","pie","allowPointSelect","cursor","dataLabels","spline","pieColors","pieResponsive","rules","condition","maxWidth","chartOptions","legend","showInLegend","distance","_Mirrorable","Nav","Selector","View","Content","findIndex","generate","TabsContent","option","onselect","component","_Gui","TabsNav","links","tab","_Gui2","TabsSelector","selectedOptions","_Gui3","TabsView","axios","alert","classList","contains","preimage","prompt","copyString","makeTransactionBuilder","_makeTransactionBuilder","_callee9","baseFee","txOpts","sourceAccount","builder","memoValue","_short","_context9","fetchBaseFee","timebounds","TransactionBuilder","TimeoutInfinite","addMemo","Memo","txBuilder","addOperation","build","t2","Operation","_ref5","_ref6","_ref7","constructedAsset","_x18","_ref8","_callee8","_context8","_x19","_x20","command","encodedValue","guessType","setTdesc","_query","_tdesc","_json","_xdr","sep7ToXdr","_transaction","encodeURI","dispatch","rule","_networkPassphrase","xdrUri","History","setCache","history","getCache","cut","latest","join","oldData","newData","start","time","day","oneDay","today","roundTime","setUTCHours","missingDays","numberToDays","cosmicLib","base","quote","offersCallBuilder","updateOffersPrices","streamOffers","getOffers","ingest","areOffersEquals","bids","normalizeOffers","asks","side","merged","sortOffers","b","volume","baseVolume","quoteVolume","sort","row","mergedRow","quoteAmount","mergeOffers","baseAsset","quoteAsset","basePrice","bestBid","bestAsk","midpoint","marketPrice","spread","isFetched","and","findOffer","last","childsNum","offer","findAsk","findBid","depth","loop","callAnswer","records","splitAt","tailRecords","loopWithBreakpoints","_loopWithBreakpoints","nextRecord","breaker","callBuilder","callerLimit","_args","hidden","body","opacity","delay","isEnabled","htmlOverflow","documentElement","overflow","bodyOverflow","setOpacity","hide","disable","transition","background","position","zIndex","width","height","bindDomKey","handleExtraAttributes","getAttribute","preventDefault","bindInputs","submit","reset","$status","rewrite","report","spinner","binder","$node","walk","disabled","label","button","control","tag","required","textarea","placeholder","unshift","selectedIndex","input","datetime","shift","Modal","Dialog","actions","hasNoTitle","hasNoContent","dialog","modal","close","open","Promise","confirm","querySelector","focus","replaceState","writeQuery","Offers","portfolioHistoricValue","accountCallBuilder","isSupported","checkNetwork","streamAccount","getAccount","maybeAddBalance","accountMinimumBalance","forPortfolio","stream","maybeAddAsset","maybeRemoveBalance","maybeRemoveAsset","accounts","get","entries","data_attr","availableAssets","allAssets","getHistory","total","SideFrame","initCosmicLink","_verifySep","checkLock","lock","keypairs_or_preimage","send","_htmlDescription","makeHtmlDescription","_htmlLink","makeHtmlLink","formatsFields","htmlDescription","deprecated","clear","_transactionNode","_signersNode","htmlLink","Observable","cosmicLinkIcon","_Observable","shadow","closeButton","CloseButton","sandbox","transform","frameWindow","contentWindow","data","right","border","backgroundImage","backgroundRepeat","backgroundPosition","backgroundSize","padding","willChange","fontWeight","borderBottomLeftRadius","_setOpacity","_destroy","_disable","_enable","_args4","applyLock","_applyLock","updateSignersNode","replaceChild","sendToHorizon","_sendToHorizon","submitTransaction","sendToStellarGuard","post","result","allFine","keypairsOrPreimage","_short2","_short3","_args2","signHashX","_args3","STELLARGUARD_PUBKEY","styles","css","getPriceHistory","coingeckoCall","exchangeratesCall","symbols","start_at","rates","EUR","missing","list","symbol","toUpperCase","apiId","stellarNative","tickers","coin_id","localization","market_data","community_data","developer_data","sparkline","ids","vs_currencies","assetData","vs_currency","days","total_volumes","end_at","setDate","getDate","publicKeys","GDZCEWJ5TVXUTFH6V5CVDQDE43KRXYUFRHKI7X64EWMVOVYYZJFWIFQ2","GASWJWFRYE55KC7MGANZMMRBK5NPXT3HMPDQ6SEXZN6ZPWYXVVYBFRTE","GDUKMGUGDZQK6YHYA5Z6AY2G4XDSZPSZ3SW5UN3ARVMO6QSRDWP5YLEX","GAEGOS7I6TYZSVHPSN76RSPIVL3SELATXZWLFO4DIAFYJF7MPAHFE7H4","GAUTUYY2THLF7SGITDFMXJVYH3LHDSMGEAKSBU267M2K7A3W543CKUEF","GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR","GC5LOR3BK6KIOK7GKAUD5EGHQCMFOGHJTC7I3ELB66PTDFXORC2VM5LP","GCYKQ2627BPKMSUZJK64GPYVKD4TRNACP45X6B754PR6TCYJXCHGUTWB","GAUWES2POH347NNJGRI4OBM34LMOCMWSTZ3RAOZMOBH4PFVBWFMHLNTC","GDZURZR6RZKIQVOWZFWPVAUBMLLBQGXP2K5E5G7PEOV75IYPDFA36WK4","GABQBEZCNQRUHURCG6E2UZC6QXXEPLALHBVA6J6IQNKNJL66VPY7FO7G","GACVB2E6IEV2UT6IDVOO5B5CNN7WPKJFR36B7KD7ZNXDANPTSYNMZYQM","GAHK7EEG2WWHVKDNT4CEQFZGKF2LGDSW2IVM4S5DP42RBW3K6BTODB4A","GCO2IP3MJNUOKS4PUDI4C7LGGMQDJGXG3COYX3WSB4HHNAHKYV5YL3VC","GBOXNWGBB7SG3NVIA7O25M7JIRSXQ4KKU3GYARJEFMQXSR3APF3KRI6S","GAWPTHY6233GRWZZ7JXDMVXDUDCVQVVQ2SXCSTG3R3CNP5LQPDAHNBKL","GD4J347D3NT267QWCMJDZKJPEQFO2VENLZV6NUHFJQIDVMHGPWYRZ2BC","GB6YPGW5JFMMP2QB2USQ33EUWTXVL4ZT5ITUNCY3YKVWOJPP57CANOF3","GDZHCJ73D23MJ76OAR2NQQICB3D3ENUPFT6KVYON3KXY73U6SWN25SU5","GBBAMI2WU6WJHDL3CQKT4LPXUC76WCEMQJMJIVQGL2G5IKJ2JHEVHG3G","GATTH3VPK4PMXLE7JSEJ3OC72OYOGJYINLHSCJX365BP6SAV6GKSHJAV","GB7GRJ5DTE3AA2TCVHQS2LAD3D7NFG7YLTOEWEBVRNUUI2Q3TJ5UQIFM","GB3RMPTL47E4ULVANHBNCXSXM2ZA5JFY5ISDRERPCXNJUDEO73QFZUNK","GBV4ZDEPNQ2FKSPKGJP2YKDAIZWQ2XKRQD4V4ACH3TCTFY6KPY3OAVS7","GBRPTWEZTUKYM6VJXLHXBFI23M2GSY3TCVIQSZKFQLMOJXH7VPDGKBDP","GBOAYBE3NJKS4WPIVM2H5DVFIDYLAHHD2DAWYL5LLUVYF77M3JIVGCTR","GCJGYOH2EYW6FFISLBA3L3R3PUYCQ6DQ47GXVAMG7JLLIKPAPV3RLBSV","GBDUXW4E5WRM5EM6UXBLE7Y5XGSXJX472BSSBPKFPQ3PJCJHRIA6SH4C","GBP4RYNGHJXLLSMUA4ZXE7TZBN7ILFUTLTIKUJFJQGALD3764HJBB5AX","GDQP2KPQGKIHYJGXNUIYOMHARUARCA7DJT5FO2FFOOKY3B2WSQHG4W37","GBUQWP3BOUZX34TOND2QV7QQ7K7VJTG6VSE7WMLBTMDJLLAW7YKGU6EP","GAWODAROMJ33V5YDFY3NPYTHVYQG7MJXVJ2ND3AOGIHYRWINES6ACCPD","GDMXNQBJMS3FYI4PFSYCCB4XODQMNMTKPQ5HIKOUWBOWJ2P3CF6WASBE","GA4BYMUO5D7OLGVJWZ2D5FCWU7SB63FNZ4QUU574SMNA6ELK5TZD3SO3","GABSZVZBYEO5F4V5LZKV7GR4SAJ5IKJGGOF43BIN42FNDUG7QPH6IMRQ","GBWZHAVWY23QKKDJW7TXLSIHY5EX4NIB37O4NMRKN2SKNWOSE5TEPCY3","GCVBUIXKKLH2DYHZRSLZUIZSVJUL74RTW6FVCCEYB2OE3RH7RVDBPCFG","GDBCHKTHJUKDGSIQSTBUXFWVP3QVART5LED6KRZQ5X4Z5WLT4BGYXWCI","GDU2FEL6THGGOFDHHP4I5FHNWY4S2SXYUBCEDB5ZREMD6UFRT4SYWSW2","GD7UVDDJHJYKUXB4SJFIC6VJDQ4YADQCMRN3KLHJFV4H6NIUAEREVCO7","GCGEQJR3E5BVMQYSNCHPO6NPP3KOT4VVZHIOLSRSNLE2GFY7EWVSLLTN","GBKTJSNUSR6OCXA5WDWGT33MNSCNQHOBQUBYC7TVS7BOXDKWFNHI4QNH","GAQ6W5I7LIWQAE47ZY7EQWRVVF2JELYXG6OKL7HHOSL5MWVEIGRPGYCO","GAZEX2USUBMMWFRZFS77VDJYXUFLXI4ZGFPWX6TBNZCSTEQWNLFZMXFF","GBETHKBL5TCUTQ3JPDIYOZ5RDARTMHMEKIO2QZQ7IOZ4YC5XV3C2IKYU","GCMS2VO5ANJCESJBZVC3INFSETS3K4UWMU47W7KSQ2BYASEQAN4NUSTM","GCNY5OXYSY4FKHOPT2SPOQZAOEIGXB5LBYW3HVU3OWSTQITS65M5RCNY","GCC4YLCR7DDWFCIPTROQM7EB2QMFD35XRWEQVIQYJQHVW6VE5MJZXIGW","GC75WHUIMU7LV6WURMCA5GGF2S5FWFOK7K5VLR2WGRKWKZQAJQEBM53M","GBUAVXCI7JKH6D2ZHZ6KZ7Z5MHHCXHI4DSUUC4KOISDMRPVY3MRBF3OY","GDGDECMFS34OVTQJKTCHORPE7LOYDH2XYNRMUHLGCJFP56VUN6AW5LCF","GBUYUAI75XXWDZEKLY66CFYKQPET5JR4EENXZBUZ3YXZ7DS56Z4OKOFU","GDRSWSKJCIB6Z65UA7W5RG62A7M5K3A5IHMED6DYHLPLWLVQCOOGDQ7S","GARFMAHQM4JDI55SK2FGEPLOZU7BTEODS3Y5QNT3VMQQIU3WV2HTBA46","GDYNTGXBDWARLJ34GRQ4ON4EGBXSTPR5LEDTD5LLOOHPS6EZU6QXIIYO","GCXDR4QZ4OTVX6433DPTXELCSEWQ4E5BIPVRRJMUR6M3NT4JCVIDALZO","GAJ7V3EMD3FRWAPBEJAP7EC4223XI5EACDZ46RFMY5DYOMCIMWEFR5II","GA6KR5DMGJ6OPPG4OONB65JPU3TZE2CWCLKTBV4DHXFA2Z4XKWQSVCTC","GB2X6RCO2VAXOD7GXE5VJWXOUTYDKPHIAHJSM2CGZJXKZSIHREEP4654","GB6DMQ5IZUPRRMNTPU4H5FX32DRYCZ447REBEQ32YGVPPGZI5MX4AHOT","GC4KAS6W2YCGJGLP633A6F6AKTCV4WSLMTMIQRSEQE5QRRVKSX7THV6S","GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P","GBBRMEXJMS3L7Y3DZZ2AHBD545GZ72OAEHHEFKGZAHHASHGWMHK5P6PL","GANZBUS4726LBT2CBJ3BGF3TP4NJT5MHZMI423NHMXFRWGO2DCBQEXYZ","GCQHDR2KSCVNULFX3C2NKFEXNJEUELJVMQAN3OCLAM5KXG4DWQSRMXYZ","GD4T35DMXYDE7BJWYPUWK43VFJO5IBUQYG2YGMICPTWP4JTNWQELKAVA","GBTBVILDGCOIK26EPEHYCMKM7J5MTQ4FD5DO37GVTTBP45TVGRAROQHP","GA5XIGA5C7QTPTWXQHY6MCJRMTRZDOSHR6EFIBNDQTCQHG262N4GGKTM","GB6JTIT5PHAZA4VMFI7TGGG44TE3LEDFPG52GSKBZOPDDDMNJAGSF46T","GBJNV2MQA7M5GNBRDFW46JLXIN7ZLYVVM4UW4CWDZO4KZKXIXCRYHMH2","GCTLB7LW7B5ON4QIBIDEWA7MC2KJL2NZEXK24RU32QNOB5IMMCGNLMBD","GC3L2FLR2QMUSOJ6QMQHKIWUKEXGOXSIN2KY72SDUHPC2KO6HOSQIXIF","GD2RRX6BKVTORZ6RIMBLWFVUOAYOLTS2QFJQUQPXLI3PBHR3TMLQNGZX","GCCD6AJOYZCUAQLX32ZJF2MKFFAUJ53PVCFQI3RHWKL3V47QYE2BNAUT","GBVB43NLVIP2USHXSKI7QQCZKZU2Z6U6A5PAHMIW7LLNVMQJTOX2BZI5","GDTEQF6YGCKLIBD37RJZE5GTL3ZY6CBQIKH7COAW654SYEBE6XJJOLOW","GD2YURFWC5LIRLM4CCVZZHCFV6WXO46VOSBBPTJG6MPQN6ANYZZOLQJL","GA6HCMBLTZS5VYYBCATRBRZ3BZJMAFUDKYYF6AH6MVCMGWMRDNSWJPIH","GAKBPBDMW6CTRDCXNAPSVJZ6QAN3OBNRG6CWI27FGDQT2ZJJEMDRXPKK","GB56YLTH5SDOYTUGPWY5MXJ7VQTY7BEM2YVJZTN5O555VA6DJYCTY2MP","GATEMHCCKCY67ZUCKTROYN24ZYT5GK4EQZ65JJLDHKHRUZI3EUEKMTCH","GAXELY4AOIRVONF7V25BUPDNKZYIVT6CWURG7R2I6NQU26IQSQODBVCS","GBTCBCWLE6YVTR5Y5RRZC36Z37OH22G773HECWEIZTZJSN4WTG3CSOES","GD6RMKTCHQGEOGYWIKSY5G7QWXPZOAEZIKPKEVZUAXOQCZRVBRRFGLJM","GDNXSZSF7HIGVRL2LG6VWXN5PWV3KHI77DQTHLLPKNPLUZFKRRDQJBXP","GBOEEVARKVASOQSSXCAHNTGJTVALJE2QM3AQQ2K3VXACQ6JJREQRJZKB","GDPB3BGHJAHAKVIWUNLST7N6OGZ73W6AUAI7QDZJW26LEWL46VDAKBH6","GCVWTTPADC5YB5AYDKJCTUYSCJ7RKPGE4HT75NIZOUM4L7VRTS5EKLFN","GBGVRE5DH6HGNYNLWQITKRQYGR4PWQEH6MOE5ELPY3I4XJPTZ7CVT4YW","GBR3RS2Z277FER476OFHFXQJRKYSQX4Z7XNWO65AN3QPRUANUASANG3L","GBVUDZLMHTLMZANLZB6P4S4RYF52MVWTYVYXTQ2EJBPBX4DZI2SDOLLY","GBIL5TOVTZFNV3XS3E2LWTKU5SYOJ3UBCVBSKAMP4EE4MV2VSZQK7NRZ","GBQWA6DU6OXHH4AVTFCONQ76LHEWQVZAW7SFSW4PPCAI2NX4MJDZUYDW","GAJWJTV5GW5J2WCBPQNWLAL2EYUIIUB6OIROHOV7YVJJWZXPXQWSMHRH","GCGNWKCJ3KHRLPM3TM6N7D3W5YKDJFL6A2YCXFXNMRTZ4Q66MEMZ6FI2","GAZPKDTEZ5UM3BF4E7FL7EMXRMLH76F2TNVXRLOF6SCVXOFWSPCEWFI5","GCZNF24HPMYTV6NOEHI7Q5RJFFUI23JKUKY3H3XTQAFBQIBOHD5OXG3B","GAREELUB43IRHWEASCFBLKHURCGMHE5IF6XSE7EXDLACYHGRHM43RFOX","GCLDH6L6FBLTD3H3B23D6TIFVVTFBLZMNBC3ZOI6FGI5GPQROL4FOXIN","GB2WB73G5IWRXEUTJANAIF52JFTDXOXORAP4S5HZRW23TZG2ONDVZMVA","GDMS6EECOH6MBMCP3FYRYEVRBIV3TQGLOFQIPVAITBRJUMTI6V7A2X6Z","GCKA6K5PCQ6PNF5RQBF7PQDJWRHO6UOGFMRLK3DYHDOI244V47XKQ4GP","GAIGG2ICK2ATV7VUQC6MZHOSMRMFJK3T65IVNUZ7EJEEAU5UJQPPDIST","GB3KBOFUCVTWEZ7YIZ7PAKLQMKPCTGWU3LOMANMCT7V6I3AAK4USTEEM","GCVHEKSRASJBD6O2Z532LWH4N2ZLCBVDLLTLKSYCSMBLOYTNMEEGUARD","GA6D2S6XDBT7WZIZNDGUBLXUGDAGLZGZ2SYT2JLXD4BB2W76XS66FZ2S","GAENIE5LBJIXLMJIAJ7225IUPA6CX7EGHUXRX5FLCZFFAQSG2ZUYSWFK","GANOI26P6VAUL4NFVA4FAIOIBOR46NORONBIWUPRIGAMP7T5W5MOY4O6","GAX3BRBNB5WTJ2GNEFFH7A4CZKT2FORYABDDBZR5FIIT3P7FLS2EFOZZ","GAYOCVRRNXGQWREOZBDP4UEW475NKZKLA4EIEIBKBSJN2PQQWUQ5KGUH","GB6NVEN5HSUBKMYCE5ZOWSK5K23TBWRUQLZY3KNMXUZ3AQ2ESC4MY4AQ","GBEZOC5U4TVH7ZY5N3FLYHTCZSI6VFGTULG7PBITLF5ZEBPJXFT46YZM","GBVVWWN4YP76FKGO7RB42FSZDYD2PBXY2PJY3F6JJWLYU74TKUG775UP","GCO4EFT6KUOQKVZO2O4GR5CJKMARBORXRE7KAKH36ZFAX662ZHINQ6UA","GDKIJJIKXLOM2NRMPNQZUUYK24ZPVFC6426GZAEP3KUK6KEJLACCWNMX","GDTNE54IWDB3UQLMIUSBKIDTMUW7FNKBU4VB2GVW4OL65BZN7W5VRNVY","GDUY7J7A33TQWOSOQGDO776GGLM3UQERL4J3SPT56F6YS4ID7MLDERI4","GDWNY2POLGK65VVKIH5KQSH7VWLKRTQ5M6ADLJAYC2UEHEBEARCZJWWI","GA5Z7QOQFSNIFFRZ3CDHLOWRPBWHPX5EGCTKT5KXU2CGJD7EIK2ZMALP","GAMA33LC7FK5RF4XE5HOVX456GX4VHDZUCJ7APY4TZ4IHG65ZWVXD333","GAYYPNEDENPNDNVPQD7U54JXMZZYTZAHWJLRRWBLP5PU6PBRSLH7LKNA","GBNWX7R4WVOWEYVKWN7KJ773X6C7OKNIGMVVDQI4B7XXMR6Y4OCUTBX2","GC2PJ6J37QM3DOQ63DVGCXTRC5QOKAJUBQO2XKBXOJCWTCOCP75KWUDX","GCAIDZBFE3WEIZSXQONQKUUTG6VLVKG2BBJYGWKEHQ2FZZ76VR326WYW","GCE3XS3D2F2W5LQWZHLG25ANAFIQOVMORH46JHVXOMW3FN27IPVJEGGG","GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5","GDCHDRSDOBRMSUDKRE2C4U4KDLNEATJPIHHR2ORFL5BSD56G4DQXL4VW","GAFXX2VJE2EGLLY3EFA2BQXJADAZTNR7NC7IJ6LFYPSCLE7AI3AK3B3M","GBSTRH4QOTWNSVA6E4HFERETX4ZLSR3CIUBLK7AXYII277PFJC4BBYOG","GBSTRUSD7IRX73RQZBL3RQUH6KS3O4NYFY3QCALDLZD77XMZOPWAVTUK","GCSTRLTC73UVXIYPHYTTQUUSDTQU2KQW5VKCE4YCMEHWF44JKDMQAL23","GDSTRSHXHGJ7ZIVRBXEYE5Q74XUVCUSEKEBR7UCHEUUEK72N7I7KJ6JH","GCEGERI7COJYNNID6CYSKS5DPPLGCCLPTOSCDD2LG5SJIVWM5ISUPERI","GCZYLNGU4CA5NAWBAVTHMZH4JXWKP2OUJ6OK3I7XXZCNA5622WUJVLTG","GDEGOXPCHXWFYY234D2YZSPEJ24BX42ESJNVHY5H7TWWQSYRN5ZKZE3N","GCTXRQIYWEDP6G7OXZI6IXUSIXHHSN5NKYRB3NI5J4Z7G5JMIBHLLBTC","GAP5LETOV6YIE62YAM56STDANPRDO7ZFDBGSNHJQIYGGKSMOZAHOOS2S","GDGQDVO6XPFSY4NMX75A7AOVYCF5JYGW2SHCJJNWCQWIDGOZB53DGP6C","GDS3XDJAA4VY6MJYASIGSIMPHZ7AQNZ54RKLWT7MWCOU5YKYEVCNLVS3","GDSVWEA7XV6M5XNLODVTPCGMAJTNBLZBXOFNQD3BNPNYALEYBNT6CE2V","GBFJGO46OV6E2QS2ZUMCF256ZL4BFOZWFHULRNLPSPW47HH5HFAKJTON","GAKRDXBHA2TTOYJZQIAQ7ZDS555P24RAYRUUZWU3KHSLIOZMVV4IITXT","GAW4E6NGM4NPNX2LO2BKDPCCTUX3FJLKWHPU4VQPGBIBQGD6JTVF5C7C","GCNHYZLBCSVZHSQJ2DOIBHYBF4J24DJYGS5QKURX4AGSLBK6SDJOYWIN","GASBLVHS5FOABSDNW5SPPH3QRJYXY5JHA2AOA2QHH2FJLZBRXSG4SWXT","GBOFQCVZF2DSFLJPJMKH7CIECCN7TYVAT2CSD73IVEBJJQU2VW6JNFHT","GBZ35ZJRIKJGYH5PBKLKOZ5L6EXCNTO7BKIL7DAVVDFQ2ODJEEHHJXIM","GAO4DADCRAHA35GD6J3KUNOB5ELZE5D6CGPSJX2WBMEQV7R2M4PGKJL5","GA3FUYFOPWZ25YXTCA73RK2UGONHCO27OHQRSGV3VCE67UEPEFEDCOPA","GDSRCV5VTM3U7Y3L6DFRP3PEGBNQMGOWSRTGSBWX6Z3H6C7JHRI4XFJP","loopcall","alive","Offer","clean","forAccount","listOutdated","outdated","intern","recordToId","rawPrice","rawAmount","last_modified_time","last_modified_ledger","portfolioHistoricBalances","markHeldAssets","hasBeenHeld","getHistoricPrices","historicPrices","promises","getHistoricPrice","shrinkHistoricPrices","computeDayValues","filtered","marginals","share","others","getPortfolioHistory","updateBalance","loopUntil","now","effectsLoopcall","ingestRecord","recordDate","created_at","STRONGHOLD_SHUTDOWN","applyStrongholdFix","handle","effects","order","updateData","assetForBalance","recordToBalance","prefix","codeKey","issuerKey","trade","bought_amount","sold_amount","account_credited","account_debited","trustline_removed","trustline_created","account_created","STRONGHOLD_KEY1","STRONGHOLD_KEY2","objKey","$input","nodeKey","importKeyOn","eventName","setCustomValidity","SELECT","$select","interactive","TEXTAREA","$textarea","INPUT","radio","checkbox","$radio","setter","checked","checkBox","$checkbox","setAliases","$label","for","$span","handleLabel","validate","hasProperty","reportValidity","validateNodeValue","handleValidate","ActiveOffersTable","globalCurrency","OfferRow","txParams","AssetPriceChart","PortfolioPieChart","PortfolioHistoricValueChart","PortfolioTable","coingecko","pieChart","maybeDrawPriceChart","historyChart","overview","priceChart","drawChart","stockChart","container","labels","align","resize","offset","makePoint","point","y","niceAmount","nicePrice","draw","colors","responsive","pointFormat","events","legendItemClick","colorByPoint","ignoreHiddenPoint","hasBeenReflown","historyToSeries","shared","footerFormat","formatter","area","stacking","connectNulls","lineWidth","inactive","isEmpty","rows","toAssetRow","AssetRow","selectedRow","simpleView","detailledView","cell","amounts","priceDetails","feed","anchorName","simple","anchorTotal","anchorHeader","languages","us","fr","currencies","general","GeneralSettings","reload","Target","TargetSetup","TargetsControls","TargetsTable","targetKey","toJson","controls","showTargetSetup","setup","cancel","computeAll","styleParams","translate","left","bottom","setPosition","Order","strategy","rebalance","size","closing","root","hasChanged","valueDiff","amountDiff","unpeg","addAnchor","refresh","removeAnchor","sortChilds","localeCompare","fromJson","fromObject","beautifyFlag","toObject","percentChilds","toCosmicLink","toOperations","remaining","o","pop","operationsToCosmicLink","setOperation","shouldOpenTrustline","shouldCloseTrustline","parameters","make","newOperation","getOperation","cost","operationDirection","operationToOdesc","price_r","addOneOperation","noMinValue","baseAsk","minOfferValue","sizeMin","sizeMax","skipMarginalOffers","makeOfferFilter","addMultipleOperations","tradeSize","liquidate","_addToTrade","misallocatedKey","misallocated","sizeKey","tradable","amountsSum","operationsToDescription","desc","market","percentage","spreadTightening","clone","premium","maxSpread","anchorPrice","minPrice","maxPrice","clampOfferPrice","updateOfferPriceR","tightenSpread","amountDelta","liabilities","isActive","setBalancesTargets","areTargetAnchorsBalanced","riskMax","anchorsRebalanceRiskMax","under","over","currentRisk","valueDiffP","amountCap","transferAmount","buy","sell","balanceTargetAnchors","isOneOperationEnough","delayed","weights","remains","allocated","available","checkUnderFlag","margin","misallocationTolerance","overP","underP","checkAllocationLimits","targets","t","liquidity","valueMin","buyTargets","buyValue","sellTargets","sellValue","canSell","throttleRatio","maybeThrottleTargetAmounts","ignore","TargetSetupAnchors","TargetSetupSize","backup","sizeSetup","anchorsSetup","maybeSwitchMode","activeElement","blur","doesPortfolioUseAnchor","AnchorCheckbox","getState","isTargetAnchorActive","switchAnchor","targetIsXlm","modified","AssetSelector","toTargetRow","sortTargets","TargetRow","assetSelector","toCommand","toPercent","groups","natives","addGroup","AssetGroup","AssetRadio","donate","Icon","footer","icons","displayLicense","displayDisclaimer","displayAbout","showDonateFrame","rel"],"mappings":"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","file":"app.js","sourcesContent":["\"use strict\"\n/**\n * Login interface\n */\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst Tabs = require(\"@cosmic-plus/domutils/es5/tabs\")\nconst params = require(\"@cosmic-plus/domutils/es5/params\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst global = require(\"./logic/global\")\nconst Portfolio = require(\"./logic/portfolio\")\n\nconst ClickWall = require(\"./helpers/click-wall\")\nconst Form = require(\"./helpers/form\")\n\nconst ActivityGui = require(\"./activity-gui\")\nconst PortfolioGui = require(\"./portfolio-gui\")\nconst SettingsGui = require(\"./settings-gui\")\nconst RebalanceGui = require(\"./rebalance-gui\")\n\nconst license = new Gui(require(\"@cosmic-plus/assets/html/license.html\"))\nconst welcome = new Gui(require(\"../bundled/welcome.html\"))\nconst disclaimer = new Gui(require(\"../bundled/disclaimer.html\"))\n\n/**\n * Functions\n */\n\nlet ledger\nasync function loginWithLedgerWallet () {\n  disconnectHardwareWallets()\n  loginForm[\"stellar-public-key\"] = null\n  ledger = await getLedgerModule()\n  loginForm.info(__(\"Please open the Stellar App in your Ledger Wallet\"))\n  try {\n    await ledger.connect()\n    loginForm[\"stellar-public-key\"] = ledger.publicKey\n    login()\n  } catch (error) {\n    loginForm.error(error)\n  }\n}\n\nlet trezor\nasync function loginWithTrezorWallet () {\n  disconnectHardwareWallets()\n  loginForm[\"stellar-public-key\"] = null\n  trezor = await getTrezorModule()\n  loginForm.info(__(\"Please import your Trezor public key\"))\n  try {\n    await trezor.connect()\n    loginForm[\"stellar-public-key\"] = trezor.publicKey\n    login()\n  } catch (error) {\n    loginForm.error(error)\n  }\n}\n\nfunction disconnectHardwareWallets () {\n  if (ledger) ledger.disconnect()\n  if (trezor) trezor.disconnect()\n}\n\nasync function login () {\n  const address = loginForm[\"stellar-public-key\"]\n  if (!address) loginForm.error(__(\"Please enter an address.\"))\n  disconnectHardwareWallets()\n\n  loginForm.info(__(\"Connecting to your account...\"))\n  params.$set({ address })\n\n  const clickWall = new ClickWall()\n  clickWall.enable()\n\n  try {\n    global.portfolio = await Portfolio.resolve(address)\n    loginForm.info(`${__(\"Fetching market data\")}...`)\n    setTimeout(\n      () => loginForm.info(`${__(\"Sorry, it takes a while (^.^)\\\"\")}...`),\n      10000\n    )\n    setTimeout(() => loginForm.info(`${__(\"Almost there\")}...`), 20000)\n    setTimeout(\n      () => loginForm.info(`${__(\"I'm running, I'm running\")}...`),\n      30000\n    )\n    global.portfolio.listen(\"open\", () => {\n      initGui()\n      clickWall.destroy()\n    })\n  } catch (error) {\n    clickWall.destroy()\n    loginForm.error(error)\n  }\n}\n\nfunction initGui () {\n  const portfolio = global.portfolio\n\n  const selected = location.hash\n  tabs.remove(\"#welcome\")\n  tabs.remove(\"#login\")\n  tabs.remove(\"#demo\")\n  tabs.add(\"#portfolio\", __(\"Portfolio\"), new PortfolioGui(portfolio))\n  tabs.add(\"#rebalance\", __(\"Rebalance\"), new RebalanceGui(portfolio))\n  tabs.add(\"#activity\", __(\"Activity\"), new ActivityGui(portfolio))\n  tabs.add(\"#settings\", __(\"Settings\"), new SettingsGui())\n  tabs.add(\"#logout\", __(\"Logout\"), () => {\n    location.replace(location.href.replace(/\\?.*$/, \"#login\"))\n  })\n\n  // Fix portfolio pie chart positioning.\n  tabs.listen(\"select\", () => {\n    if (!tabs.selected) return\n    const content = tabs.selected.content\n    if (content.reflow) content.reflow()\n  })\n\n  tabs.select(selected)\n  if (!tabs.selected) tabs.select(\"#portfolio\")\n}\n\n/**\n * Demo Page\n */\nconst MYPUBKEY = \"GAWO2C52D57XBT7SQL6YB3XPHFLFD2J4Z5RN7HPFZSHXJMXH72HRXNV3\"\nfunction displayDemo () {\n  localStorage[`target:${MYPUBKEY}`] = demoConfig\n  location.href = `?address=${MYPUBKEY}`\n}\n\nconst demoConfig = `{\"childs\":[{\"mode\":\"percentage\",\"size\":12.5,\"asset\":\"BTC\"},\"CNY\",{\"mode\":\"percentage\",\"size\":12.5,\"asset\":\"ETH\"},\"EUR\",{\"mode\":\"percentage\",\"size\":1.5625,\"asset\":\"FRAS\"},{\"mode\":\"percentage\",\"size\":1.5625,\"asset\":\"MOBI\"},{\"mode\":\"percentage\",\"size\":1.5625,\"asset\":\"PEDI\"},{\"mode\":\"percentage\",\"size\":1.5625,\"asset\":\"REPO\"},{\"mode\":\"percentage\",\"size\":1.5625,\"asset\":\"RMT\"},{\"mode\":\"percentage\",\"size\":1.5625,\"asset\":\"SHX\"},{\"mode\":\"percentage\",\"size\":1.5625,\"asset\":\"SLT\"},{\"mode\":\"percentage\",\"size\":1.5625,\"asset\":\"TERN\"},\"USD\",{\"mode\":\"percentage\",\"size\":12.5,\"asset\":\"XLM\"}]}`\n\n/**\n * Module loading\n */\n\nfunction getLedgerModule () {\n  return import(\n    /* webpackChunkName: \"ledger\" */ \"@cosmic-plus/ledger-wallet\"\n  ).then(ledger => ledger.default)\n}\n\nasync function getTrezorModule () {\n  const trezor = await import(\n    /* webpackChunkName: \"trezor\" */ \"@cosmic-plus/trezor-wallet\"\n  ).then(trezor => trezor.default)\n  trezor.register(\"equilibre.io\", \"mister.ticot@cosmic.plus\")\n  return trezor\n}\n\n/**\n * Init\n */\n\n// Load known assets.\nconst Asset = require(\"./logic/asset\")\nconst knownAssets = require(\"./data/assets.json\")\nAsset.register(knownAssets.fiat, { type: \"fiat\", isTether: true })\nAsset.register(knownAssets.foreign, { type: \"crypto\", isTether: true })\nAsset.register(knownAssets.native, { type: \"crypto\", isTether: false })\nAsset.resolve(global.currency, { type: \"fiat\", isTether: true })\n\n// Load known anchors.\nconst Anchor = require(\"./logic/anchor\")\nAnchor.register(require(\"./data/anchors.json\"))\n\n// Load footer.\nrequire(\"./footer\")\n\n// Init navigation.\nconst tabs = global.tabs = new Tabs({\n  nav: dom.header,\n  selector: dom.header,\n  view: dom.main\n})\ntabs.add(\"#welcome\", __(\"Welcome\"), welcome)\ntabs.add(\"#demo\", __(\"Demo\"), displayDemo)\ntabs.add(\"#login\", __(\"Login\"), dom.loginTab)\ntabs.add(\"#license\", null, license)\ntabs.add(\"#disclaimer\", null, disclaimer)\ntabs.add(\"#about\", null, welcome)\ndom.demoLink.onclick = displayDemo\nhtml.show(dom.loginTab)\n\ntabs.select(null)\ntabs.select(location.hash)\nif (!tabs.selected) {\n  if (!localStorage[\"PortfolioSummary.tab\"]) tabs.select(\"#welcome\")\n  else tabs.select(\"#login\")\n}\n\n// Init login.\nconst loginForm = new Form(dom.loginForm, { onsubmit: login })\nloginForm.dom.loginWithLedger.onclick = loginWithLedgerWallet\nloginForm.dom.loginWithTrezor.onclick = loginWithTrezorWallet\n\nif (params.address) {\n  tabs.select(\"#login\")\n  loginForm[\"stellar-public-key\"] = params.address\n  login()\n}\n\n// Scrollup on navigation.\ntabs.listen(\"select\", page => {\n  location.hash = page\n  window.scrollTo(0, 0)\n})\n","\"use_strict\";\n/**\n * Component-driven GUI Development\n *\n * API:\n *\n * Reference: -ref=%alias\n * Group:     -group=%alias\n * Label:     -label=\"text\"\n *\n * Attribute: %attr | attr=%alias | attr=%func:alias\n * Content: %alias | %func:alias | %{alias} | %{func:alias}\n *          %alias... | %func:alias... | %{alias...} | %{func:alias...}\n * Escape: \\%example | \\%{example}\n */\n\nrequire(\"core-js/modules/es.array.concat\");\n\nrequire(\"core-js/modules/es.array.filter\");\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.array.index-of\");\n\nrequire(\"core-js/modules/es.array.map\");\n\nrequire(\"core-js/modules/es.function.bind\");\n\nrequire(\"core-js/modules/es.function.name\");\n\nrequire(\"core-js/modules/es.object.assign\");\n\nrequire(\"core-js/modules/es.object.define-property\");\n\nrequire(\"core-js/modules/es.object.keys\");\n\nrequire(\"core-js/modules/es.object.values\");\n\nrequire(\"core-js/modules/es.regexp.exec\");\n\nrequire(\"core-js/modules/es.string.match\");\n\nrequire(\"core-js/modules/es.string.replace\");\n\nrequire(\"core-js/modules/es.string.split\");\n\nrequire(\"core-js/modules/es.string.link\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nrequire(\"core-js/modules/web.timers\");\n\nvar _slicedToArray = require(\"@babel/runtime/helpers/slicedToArray\");\n\nvar _toConsumableArray = require(\"@babel/runtime/helpers/toConsumableArray\");\n\nvar _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\n\nvar _possibleConstructorReturn = require(\"@babel/runtime/helpers/possibleConstructorReturn\");\n\nvar _getPrototypeOf = require(\"@babel/runtime/helpers/getPrototypeOf\");\n\nvar _assertThisInitialized = require(\"@babel/runtime/helpers/assertThisInitialized\");\n\nvar _inherits = require(\"@babel/runtime/helpers/inherits\");\n\nvar Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\");\n\nvar html = require(\"./html\");\n/**\n * Class\n */\n\n\nmodule.exports =\n/*#__PURE__*/\nfunction (_Projectable) {\n  \"use strict\";\n\n  _inherits(Gui, _Projectable);\n\n  function Gui() {\n    var _this;\n\n    var template = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n    var values = arguments.length > 1 ? arguments[1] : undefined;\n\n    _classCallCheck(this, Gui);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Gui).call(this));\n    var domTree = html.create(\"template\");\n    domTree.innerHTML = expand(template.replace(/^[\\s\\n]*/, \"\").replace(/[\\s\\n]*$/, \"\")); // IE doesn't use .content for template tag\n\n    var content = domTree.content || domTree;\n\n    if (content.childNodes.length > 1 || content.childNodes[0].dataset.type === \"ellipsis\") {\n      _this.domNode = html.create.apply(html, [\"div\", null].concat(_toConsumableArray(content.childNodes)));\n    } else {\n      _this.domNode = content.childNodes[0];\n    }\n\n    Object.defineProperty(_assertThisInitialized(_this), \"domNode\", {\n      enumerable: false,\n      writable: false\n    });\n    rewriteNode(_assertThisInitialized(_this), _this.domNode);\n\n    if (values) {\n      var keys = Object.keys(_assertThisInitialized(_this));\n      var keysFiltered = keys.filter(function (key) {\n        return key !== \"style\";\n      });\n      if (values instanceof Projectable) values.project(keysFiltered, _assertThisInitialized(_this));else keysFiltered.forEach(function (key) {\n        return _this[key] = values[key];\n      });\n      if (keys.indexOf(\"style\") !== -1) Object.assign(_this.style, values.style);\n    }\n\n    _this.listen(\"destroy\", function () {\n      return _this.domNode.innerHTML = null;\n    });\n\n    return _this;\n  }\n\n  return Gui;\n}(Projectable);\n/**\n * Parser\n */\n\n\nfunction expand(template) {\n  return template // Firefox fix\n  .replace(/\\s(on\\w+)=(%\\w+)/g, \" .$1=$2\") // Apply only on content outside of HTML tags.\n  .replace(/(^|>)[^<>]*(<|$)/g, function (string) {\n    return string // %function:identifier...\n    .replace(/(^|[^\\\\])%(\\w+):(\\w+)\\.\\.\\./g, ellipsis) // %identifier...\n    .replace(/(^|[^\\\\])%()(\\w+)\\.\\.\\./g, ellipsis) // %{function:identifier...}\n    .replace(/(^|[^\\\\])%{(\\w+):(\\w+)\\.\\.\\.}/g, ellipsis) // %{identifier...}\n    .replace(/(^|[^\\\\])%{()(\\w+)\\.\\.\\.}/g, ellipsis) // %function:identifier\n    .replace(/(^|[^\\\\])%(\\w+):(\\w+)/g, variable) // %identifier\n    .replace(/(^|[^\\\\])%()(\\w+)/g, variable) // %{function:identifier}\n    .replace(/(^|[^\\\\])%{(\\w+):(\\w+)}/g, variable) // %{identifier}\n    .replace(/(^|[^\\\\])%{()(\\w+)}/g, variable);\n  });\n}\n\nfunction ellipsis(_, prevchar, func, identifier) {\n  return \"\".concat(prevchar, \"<template data-type=\\\"ellipsis\\\" data-func=\\\"\").concat(func, \"\\\">\").concat(identifier, \"</template>\");\n}\n\nfunction variable(_, prevchar, func, identifier) {\n  return \"\".concat(prevchar, \"<template data-type=\\\"variable\\\" data-func=\\\"\").concat(func, \"\\\">\").concat(identifier, \"</template>\");\n}\n/**\n * Rewriter\n */\n\n\nfunction rewriteNode(obj, el) {\n  if (el.attributes) rewriteAttributes(obj, el);\n  if (el.nodeName === \"TEMPLATE\") rewriteTemplate(obj, el);\n  el.childNodes.forEach(function (child) {\n    return rewriteNode(obj, child);\n  });\n}\n\nfunction rewriteAttributes(obj, el) {\n  Object.values(el.attributes).filter(function (attribute) {\n    return attribute.name;\n  }).forEach(function (attribute) {\n    if (attribute.name === \"-ref\" && attribute.value.match(/^%\\w+$/)) {\n      obj[attribute.value.substr(1)] = el;\n    } else if (attribute.name === \"-label\") {\n      var node = html.create(\"label\", {\n        \"for\": el,\n        onclick: function onclick() {\n          return el.click();\n        }\n      }, html.create(\"span\", null, attribute.value));\n      el.parentNode.insertBefore(node, el.nextSibling); // TODO: better aliases for -group\n    } else if (attribute.name === \"-group\" && attribute.value.match(/^%\\w+$/)) {\n      var key = attribute.value.substr(1);\n      if (!obj[key]) obj[key] = {\n        name: uniqueName(),\n        childs: []\n      };\n      obj[key].childs.push(el);\n      el.group = obj[key];\n      el.name = obj[key].name;\n      el.onchange = groupEvent;\n    } else if (attribute.name.match(/^%\\w+$/)) {\n      var src = attribute.name.substr(1);\n      linkAttribute(obj, src, el, src);\n      el.attributes.removeNamedItem(attribute.name);\n    } else if (attribute.value.match(/^%\\w+:\\w+$/)) {\n      var dest = attribute.name;\n\n      var _attribute$value$subs = attribute.value.substr(1).split(\":\"),\n          _attribute$value$subs2 = _slicedToArray(_attribute$value$subs, 2),\n          func = _attribute$value$subs2[0],\n          _src = _attribute$value$subs2[1];\n\n      linkAttribute(obj, _src, el, dest, obj[func].bind(obj));\n    } else if (attribute.value.match(/^%\\w+$/)) {\n      var _dest = attribute.name;\n\n      var _src2 = attribute.value.substr(1);\n\n      linkAttribute(obj, _src2, el, _dest);\n    }\n  });\n}\n\nfunction linkAttribute(obj, src, el, dest, func) {\n  if (dest === \"class\") dest = \"className\";\n  if (dest === \"style\") obj[src] = el.style;\n  if (dest.substr(0, 3) === \".on\") dest = dest.substr(1); // Make sure two-way binding happens before onchange/onclick event.\n  // TODO: check if a clearer way exists.\n\n  if ((el.tagName === \"INPUT\" || el.tagName === \"SELECT\") && dest.substr(0, 2) === \"on\") {\n    var key = dest;\n    dest = \".\".concat(dest);\n\n    el[key] = function (event) {\n      return setTimeout(function () {\n        return el[dest] && el[dest](event);\n      }, 1);\n    };\n  }\n\n  var transformer = func ? func.bind(obj) : functionBinder.bind(obj);\n  obj.link(src, el, dest, transformer); // Two-ways binding.\n\n  if (el.tagName === \"SELECT\" && (dest === \"value\" || dest === \"selectedIndex\" || dest === \"selectedOptions\")) {\n    el.addEventListener(\"change\", function () {\n      return obj[src] = el[dest];\n    });\n  } else if (el.tagName === \"INPUT\" && el.type !== \"radio\" && (el.type !== \"checkbox\" && dest === \"value\" || el.type === \"checkbox\" && dest === \"checked\")) {\n    el.addEventListener(\"input\", function () {\n      return obj[src] = el[dest];\n    });\n  } else if (el.tagName === \"INPUT\" && el.type === \"radio\" && dest === \"checked\") {\n    el.addEventListener(\"change\", function (event) {\n      obj[src] = el[dest];\n      groupEvent(event);\n    });\n  }\n}\n\nfunction rewriteTemplate(object, el) {\n  if (el.dataset.type === \"variable\") rewriteVariable(object, el);else if (el.dataset.type === \"ellipsis\") rewriteEllipsis(object, el);\n}\n\nfunction rewriteVariable(object, el) {\n  var currentNode = el;\n  var key = el.innerHTML;\n  var func = el.dataset.func && object[el.dataset.func].bind(object);\n  var replacer = func ? function () {\n    return currentNode = html.replace(currentNode, func(object[key]));\n  } : function () {\n    return currentNode = html.replace(currentNode, object[key]);\n  };\n  object.trap(key, replacer, {\n    init: false\n  }); // Two-way binding\n  // if (parent.tagName === \"TEXTAREA\" &&)\n}\n\nfunction rewriteEllipsis(obj, el) {\n  var key = el.innerHTML;\n  var func = el.dataset.func && obj[el.dataset.func].bind(obj);\n  var ellipsis = [],\n      ref = html.convert(\"\");\n  html.replace(el, ref);\n\n  var compute = function compute(array) {\n    ellipsis = expandEllipsis(ref, ellipsis, array);\n  };\n\n  var update = function update(event) {\n    // TODO: better memory management\n    if (event.old && typeof event.old.forget === \"function\") {\n      event.old.forget(\"change\", compute);\n    }\n\n    if (event.value && typeof event.value.mirror === \"function\") {\n      if (func) event.value.mirror(func.bind(this)).listen(\"change\", compute);else event.value.listen(\"change\", compute);\n    }\n\n    if (func && event.value) compute(event.value.map(func));else compute(event.value);\n  };\n\n  obj.trap(key, update, {\n    init: false\n  });\n}\n\nfunction expandEllipsis(ref, oldNodes) {\n  var array = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n  var parent = ref.parentNode;\n  oldNodes.forEach(function (node) {\n    if (node.parentNode === parent) {\n      parent.removeChild(node);\n    }\n  });\n  if (!(array instanceof Array)) array = [array];\n  var ellipsis = [];\n  array.forEach(function (entry) {\n    var node = html.convert(entry);\n    ellipsis.push(node);\n    parent.insertBefore(node, ref);\n  });\n  return ellipsis;\n}\n/**\n * Helpers\n */\n\n\nvar uniqueName = function () {\n  var counter = 0;\n  return function () {\n    counter++;\n    return \"group.\".concat(counter);\n  };\n}();\n\nfunction groupEvent(event) {\n  if (!event) return;\n  var el = event.srcElement;\n  el.group.value = el.value;\n  el.group.childs.forEach(function (child) {\n    if (child !== el && child.onchange) child.onchange();\n  });\n}\n\nfunction functionBinder(value) {\n  if (typeof value === \"function\") return value.bind(this);else return value;\n}","\"use_strict\";\n/**\n * Nice formating of numbers.\n *\n * @example\n * nice(35)                     // => 35.00\n * nice(35, 4)                  // => 35.0000\n * nice(35, { significant: 2})  // => 35\n * nice(35, { min: 3 })         // => 35.000\n * nice(35, { max: 1 })         // => 35.0\n *\n * @param  {String|Number} value The value to format\n * @param  {Number} [precision] Short form for `options.precision`\n * @param  {Object} [options]\n * @param  {Number} [options.precision=null] How much digit after the dot.\n *     Override options.significant.\n * @param  {Number} [options.significant=4] How much significant numbers (+/-\n *     one).\n * @param  {Number} [options.min=null] Minimum number of digits after the dot.\n * @param  {Number} [options.max=null] Maximum number of digits after the dot.\n * @return {String} The formatted value\n */\n\nrequire(\"core-js/modules/es.array.index-of\");\n\nrequire(\"core-js/modules/es.number.constructor\");\n\nrequire(\"core-js/modules/es.number.to-fixed\");\n\nrequire(\"core-js/modules/es.regexp.exec\");\n\nrequire(\"core-js/modules/es.string.search\");\n\nmodule.exports = function (value) {\n  var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  if (typeof opts === \"number\") opts = {\n    precision: opts\n  };\n  if (value === undefined || isNaN(value)) return \"...\";else if (value == 0) return 0;\n\n  if (opts.precision == null) {\n    opts.precision = precisionAuto(Number(value), opts);\n  }\n\n  if (opts.min != null) opts.precision = Math.max(opts.min, opts.precision);\n  if (opts.max != null) opts.precision = Math.min(opts.max, opts.precision);\n  return Number(value).toFixed(opts.precision);\n};\n\nfunction precisionAuto(value, opts) {\n  if (opts.significant == null) opts.significant = 4;\n  var precision = 0;\n  var str = String(value);\n  var firstNonZero = str.search(/[^0.]/);\n\n  if (firstNonZero) {\n    precision = firstNonZero + opts.significant - 2;\n  } else {\n    var pointIndex = str.indexOf(\".\");\n\n    if (pointIndex === -1) {\n      precision = opts.significant - str.length;\n    } else if (pointIndex < opts.significant) {\n      precision = opts.significant - pointIndex;\n    }\n  }\n\n  if (precision) precision = Math.round(precision / 2) * 2;\n  return precision > 0 ? precision : 0;\n}","\"use strict\"\n/**\n * Various independent helpers.\n */\nconst misc = exports\n\n/**\n * Returns **number** if it is greater than 0, else returns 0.\n */\nmisc.positive = function (number) {\n  return Math.max(0, number)\n}\n\n/**\n * Returns **number** if it is lesser than 0, else returns 0.\n */\nmisc.negative = function (number) {\n  return Math.min(0, number)\n}\n\n/**\n * Returns **number** with 7 digits after the dot.\n */\nmisc.fixed7 = function (number) {\n  return +Number(number).toFixed(7)\n}\n\n/**\n * Returns a number whose value is limited to the given range.\n */\nmisc.clamp = function (value, min, max) {\n  return Math.min(Math.max(value, min), max)\n}\n\n/**\n * Returns **value1** if its absolute is lesser than or equal **value2**\n * absolute, else returns **value2**.\n */\nmisc.absoluteMin = function (value1, value2) {\n  return Math.abs(value1) <= Math.abs(value2) ? value1 : value2\n}\n\n/**\n * Return whether or not **array** contains **value**.\n */\nmisc.arrayContains = function (array, value) {\n  return array.indexOf(value) !== -1\n}\n\n/**\n * Remove all the occurences of **item** from **array**.\n */\nmisc.arrayRemove = function (array, item) {\n  for (let index = array.length - 1; index >= 0; index--) {\n    if (array[index] === item) array.splice(index, 1)\n  }\n}\n\n/**\n * Returns values that are in **array1** but not in **array2**.\n */\nmisc.arrayOnlyInFirst = function (array1, array2) {\n  return array1.filter(item => !misc.arrayContains(array2, item))\n}\n\n/**\n * Sum array values, or array elements `key` if specified.\n */\nmisc.arraySum = function (array, key) {\n  if (key) return array.reduce((sum, obj) => sum + obj[key], 0)\n  else return array.reduce((sum, x) => sum + x, 0)\n}\n\n/**\n * Proportionally scale **array** values, or **array** elements **key** property\n * if provided, to make their sum equal **targetSum**.\n */\nmisc.arrayScale = function (array, targetSum, key) {\n  const sum = misc.arraySum(array, key)\n  if (!sum) return array.map(() => 0)\n\n  if (key) return array.map(obj => obj[key] * targetSum / sum)\n  else return array.map(x => x * targetSum / sum)\n}\n","\"use_strict\";\n/**\n * Contains Stellar transactions specification.\n *\n * @exports specs\n */\n\nrequire(\"core-js/modules/es.array.concat\");\n\nrequire(\"core-js/modules/es.array.find\");\n\nvar specs = exports;\n/**\n * Transaction optional fields.\n */\n\nspecs.transactionOptionalFields = [\"network\", \"horizon\", \"callback\", \"memo\", \"source\", \"sequence\", \"minTime\", \"maxTime\", \"fee\"];\n/**\n * Transaction field meaning.\n */\n\nspecs.fieldDesc = {\n  network: \"Network\",\n  horizon: \"Horizon\",\n  callback: \"Callback\",\n  memo: \"Memo\",\n  source: \"Source\",\n  sequence: \"Sequence\",\n  minTime: \"Valid after\",\n  maxTime: \"Valid until\",\n  fee: \"Fees\"\n};\n/**\n * @param {string} field\n * @return {boolean}\n */\n\nspecs.isTransactionField = function (field) {\n  return specs.transactionOptionalFields.find(function (name) {\n    return name === field;\n  });\n};\n/**\n * Operation mandatory fields.\n */\n\n\nspecs.operationMandatoryFields = {\n  accountMerge: [\"destination\"],\n  allowTrust: [\"authorize\", \"assetCode\", \"trustor\"],\n  bumpSequence: [\"bumpTo\"],\n  changeTrust: [\"asset\"],\n  createAccount: [\"destination\", \"startingBalance\"],\n  createPassiveOffer: [\"selling\", \"buying\", \"amount\", \"price\"],\n  createPassiveSellOffer: [\"selling\", \"buying\", \"amount\", \"price\"],\n  inflation: [],\n  manageData: [\"name\", \"value\"],\n  manageOffer: [\"selling\", \"buying\", \"amount\", \"price\"],\n  manageBuyOffer: [\"selling\", \"buying\", \"buyAmount\", \"price\"],\n  manageSellOffer: [\"selling\", \"buying\", \"amount\", \"price\"],\n  pathPayment: [\"sendAsset\", \"sendMax\", \"destination\", \"destAsset\", \"destAmount\"],\n  payment: [\"asset\", \"destination\", \"amount\"],\n  setOptions: []\n};\n/**\n * Operation optionnal fields.\n */\n\nspecs.operationOptionalFields = {\n  accountMerge: [\"source\"],\n  allowTrust: [\"source\"],\n  bumpSequence: [\"source\"],\n  changeTrust: [\"limit\", \"source\"],\n  createAccount: [\"source\"],\n  createPassiveOffer: [\"source\"],\n  createPassiveSellOffer: [\"source\"],\n  inflation: [\"source\"],\n  manageData: [\"source\"],\n  manageOffer: [\"offerId\", \"source\"],\n  manageBuyOffer: [\"offerId\", \"source\"],\n  manageSellOffer: [\"offerId\", \"source\"],\n  pathPayment: [\"path\", \"source\"],\n  payment: [\"source\"],\n  setOptions: [\"inflationDest\", \"clearFlags\", \"setFlags\", \"masterWeight\", \"lowThreshold\", \"medThreshold\", \"highThreshold\", \"signer\", \"homeDomain\", \"source\"]\n};\n/**\n * Operations fields\n */\n\nspecs.operationFields = {};\n\nfor (var field in specs.operationMandatoryFields) {\n  specs.operationFields[field] = specs.operationMandatoryFields[field].concat(specs.operationOptionalFields[field]);\n}\n/**\n * @param {string} type Operation type\n * @param {string} field\n * @return {boolean}\n */\n\n\nspecs.isOperationField = function (operation, field) {\n  return specs.operationFields[operation].find(function (name) {\n    return name === field;\n  });\n};\n/**\n * Field types.\n */\n\n\nspecs.fieldType = {\n  amount: \"amount\",\n  asset: \"asset\",\n  assetCode: \"string\",\n  assetIssuer: \"address\",\n  authorize: \"boolean\",\n  bumpTo: \"sequence\",\n  buyAmount: \"amount\",\n  buying: \"asset\",\n  callback: \"url\",\n  clearFlags: \"flags\",\n  destAsset: \"asset\",\n  destAmount: \"amount\",\n  destination: \"address\",\n  fee: \"amount\",\n  highThreshold: \"threshold\",\n  homeDomain: \"string\",\n  horizon: \"url\",\n  inflationDest: \"address\",\n  limit: \"amount\",\n  lowThreshold: \"threshold\",\n  masterWeight: \"weight\",\n  maxTime: \"date\",\n  medThreshold: \"threshold\",\n  memo: \"memo\",\n  memoBinary: \"hash\",\n  memoHash: \"hash\",\n  memoId: \"id\",\n  memoReturn: \"hash\",\n  memoText: \"string\",\n  memoType: \"string\",\n  minTime: \"date\",\n  network: \"network\",\n  offerId: \"string\",\n  price: \"price\",\n  name: \"string\",\n  path: \"assetsArray\",\n  selling: \"asset\",\n  sendAsset: \"asset\",\n  sendMax: \"amount\",\n  sequence: \"sequence\",\n  setFlags: \"flags\",\n  signer: \"signer\",\n  signerHash: \"hash\",\n  signerKey: \"address\",\n  signerType: \"string\",\n  signerTx: \"id\",\n  signerWeight: \"weight\",\n  source: \"address\",\n  startingBalance: \"amount\",\n  trustor: \"address\",\n  value: \"buffer\"\n};\n/**\n * An array of each valid type for fields.\n */\n\nspecs.types = [];\n\nvar _loop = function _loop(_field) {\n  var type = specs.fieldType[_field];\n  specs.types.find(function (entry) {\n    return entry === type;\n  }) || specs.types.push(type);\n};\n\nfor (var _field in specs.fieldType) {\n  _loop(_field);\n}\n/**\n * A neutral account ID meant to be replaced before signing & sending the\n * transaction.\n * @static\n */\n\n\nspecs.neutralAccountId = \"GAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWHF\";","\"use strict\"\n/**\n * Asset class\n */\n\nconst AUTO_REFRESH_PRICES = true\nconst CRYPTO_PRICES_REFRESH_DELAY = 60 * 1000\nconst FIAT_PRICES_REFRESH_DELAY = 60 * 60 * 1000\nconst FIAT_BASEURL = \"https://www.xe.com/themes/xe/images/flags/svg/\"\nconst FIAT_IMAGEFORMAT = \".svg\"\n\nconst Mirrorable = require(\"@cosmic-plus/jsutils/es5/mirrorable\")\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\n\nconst marketData = require(\"./market-data\")\nconst Orderbook = require(\"./orderbook\")\nconst {\n  fixed7,\n  arrayContains,\n  arrayRemove,\n  arraySum\n} = require(\"../helpers/misc\")\n\n/**\n * Class\n */\n\nconst Asset = module.exports = class Asset extends Projectable {\n  static resolve (id, params) {\n    return Asset.table[id] || new Asset(id, params)\n  }\n\n  constructor (id, params) {\n    super()\n    if (params) Object.assign(this, params)\n\n    this.id = id\n    Asset.table[id] = this\n\n    // Empty image by default\n    this.image = \"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=\"\n\n    if (this.type) {\n      this.code = id\n      if (this.type === \"fiat\") {\n        Asset.fiats.push(this)\n        this.image = `${FIAT_BASEURL}${id.toLowerCase()}${FIAT_IMAGEFORMAT}`\n        this.useGlobalPrice = true\n      } else {\n        Asset.cryptos.push(this)\n        this.type = \"crypto\"\n        if (this.isTether || this.id === \"XLM\") this.useGlobalPrice = true\n      }\n    } else {\n      this.code = id.replace(/:.*/, \"\")\n      this.name = this.code\n      this.type = \"unknown\"\n    }\n\n    this.anchors = new Mirrorable()\n    this.balances = new Mirrorable()\n    this.offers = new Mirrorable()\n\n    this.balances.mirror(balance => {\n      this.watch(balance, \"amount\", () => this.compute(\"amount\"))\n      this.watch(balance, [\"buying\", \"selling\"], () => {\n        this.compute(\"liabilities\")\n      })\n    })\n\n    this.orderbook = Orderbook.forAsset(this)\n    this.define(\"price\", \"globalPrice\", () => {\n      return this.globalPrice || this.orderbook.price\n    })\n    this.watch(this.orderbook, \"price\", () => this.compute(\"price\"))\n  }\n\n  maybeAddBalance (balance) {\n    if (arrayContains(this.balances, balance)) return\n    this.balances.push(balance)\n    if (!balance.orderbook) balance.streamPrice()\n  }\n\n  maybeRemoveBalance (balance) {\n    arrayRemove(this.balances, balance)\n  }\n\n  async getInfo () {\n    // Happens once & only for cryptos.\n    if (this.name || this.type !== \"crypto\") return\n    this.info = await marketData.crypto.info(this)\n    this.name = this.info.name\n    this.image = this.info.image.small\n  }\n\n  async getHistoricPrice () {\n    if (this.historicPrice) return this.historicPrice\n\n    this.historicPrice = await marketData.assetHistory(this)\n    if (!this.historicPrice) return\n\n    // Keep today's price in sync.\n    this.trap(\"price\", () => {\n      const dailyData = this.historicPrice[this.historicPrice.length - 1]\n      dailyData.price = this.price\n    })\n\n    return this.historicPrice\n  }\n}\n\nAsset.define(\"amount\", \"balances\", function () {\n  return this.balances && fixed7(arraySum(this.balances, \"amount\"))\n})\n\nAsset.define(\"value\", [\"amount\", \"price\"], function () {\n  return this.amount === 0 ? 0 : this.amount * this.price\n})\n\nAsset.define(\"valueMin\", [\"amountMin\", \"price\"], function () {\n  return !this.amountMin ? 0 : this.amountMin * this.price\n})\n\nAsset.define(\"liabilities\", [\"balances\", \"price\"], function () {\n  if (this.balances) {\n    const rawLiabilities = this.balances.reduce(\n      (sum, entry) => sum + entry.buying - entry.selling,\n      0\n    )\n    return this.price * rawLiabilities\n  }\n})\n\nAsset.define(\"isSupported\", [\"type\", \"price\"], function () {\n  return !!(this.type !== \"unknown\" || this.price)\n})\n\n/**\n * Utilities\n */\n\n/**\n * Registers **assets** as known assets, assigns **params** to them.\n */\nAsset.register = function (assets, defaults) {\n  for (let code in assets) {\n    const params = Object.assign({}, defaults, assets[code])\n    Asset.resolve(code, params)\n  }\n}\n\n/**\n * Get general information (name, logo, ...) for all known assets.\n */\nAsset.getAllInfo = function () {\n  const assets = Object.values(Asset.table)\n  assets.forEach(asset => asset.getInfo())\n}\n\nAsset.refreshPrices = async function (array) {\n  if (!array) {\n    await Asset.refreshCryptoPrices()\n    await Asset.refreshFiatPrices()\n  } else {\n    await Asset.refreshCryptoPrices(\n      array.filter(asset => asset.type === \"crypto\").map(asset => asset.code)\n    )\n    await Asset.refreshFiatPrices(\n      array.filter(asset => asset.type === \"fiat\").map(asset => asset.code)\n    )\n  }\n}\n\nAsset.refreshCryptoPrices = async function (assets = Asset.cryptos) {\n  if (!assets.length) return\n  const prices = await marketData.crypto.prices(assets)\n  assets.forEach(asset => {\n    if (asset.useGlobalPrice) asset.globalPrice = prices[asset.code]\n  })\n}\n\nAsset.refreshFiatPrices = async function (fiats = Asset.fiats) {\n  if (!fiats.length) return\n  const prices = await marketData.fiat.prices(fiats)\n  fiats.forEach(asset => {\n    if (asset.useGlobalPrice) asset.globalPrice = prices[asset.code]\n  })\n}\n\n/**\n * Init\n */\n\nAsset.table = {}\nAsset.cryptos = []\nAsset.fiats = []\n\n// Automatic global price refresh\nif (AUTO_REFRESH_PRICES) {\n  setInterval(Asset.refreshCryptoPrices, CRYPTO_PRICES_REFRESH_DELAY)\n  setInterval(Asset.refreshFiatPrices, FIAT_PRICES_REFRESH_DELAY)\n}\n\n// eslint-disable-next-line no-console\nconsole.log(Asset.table)\n","\"use strict\";\n/**\n * Contains functions that probe the blockchain or federation servers to collect\n * datas.\n *\n * @exports resolve\n */\n\nrequire(\"core-js/modules/es.array.filter\");\n\nrequire(\"core-js/modules/es.array.find\");\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.array.index-of\");\n\nrequire(\"core-js/modules/es.array.iterator\");\n\nrequire(\"core-js/modules/es.object.keys\");\n\nrequire(\"core-js/modules/es.object.to-string\");\n\nrequire(\"core-js/modules/es.object.values\");\n\nrequire(\"core-js/modules/es.string.sub\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator\");\n\nvar _regeneratorRuntime = require(\"@babel/runtime/regenerator\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator = require(\"@babel/runtime/helpers/asyncToGenerator\");\n\nvar resolve = exports;\n\nvar misc = require(\"@cosmic-plus/jsutils/es5/misc\");\n\nvar StellarSdk = require(\"@cosmic-plus/base/es5/stellar-sdk\");\n\nvar specs = require(\"./specs\");\n\nvar status = require(\"./status\");\n/**\n * Returns the\n * [Server]{@link https://stellar.github.io/js-stellar-sdk/Server.html} object\n * for **horizon**, or for **network**, or for the current network.\n *\n * @param {string} [network] 'public', 'test' or a network passphrase\n * @param {string} [horizon] A horizon URL\n * @returns {Server} A StellarSdk Server object\n */\n\n\nresolve.server = function (conf) {\n  var network = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : conf.network;\n  var horizon = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : conf.horizon;\n  if (!horizon) horizon = resolve.horizon(conf, network);\n  if (!horizon) throw new Error(\"No horizon node defined for selected network.\");\n\n  if (!conf.current.server[horizon]) {\n    conf.current.server[horizon] = new StellarSdk.Server(horizon);\n  }\n\n  return conf.current.server[horizon];\n};\n/**\n * Switch to the current network, or to **network** if provided.\n *\n * @deprecated StellarSdk global `Network` setting is deprecated.\n * @param {string} [network] 'public', 'test' or a network passphrase\n * @returns {Server} A StellarSdk Server object\n */\n\n\nresolve.useNetwork = function (conf) {\n  var network = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : conf.network;\n  // DEPRECATED - to be removed when in sync with stellar-sdk 3.x.\n  console.warn(\"`.selectNetwork()`, `.useNetwork()`, as well as StellarSdk global `Network` setting are deprecated. Please use `cosmicLib.config.network` or pass parameter explicitely.\");\n  var passphrase = resolve.networkPassphrase(conf, network);\n  var currentPassphrase = resolve.networkPassphrase();\n\n  if (passphrase !== currentPassphrase) {\n    // eslint-disable-next-line no-console\n    console.log(\"Switch to network: \" + network);\n    StellarSdk.Network.use(new StellarSdk.Network(passphrase));\n  }\n};\n/**\n * Returns the curent Horizon node URL, or the Horizon node URL for **network**\n * if provided.\n *\n * @param {string} [network] A network name or passphrase.\n */\n\n\nresolve.horizon = function (conf) {\n  var network = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : conf.network;\n\n  if (conf.horizon) {\n    return conf.horizon;\n  } else {\n    var passphrase = resolve.networkPassphrase(conf, network);\n\n    if (conf.current && conf.current.horizon[passphrase]) {\n      return conf.current.horizon[passphrase];\n    }\n  }\n};\n/**\n * Returns the current network passphrase, or the passphrase for **network** is\n * provided.\n */\n\n\nresolve.networkPassphrase = function () {\n  var conf = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var network = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : conf.network;\n\n  if (network === undefined) {\n    // DEPRECATED: To be removed in sync with stellar-sdk 3.x.\n    var currentNetwork = StellarSdk.Network.current();\n    if (currentNetwork) return currentNetwork.networkPassphrase();\n  } else {\n    return conf.current.passphrase[network] || network;\n  }\n};\n/**\n * Returns the network name for **network passphrase**, or `undefined`.\n *\n * @param {string} networkPassphrase\n * @return {string}\n */\n\n\nresolve.networkName = function () {\n  var conf = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var networkPassphrase = arguments.length > 1 ? arguments[1] : undefined;\n  var index = Object.values(conf.current.passphrase).indexOf(networkPassphrase);\n  if (index === -1) return networkPassphrase;else return Object.keys(conf.current.passphrase)[index];\n};\n/**\n * Returns the federation server\n * [Account]{@link https://stellar.github.io/js-stellar-sdk/Account.html}\n * for **address**.\n *\n * @async\n * @param {string} address A Stellar public key or a federated address\n * @return {} Resolve to federation server response\n */\n\n\nresolve.address = function (conf, address) {\n  var cache = conf.cache;\n  if (cache && cache.destination[address]) return cache.destination[address];\n  var promise = addressResolver(conf, address);\n  if (cache) cache.destination[address] = promise;\n  return promise;\n};\n\nfunction addressResolver(_x, _x2) {\n  return _addressResolver.apply(this, arguments);\n}\n/**\n * Returns the\n * [AccountResponse]{@link https://stellar.github.io/js-stellar-sdk/AccountResponse.html}\n * object for **address**.\n *\n * @param {string} address A public key or a federated address\n * @return {Object} The AccountResponse\n */\n\n\nfunction _addressResolver() {\n  _addressResolver = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee5(conf, address) {\n    var account, accountId;\n    return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            _context5.prev = 0;\n            _context5.next = 3;\n            return StellarSdk.FederationServer.resolve(address);\n\n          case 3:\n            account = _context5.sent;\n            accountId = account.account_id;\n\n            if (accountId) {\n              _context5.next = 7;\n              break;\n            }\n\n            throw new Error(\"Unknow address\");\n\n          case 7:\n            if (!account.memo_type) delete account.memo;\n            if (address !== accountId) account.address = address;\n\n            if (conf.aliases && conf.aliases[accountId]) {\n              account.alias = conf.aliases[accountId];\n            }\n\n            return _context5.abrupt(\"return\", account);\n\n          case 13:\n            _context5.prev = 13;\n            _context5.t0 = _context5[\"catch\"](0);\n            console.error(_context5.t0);\n            status.error(conf, \"Can't resolve: \" + misc.shorter(address));\n            status.fail(conf, \"Unresolved address\", \"throw\");\n\n          case 18:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5, null, [[0, 13]]);\n  }));\n  return _addressResolver.apply(this, arguments);\n}\n\nresolve.account =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(conf, address, quietFlag) {\n    var account, accountId, cache, promise;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return resolve.address(conf, address);\n\n          case 2:\n            account = _context.sent;\n            accountId = account.account_id;\n            cache = conf.cache;\n\n            if (!(cache && cache.account[accountId])) {\n              _context.next = 7;\n              break;\n            }\n\n            return _context.abrupt(\"return\", cache.account[accountId]);\n\n          case 7:\n            promise = accountResolver(conf, accountId, quietFlag);\n            if (cache) cache.account[accountId] = promise;\n            return _context.abrupt(\"return\", promise);\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x3, _x4, _x5) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nfunction accountResolver(_x6, _x7, _x8) {\n  return _accountResolver.apply(this, arguments);\n}\n/**\n * Returns `true` if **address** account is empty, `false` otherwise.\n *\n * @async\n * @param {string} address Public key or federated address\n * @return {boolean}\n */\n\n\nfunction _accountResolver() {\n  _accountResolver = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee6(conf, accountId, quietFlag) {\n    var server, accountResponse;\n    return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            server = resolve.server(conf);\n            _context6.prev = 1;\n            _context6.next = 4;\n            return server.loadAccount(accountId);\n\n          case 4:\n            accountResponse = _context6.sent;\n            return _context6.abrupt(\"return\", accountResponse);\n\n          case 8:\n            _context6.prev = 8;\n            _context6.t0 = _context6[\"catch\"](1);\n\n            if (!quietFlag) {\n              _context6.next = 14;\n              break;\n            }\n\n            throw _context6.t0;\n\n          case 14:\n            if (_context6.t0.response) {\n              status.error(conf, \"Empty account: \" + misc.shorter(accountId), \"throw\");\n            } else {\n              status.error(conf, \"Invalid horizon node: \" + resolve.horizon(conf), \"throw\");\n            }\n\n          case 15:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6, null, [[1, 8]]);\n  }));\n  return _accountResolver.apply(this, arguments);\n}\n\nresolve.isAccountEmpty = function (conf, address) {\n  return resolve.account(conf, address, true).then(function () {\n    return false;\n  })[\"catch\"](function () {\n    return true;\n  });\n};\n/**\n * Returns the account object for transaction source **address`** with sequence\n * set at **sequence** if provided. If **address** is not provided, returns the\n * neutral account object instead (as in SEP-0007 specifications).\n *\n * @param {string} [address]\n * @param {string|numbre} [sequence]\n * @return {AccountResponse}\n */\n\n\nresolve.txSourceAccount =\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2(conf, address, sequence) {\n    var destination, account, baseAccount;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (address) {\n              _context2.next = 4;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", makeAccountResponse(conf, specs.neutralAccountId, \"-1\"));\n\n          case 4:\n            _context2.next = 6;\n            return resolve.address(conf, address);\n\n          case 6:\n            destination = _context2.sent;\n            if (destination.memo) status.error(conf, \"Invalid transaction source address (requires a memo)\", \"throw\");\n            _context2.next = 10;\n            return resolve.account(conf, destination.account_id);\n\n          case 10:\n            account = _context2.sent;\n\n            if (sequence) {\n              baseAccount = new StellarSdk.Account(account.id, sequence);\n              baseAccount.sequence = baseAccount.sequence.sub(1);\n              account._baseAccount = baseAccount;\n            }\n\n            return _context2.abrupt(\"return\", account);\n\n          case 13:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function (_x9, _x10, _x11) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n/**\n * Creates an AccountResponse object with signers set for an empty account.\n *\n * @param  {string} publicKey\n * @param  {string} sequence [description]\n * @return {AccountResponse}\n */\n\n\nfunction makeAccountResponse(conf, publicKey, sequence) {\n  var account = new StellarSdk.Account(publicKey, sequence);\n  if (conf.cache) conf.cache.account[publicKey] = account;\n  account.id = publicKey;\n  account.signers = [{\n    public_key: publicKey,\n    weight: 1,\n    key: publicKey,\n    type: \"ed25519_public_key\"\n  }];\n  return account;\n}\n/**\n * Returns the array of all source accounts ID involved in **transaction**.\n *\n * @param {Transaction} transaction\n * @return {Array}\n */\n\n\nresolve.txSources = function (conf, transaction) {\n  if (!transaction.source) throw new Error(\"No source for transaction\");\n  var extra = resolve.extra(conf, transaction);\n  if (extra.cache.txSources) return extra.cache.txSources;\n  var array = extra.cache.txSources = [transaction.source];\n\n  var _loop = function _loop(index) {\n    var source = transaction.operations[index].source;\n    if (source && !array.find(function (a) {\n      return a === source;\n    })) array.push(source);\n  };\n\n  for (var index in transaction.operations) {\n    _loop(index);\n  }\n\n  return array;\n};\n/**\n * Returns an object such as:\n *\n * ```js\n * {\n *    $accountId: $accountSigners\n *    ...\n * }\n * ```\n *\n * @param {Transaction} transaction\n * @return {Object}\n */\n\n\nresolve.txSigners =\n/*#__PURE__*/\nfunction () {\n  var _ref3 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee3(conf, transaction) {\n    var extra, txSources, signers, index, source, account;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            extra = resolve.extra(conf, transaction);\n\n            if (!extra.cache.txSigners) {\n              _context3.next = 3;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", extra.cache.txSigners);\n\n          case 3:\n            txSources = resolve.txSources(extra, transaction);\n            signers = extra.cache.txSigners = {};\n            _context3.t0 = _regeneratorRuntime.keys(txSources);\n\n          case 6:\n            if ((_context3.t1 = _context3.t0()).done) {\n              _context3.next = 15;\n              break;\n            }\n\n            index = _context3.t1.value;\n            source = txSources[index];\n            _context3.next = 11;\n            return resolveTxSource(extra, source);\n\n          case 11:\n            account = _context3.sent;\n\n            if (!signers[account.id]) {\n              signers[account.id] = account.signers.filter(function (signer) {\n                return signer.type !== \"preauthTx\";\n              });\n            }\n\n            _context3.next = 6;\n            break;\n\n          case 15:\n            return _context3.abrupt(\"return\", signers);\n\n          case 16:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n\n  return function (_x12, _x13) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n\nfunction resolveTxSource(_x14, _x15) {\n  return _resolveTxSource.apply(this, arguments);\n}\n/**\n * Returns an Array containing the keys for all legit signers of **transaction**.\n *\n * @param {Transaction} transaction\n * @return {Array}\n */\n\n\nfunction _resolveTxSource() {\n  _resolveTxSource = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee7(conf, address) {\n    return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            _context7.prev = 0;\n            _context7.next = 3;\n            return resolve.account(conf, address, \"quiet\");\n\n          case 3:\n            return _context7.abrupt(\"return\", _context7.sent);\n\n          case 6:\n            _context7.prev = 6;\n            _context7.t0 = _context7[\"catch\"](0);\n            return _context7.abrupt(\"return\", makeAccountResponse(conf, address, \"0\"));\n\n          case 9:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7, null, [[0, 6]]);\n  }));\n  return _resolveTxSource.apply(this, arguments);\n}\n\nresolve.txSignersList =\n/*#__PURE__*/\nfunction () {\n  var _ref4 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee4(conf, transaction) {\n    var extra, txSigners;\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            extra = resolve.extra(conf, transaction);\n\n            if (extra.cache.txSignersList) {\n              _context4.next = 6;\n              break;\n            }\n\n            _context4.next = 4;\n            return resolve.txSigners(extra, transaction);\n\n          case 4:\n            txSigners = _context4.sent;\n            extra.cache.txSignersList = signersTableToSignersList(txSigners);\n\n          case 6:\n            return _context4.abrupt(\"return\", extra.cache.txSignersList);\n\n          case 7:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n\n  return function (_x16, _x17) {\n    return _ref4.apply(this, arguments);\n  };\n}();\n\nfunction signersTableToSignersList(signersTable) {\n  var array = [];\n\n  for (var accountId in signersTable) {\n    signersTable[accountId].forEach(function (signer) {\n      if (!array.find(function (key) {\n        return key === signer.key;\n      })) array.push(signer.key);\n    });\n  }\n\n  return array;\n}\n/**\n * Add an extra field to **object** that embed cache and local configuration.\n *\n * @private\n */\n\n\nresolve.extra = function (conf, object) {\n  if (!object._cosmicplus) {\n    misc.setHiddenProperty(object, \"_cosmicplus\", {});\n    if (conf.cache) object._cosmicplus.cache = conf.cache;else object._cosmicplus.cache = {\n      destination: {},\n      account: {}\n    };\n    object._cosmicplus.network = conf.network;\n    object._cosmicplus.current = conf.current;\n  }\n\n  return object._cosmicplus;\n};","\"use strict\";\n\nrequire(\"core-js/modules/es.array.concat\");\n\nrequire(\"core-js/modules/es.object.assign\");\n\nrequire(\"core-js/modules/es.object.create\");\n\nvar _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\n\nvar _possibleConstructorReturn = require(\"@babel/runtime/helpers/possibleConstructorReturn\");\n\nvar _getPrototypeOf = require(\"@babel/runtime/helpers/getPrototypeOf\");\n\nvar _inherits = require(\"@babel/runtime/helpers/inherits\");\n\nvar env = require(\"@cosmic-plus/jsutils/es5/env\");\n\nvar misc = require(\"@cosmic-plus/jsutils/es5/misc\");\n/**\n * Automatically pass `config` to `module` functions as first argument.\n *\n * @param {Object} module A cosmic-lib module whose functions takes config as\n *   the first argument.\n * @param {Object} config A configuration object similar than config.js module.\n * @private\n */\n\n\nfunction exposeModule(module) {\n  var config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var layer = Object.assign({}, module);\n  misc.setHiddenProperty(layer, \"_config\", config);\n\n  var _loop = function _loop(name) {\n    if (typeof module[name] === \"function\") {\n      layer[name] = function () {\n        for (var _len = arguments.length, params = new Array(_len), _key = 0; _key < _len; _key++) {\n          params[_key] = arguments[_key];\n        }\n\n        return module[name].apply(module, [this._config].concat(params));\n      };\n    } else {\n      layer[name] = module[name];\n    }\n  };\n\n  for (var name in module) {\n    _loop(name);\n  }\n\n  return layer;\n}\n/**\n * Create a clone of the library with an alternative config object derived from\n * **params**. Fields which are not defined in **params** stay in sync with parent\n * configuration.\n *\n * @example\n * const testnet = cosmicLib.withConfig({ network: 'test' })\n * const account = await testnet.resolve.account('tips*cosmic.link')\n *\n * @params {Object} params Alternative configuration\n * @return {Object} A clone of cosmicLib\n */\n\n\nexports.withConfig = function (params) {\n  var library = Object.create(this);\n  library.config = Object.assign({}, this.config, params);\n\n  for (var module in this) {\n    if (this[module].prototype && this[module].prototype.__proto__ === this.config) {\n      library[module] =\n      /*#__PURE__*/\n      function (_this$module) {\n        _inherits(_class, _this$module);\n\n        function _class() {\n          _classCallCheck(this, _class);\n\n          return _possibleConstructorReturn(this, _getPrototypeOf(_class).apply(this, arguments));\n        }\n\n        return _class;\n      }(this[module]);\n\n      Object.assign(library[module].prototype, this[module].prototype);\n      library[module].prototype.__proto__ = library.config;\n    } else if (this[module]._config) {\n      library[module] = Object.create(this[module]);\n      misc.setHiddenProperty(library[module], \"_config\", library.config);\n    }\n  }\n\n  return library;\n};\n/**\n * Export modules **names** after linking them to `config`.\n *\n * @param  {...String} names Module names\n */\n\n\nfunction exportModule(name, module) {\n  exports[name] = exposeModule(module, config);\n} // Export modules.\n\n\nvar config = exports.config = require(\"./config\");\n\nexports.CosmicLink = require(\"./cosmiclink\");\nif (env.isBrowser) exports.load = require(\"./load\");\nexportModule(\"resolve\", require(\"./resolve\"));\nexportModule(\"signersUtils\", require(\"./signers-utils\"));\nexports.specs = require(\"./specs\"); // sep7Utils\n\nvar _require = require(\"./sep7-utils\"),\n    isWebHandlerSupported = _require.isWebHandlerSupported,\n    registerWebHandler = _require.registerWebHandler;\n\nexports.sep7Utils = {\n  isWebHandlerSupported: isWebHandlerSupported,\n  registerWebHandler: registerWebHandler\n}; // Export helpers (not documented in the manual - please check the code).\n\nexportModule(\"check\", require(\"./check\"));\nexportModule(\"expand\", require(\"./expand\"));\nexportModule(\"construct\", require(\"./construct\"));\nexportModule(\"destruct\", require(\"./destruct\"));\nexportModule(\"encode\", require(\"./encode\"));\nexportModule(\"decode\", require(\"./decode\"));","\"use strict\";\n/**\n * Contains the methods to update cosmic link status and HTML status node.\n * Thoses methods won't have effect unless status reporting is enabled on `conf`\n * object by using `status.init` (wich is done automatically on CosmicLink\n * objects).\n *\n * @private\n * @exports status\n */\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nvar status = exports;\n\nvar env = require(\"@cosmic-plus/jsutils/es5/env\");\n\nvar html = env.isBrowser && require(\"@cosmic-plus/domutils/es5/html\");\n/**\n * Initialize `conf.status` & `conf.errors`.\n */\n\n\nstatus.init = function (conf) {\n  conf.status = null;\n  conf.errors = false;\n};\n/**\n * Set `conf` status as `status` and update statusNode. Error status should be\n * recorded using the `status.fail` function bellow. Once a status is set it\n * won't be mutated.\n *\n * @param {string} status\n */\n\n\nstatus.update = function (conf, status) {\n  if (conf.status || conf.status === undefined) return; // eslint-disable-next-line no-console\n\n  console.log(\"Set status: \" + status);\n  conf.status = status;\n\n  if (conf._statusNode) {\n    var title = html.grab(\".cosmiclib_status\", conf._statusNode);\n    title.textContent = status;\n  }\n};\n/**\n * Set `conf` status as error status `status` and update statusNode. This\n * implies that the cosmic link or the underlying transaction is invalid. Then,\n * call `continuation` if any. `continuation` should be a either a function or\n * 'throw'.\n *\n * @param {string} status\n * @param {function|'throw'} [continuation]\n */\n\n\nstatus.fail = function (conf, errorStatus, continuation) {\n  status.update(conf, errorStatus);\n  if (conf._statusNode) html.addClass(conf._statusNode, \"cosmiclib_error\");\n  errorContinuation(errorStatus, continuation);\n};\n/**\n * Append `error` to `conf.errors` and to the HTML display. Then, call\n * `continuation` if any. `continuation` should be a either a function or\n * 'throw'.\n *\n * @param {string} error\n * @param {procedure|'throw'} [continuation]\n */\n\n\nstatus.error = function (conf, error, continuation) {\n  // eslint-disable-next-line no-console\n  console.log(error);\n\n  if (conf.errors !== undefined) {\n    if (!conf.errors) conf.errors = [];\n    conf.errors.push(error);\n\n    if (conf._statusNode) {\n      var errorsNode = html.grab(\".cosmiclib_errors\", conf._statusNode);\n      var lineNode = html.create(\"li\", null, error);\n      html.append(errorsNode, lineNode);\n    }\n  }\n\n  errorContinuation(error, continuation);\n};\n/**\n * Create & return an HTML element that displays `conf` status and eventual\n * errors.\n *\n * @return {htmlElement}\n */\n\n\nstatus.makeHtmlNode = function (conf) {\n  var statusNode = html.create(\"div\", \".cosmiclib_statusNode\");\n  var statusLine = html.create(\"span\", \".cosmiclib_status\");\n  html.append(statusNode, statusLine);\n  if (conf.status) statusLine.textContent = conf.status;\n  var errorsNode = html.create(\"ul\", \".cosmiclib_errors\");\n  html.append(statusNode, errorsNode);\n\n  if (conf.errors) {\n    conf.errors.forEach(function (error) {\n      var errorLine = html.create(\"li\", null, error);\n      html.append(errorsNode, errorLine);\n    });\n  }\n\n  return statusNode;\n};\n/**\n * If `continuation` is a function, call it with `error` as argument.\n * If `continuation` equal 'throw', throw a new error with `error` as message.\n * If `continuation` is undefined, do nothing.\n */\n\n\nfunction errorContinuation(error, continuation) {\n  if (continuation) {\n    if (continuation === \"throw\") throw new Error(error);else continuation(error);\n  }\n}","\"use_strict\";\n/**\n * Mirrorable arrays\n */\n\nrequire(\"core-js/modules/es.array.concat\");\n\nrequire(\"core-js/modules/es.array.filter\");\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.array.map\");\n\nrequire(\"core-js/modules/es.array.slice\");\n\nrequire(\"core-js/modules/es.array.splice\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nvar _slicedToArray = require(\"@babel/runtime/helpers/slicedToArray\");\n\nvar _toConsumableArray = require(\"@babel/runtime/helpers/toConsumableArray\");\n\nvar _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"@babel/runtime/helpers/createClass\");\n\nvar _possibleConstructorReturn = require(\"@babel/runtime/helpers/possibleConstructorReturn\");\n\nvar _getPrototypeOf = require(\"@babel/runtime/helpers/getPrototypeOf\");\n\nvar _assertThisInitialized = require(\"@babel/runtime/helpers/assertThisInitialized\");\n\nvar _inherits = require(\"@babel/runtime/helpers/inherits\");\n\nvar _wrapNativeSuper = require(\"@babel/runtime/helpers/wrapNativeSuper\");\n\nvar hiddenKey = require(\"./misc\").setHiddenProperty;\n\nvar Projectable = require(\"./projectable\");\n\nvar trapped = Projectable.trapped;\n\nvar Mirrorable = module.exports =\n/*#__PURE__*/\nfunction (_Array) {\n  \"use strict\";\n\n  _inherits(Mirrorable, _Array);\n\n  function Mirrorable() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Mirrorable);\n\n    for (var _len = arguments.length, params = new Array(_len), _key = 0; _key < _len; _key++) {\n      params[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Mirrorable)).call.apply(_getPrototypeOf2, [this].concat(params)));\n    hiddenKey(_assertThisInitialized(_this), trapped, []);\n    hiddenKey(_assertThisInitialized(_this), \"subscribers\", []);\n    initTraps(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Mirrorable, [{\n    key: \"mirror\",\n    value: function mirror(func) {\n      var _this2 = this;\n\n      var array = new Mirrorable();\n      this.subscribers.push([array, func]);\n      this.project(\"*\", array, func);\n      array.trap(\"*\");\n      array.listen(\"destroy\", function () {\n        _this2.subscribers = _this2.subscribers.filter(function (x) {\n          return x[0] !== array;\n        });\n      });\n      return array;\n    }\n  }, {\n    key: \"feed\",\n    value: function feed(object, key, func) {\n      var _this3 = this;\n\n      var compute = func ? function () {\n        return object[key] = func(_this3);\n      } : function () {\n        return object[key] = _this3;\n      };\n      this.listen(\"change\", compute);\n      compute();\n    }\n  }, {\n    key: \"splice\",\n    value: function splice(i, suppr) {\n      var _this$trapped,\n          _this4 = this;\n\n      if (this.length > this[trapped].length) initTraps(this);\n      var removed = this.slice(i, suppr);\n\n      for (var _len2 = arguments.length, objects = new Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {\n        objects[_key2 - 2] = arguments[_key2];\n      }\n\n      var ret = (_this$trapped = this[trapped]).splice.apply(_this$trapped, [i, suppr].concat(objects));\n\n      updateTraps(this);\n      propagate(this, objects, function (array, values) {\n        array.splice.apply(array, [i, suppr].concat(_toConsumableArray(values)));\n      });\n      objects.forEach(function (value) {\n        return _this4.trigger(\"add\", value);\n      });\n      removed.forEach(function (value) {\n        return _this4.trigger(\"remove\", value);\n      });\n      this.trigger(\"change\");\n      return ret;\n    }\n  }]);\n\n  return Mirrorable;\n}(_wrapNativeSuper(Array));\n\nProjectable.extend(Mirrorable);\n/**\n * Methods that must to be reflected to subscribers\n */\n\nfunction makeMethod(method, addFlag) {\n  return function () {\n    var _this$trapped2,\n        _this5 = this;\n\n    if (this.length > this[trapped].length) initTraps(this);\n\n    for (var _len3 = arguments.length, params = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      params[_key3] = arguments[_key3];\n    }\n\n    var returned = (_this$trapped2 = this[trapped])[method].apply(_this$trapped2, params);\n\n    updateTraps(this);\n    propagate(this, params, function (array, values) {\n      return array[method].apply(array, _toConsumableArray(values));\n    });\n    if (addFlag) params.forEach(function (value) {\n      return _this5.trigger(\"add\", value);\n    });else this.trigger(\"remove\", returned);\n    this.trigger(\"change\");\n    return returned;\n  };\n}\n\nvar methods1 = [\"push\", \"unshift\"];\nvar methods2 = [\"pop\", \"shift\"];\nmethods1.forEach(function (method) {\n  return Mirrorable.prototype[method] = makeMethod(method, true);\n});\nmethods2.forEach(function (method) {\n  return Mirrorable.prototype[method] = makeMethod(method);\n});\n/**\n * Helpers\n */\n\nfunction initTraps(obj) {\n  obj.forEach(function (_, key) {\n    return obj.trap(String(key), reflect, {\n      init: false\n    });\n  });\n}\n\nfunction updateTraps(obj) {\n  var diff = obj[trapped].length - obj.length;\n  if (diff < 0) removeTraps(obj);else if (diff > 0) addTraps(obj);\n}\n\nfunction addTraps(obj) {\n  for (var key = obj.length; key < obj[trapped].length; key++) {\n    obj[key] = obj[trapped][key];\n    delete obj[trapped][key];\n    obj.trap(String(key), reflect, {\n      init: false\n    });\n  }\n}\n\nfunction removeTraps(obj) {\n  for (var key = obj[trapped].length; key < obj.length; key++) {\n    obj.untrap(key);\n  }\n\n  Array.prototype.splice.call(obj, obj[trapped].length, obj.length - obj[trapped].length);\n}\n\nfunction reflect(event) {\n  var object = event.object,\n      key = event.key,\n      value = event.value;\n  object.subscribers.forEach(function (entry) {\n    var _entry = _slicedToArray(entry, 2),\n        array = _entry[0],\n        func = _entry[1];\n\n    array[key] = func ? func(value) : value;\n  });\n}\n\nfunction propagate(object, params, func1) {\n  object.subscribers.forEach(function (entry) {\n    var _entry2 = _slicedToArray(entry, 2),\n        array = _entry2[0],\n        func2 = _entry2[1];\n\n    var values = func2 && params ? params.map(func2) : params;\n    func1(array, values);\n  });\n}","\"use strict\";\n/**\n * Decode fields values from URI to cosmic link JSON format. This format differs\n * from Stellar transaction format: it is simpler, allow for federated address\n * and can be stringified/parsed without loss of information.\n *\n * For each of those functions, any error is recorded in the `conf` object\n * and HTML nodes are updated accordingly.\n *\n * @private\n * @exports decode\n */\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.array.map\");\n\nrequire(\"core-js/modules/es.date.to-iso-string\");\n\nrequire(\"core-js/modules/es.date.to-string\");\n\nrequire(\"core-js/modules/es.regexp.exec\");\n\nrequire(\"core-js/modules/es.string.match\");\n\nrequire(\"core-js/modules/es.string.replace\");\n\nrequire(\"core-js/modules/es.string.split\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nvar decode = exports;\n\nvar check = require(\"./check\");\n\nvar normalize = require(\"./normalize\");\n\nvar specs = require(\"./specs\");\n\nvar status = require(\"./status\");\n\ndecode.query = function (conf) {\n  var query = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"?\";\n  if (query.substr(0, 1) !== \"?\") status.fail(conf, \"Invalid query\", \"throw\");\n  query = query.substr(1);\n  var operations = [];\n  var tdesc = {}; // Backward compatibility with the old non-standard syntax, deprecated since\n  // 2019-08-26. This adds `type=` at the beginning of the query when the first\n  // parameter doesn't contains an `=` sign.\n\n  if (query.match(/^\\w+(&|$)/)) query = \"type=\".concat(query);\n  var parser;\n  var params = query.split(\"&\");\n\n  for (var index in params) {\n    var param = params[index].split(\"=\", 2);\n    var field = param[0];\n    if (!field) continue;\n\n    if (field === \"type\") {\n      if (parser) {\n        status.error(conf, \"Query declares 'type' several times\", \"throw\");\n      } else if (param[1] !== \"transaction\") {\n        operations[0] = {\n          type: param[1]\n        };\n      }\n\n      parser = param[1];\n      continue;\n    } else if (!parser) {\n      status.error(conf, \"Query doesn't declare 'type' in first position\", \"throw\");\n    }\n\n    if (field === \"operation\") {\n      operations.push({\n        type: param[1]\n      });\n      parser = \"operation\";\n      continue;\n    }\n\n    var value = decode.field(conf, field, param[1]); /// Multi-operation link.\n\n    if (parser === \"transaction\") {\n      tdesc[field] = value;\n    } else if (parser === \"operation\") {\n      operations[operations.length - 1][field] = value; /// One-operation link.\n    } else {\n      if (specs.isTransactionField(field)) {\n        tdesc[field] = value;\n      } else {\n        operations[0][field] = value;\n      }\n    }\n  }\n\n  tdesc.operations = operations;\n  normalize.tdesc(conf, tdesc);\n  tdesc.operations.forEach(function (odesc) {\n    return normalize.odesc(conf, odesc);\n  });\n  check.tdesc(conf, tdesc);\n  return tdesc;\n};\n/******************************************************************************/\n\n/**\n * Decode `value` accordingly to `field` type.\n *\n * @param {string} field\n * @param {string} value\n */\n\n\ndecode.field = function (conf, field, value) {\n  var type = specs.fieldType[field];\n  return type ? decode.type(conf, type, value) : value;\n};\n/**\n * Decode `value` using the decoding function for `type`.\n *\n * @param {string} type\n * @param {string} value\n */\n\n\ndecode.type = function (conf, type, value) {\n  if (value) {\n    value = decodeURIComponent(value);\n    return process[type] ? process[type](conf, value) : value;\n  } else {\n    return \"\";\n  }\n};\n/******************************************************************************/\n\n\nvar process = {};\n\nprocess.asset = function (conf, asset) {\n  var assetLower = asset.toLowerCase();\n\n  if (assetLower === \"xlm\" || assetLower === \"native\") {\n    return {\n      code: \"XLM\"\n    };\n  } else {\n    var temp = asset.split(\":\");\n    var object = {\n      code: temp[0],\n      issuer: temp[1]\n    };\n    return object;\n  }\n};\n\nprocess.assetsArray = function (conf, assetsList) {\n  var strArray = assetsList.split(\",\");\n  return strArray.map(function (entry) {\n    return decode.asset(conf, entry);\n  });\n};\n\nprocess[\"boolean\"] = function (conf, string) {\n  switch (string) {\n    case \"true\":\n      return true;\n\n    case \"false\":\n      return false;\n  }\n};\n\nprocess.buffer = function (conf, string) {\n  var matched = string.match(/(^[^:]*):/);\n  var type = matched && matched[1];\n\n  switch (type) {\n    case \"base64\":\n      return {\n        type: type,\n        value: string.substr(type.length + 1)\n      };\n\n    case \"text\":\n      string = string.substr(type.length + 1);\n    // Fallthrough\n\n    default:\n      return {\n        type: \"text\",\n        value: process.string(conf, string)\n      };\n  }\n};\n\nprocess.date = function (conf, string) {\n  /// now + {minutes} syntactic sugar\n  if (string.match(/^\\+[0-9]+$/)) return string; /// Use UTC timezone by default.\n\n  if (string.match(/T[^+]*[0-9]$/)) string += \"Z\";\n  return new Date(string).toISOString();\n};\n\nprocess.memo = function (conf, string) {\n  var matched = string.match(/(^[^:]*):/);\n  var type = matched && matched[1];\n\n  switch (type) {\n    case \"base64\":\n    case \"id\":\n    case \"hash\":\n    case \"return\":\n      return {\n        type: type,\n        value: string.substr(type.length + 1)\n      };\n\n    case \"text\":\n      string = string.substr(type.length + 1);\n    // Fallthrough\n\n    default:\n      return {\n        type: \"text\",\n        value: process.string(conf, string)\n      };\n  }\n};\n\nprocess.price = function (conf, price) {\n  var numerator = price.replace(/:.*/, \"\");\n  var denominator = price.replace(/^[^:]*:/, \"\");\n  if (numerator === denominator) return price;else return {\n    n: +numerator,\n    d: +denominator\n  };\n};\n\nprocess.signer = function (conf, signer) {\n  var temp = signer.split(\":\");\n  var object = {\n    weight: temp[0],\n    type: temp[1],\n    value: temp[2]\n  };\n  return object;\n};\n\nprocess.string = function (conf, string) {\n  return string.replace(/\\+/g, \" \");\n};\n\nprocess.network = process.string;\n/******************************************************************************/\n\n/**\n * Provide dummy aliases for every other type for convenience & backward\n * compatibility.\n */\n\nspecs.types.forEach(function (type) {\n  exports[type] = function (conf, value) {\n    return decode.type(conf, type, value);\n  };\n});","\"use_strict\";\n\nvar env = require(\"@cosmic-plus/jsutils/es5/env\");\n\nif (env.isBrowser) {\n  if (window.StellarSdk === undefined) console.error(\"Missing dependency: StellarSdk\");else module.exports = window.StellarSdk;\n} else {\n  module.exports = env.nodeRequire(\"stellar-sdk\");\n}","\"use_strict\";\n/**\n * Methods to detect in which environment we're running.\n *\n * @exports env\n */\n\nvar env = exports;\n/**\n * `true` if we are in a browser environment, `false` otherwise.\n */\n\nenv.isBrowser = typeof window !== \"undefined\" && typeof window.document !== \"undefined\";\n/**\n * `true` if we are in a node.js environment, `false` otherwise.\n */\n\nenv.isNode = typeof process !== \"undefined\" && process.versions && process.versions.node;\n/**\n * `true` if current page is embedded.\n */\n\nenv.isEmbedded = env.isBrowser && window.self !== window.top;\n/**\n * The window object, or `undefined`.\n */\n\nenv.window = env.isBrowser && window;\n/**\n * The global objet, or `undefined`.\n */\n\nenv.global = env.isNode && global;\n/**\n * A require that only have effect in Node.js and that is invisible for package\n * bundlers.\n */\n\nenv.nodeRequire = function () {};\n\nif (env.isNode) {\n  var stealth_require = eval(\"require\");\n\n  env.nodeRequire = function (module) {\n    return stealth_require(module);\n  };\n}","\"use_strict\";\n/**\n * Library-wide configuration.\n *\n * @borrows module:aliases.all as aliases\n * @borrows module:aliases.set as addAliases\n * @borrows module:aliases.remove as removeAliases\n *\n * @borrows module:event.defaultClickHandlers as clickHandlers\n * @borrows module:event.setClickHandler as setClickHandler\n * @borrows module:event.clearClickHandler as clearClickHandler\n *\n * @exports config\n */\n\nvar config = exports;\n\nvar aliases = require(\"@cosmic-plus/base/es5/aliases\");\n\nvar env = require(\"@cosmic-plus/jsutils/es5/env\");\n\nvar StellarSdk = require(\"@cosmic-plus/base/es5/stellar-sdk\");\n\nvar event = env.isBrowser && require(\"./event\");\n/**\n * The base URI to build cosmic links.\n * @default 'https://cosmic.link/'\n */\n\n\nconfig.page = \"https://cosmic.link/\";\n/**\n * The default fallback network.\n * @default 'public'\n */\n\nconfig.network = \"public\";\n/**\n * The default fallback source address.\n * @default undefined\n */\n\nconfig.source = undefined;\n/**\n * Networks setup.\n *\n * @private\n */\n\nconfig.current = {\n  passphrase: {},\n  horizon: {},\n  server: {}\n};\n/**\n * Set default **passphrase** and **horizon** URL for network **name**.\n *\n * Adding custom network this way will enable the use of their name in cosmic\n * queries (as in `&network=name`). However, please remind that this feature\n * will works only on your side and could break compatibility with other\n * services.\n *\n * @example\n * cosmicLib.config.setupNetwork('public', 'https://my-own-horizon-instance.example.org')\n * cosmicLib.config.setupNetwork('custom', 'https://custom-horizon.example.org', 'My Custom Passphrase')\n *\n * @param {string} name Network name (like 'public', 'test')\n * @param {string} horizon Horizon URL\n * @param {string} [passphrase] Network passphrase\n */\n\nconfig.setupNetwork = function (name, horizon, passphrase) {\n  if (passphrase) config.current.passphrase[name] = passphrase;else passphrase = config.current.passphrase[name];\n  config.current.horizon[passphrase] = horizon;\n};\n\nconfig.setupNetwork(\"public\", \"https://horizon.stellar.org\", StellarSdk.Networks.PUBLIC);\nconfig.setupNetwork(\"test\", \"https://horizon-testnet.stellar.org\", StellarSdk.Networks.TESTNET);\nconfig.aliases = aliases.all;\n\nconfig.addAliases = function (definitions) {\n  return aliases.set(config, definitions);\n};\n\nconfig.removeAliases = function (array) {\n  return aliases.remove(config, array);\n};\n\nconfig.clickHandlers = event.defaultClickHandlers;\n\nconfig.setClickHandler = function (fieldType, callback) {\n  return event.setClickHandler(config, fieldType, callback);\n};\n\nconfig.clearClickHandler = function (fieldType) {\n  return event.clearClickHandler(config, fieldType);\n};","\"use strict\";\n/**\n * Contains the methods to convert transactions between various formats.\n *\n * @private\n * @exports convert\n */\n\nrequire(\"core-js/modules/es.regexp.exec\");\n\nrequire(\"core-js/modules/es.string.match\");\n\nrequire(\"core-js/modules/es.string.replace\");\n\nvar convert = exports;\n\nvar StellarSdk = require(\"@cosmic-plus/base/es5/stellar-sdk\");\n\nvar construct = require(\"./construct\");\n\nvar decode = require(\"./decode\");\n\nvar destruct = require(\"./destruct\");\n\nvar encode = require(\"./encode\");\n\nvar resolve = require(\"./resolve\");\n/** ****************************    URI -> XDR    ******************************/\n\n\nconvert.uriToQuery = function (conf, uri) {\n  if (!uri.match(/\\?/)) return null;\n  var query = uri.replace(/^[^?]*/, \"\");\n  return query;\n};\n\nconvert.queryToTdesc = decode.query;\n\nconvert.tdescToJson = function (conf, tdesc) {\n  return JSON.stringify(tdesc, null, 2);\n};\n\nconvert.tdescToTransaction = construct.transaction;\n\nconvert.transactionToXdr = function (conf, transaction) {\n  return transaction.toEnvelope().toXDR(\"base64\");\n};\n\nconvert.xdrToSep7 = function (conf, xdr, options) {\n  if (conf.locker && !conf.locker.source) {\n    throw new Error(\"SEP-0007 requires a source account.\");\n  }\n\n  var sep7 = \"web+stellar:tx?xdr=\";\n  sep7 += encodeURIComponent(xdr);\n\n  if (conf.extra.pubkey) {\n    sep7 += \"&pubkey=\" + encodeURIComponent(conf.extra.pubkey);\n  }\n\n  if (conf.extra.msg) {\n    sep7 += \"&msg=\" + encodeURIComponent(conf.extra.msg);\n  }\n\n  if (options.network && options.network !== \"public\") {\n    var passphrase = resolve.networkPassphrase(conf, options.network);\n    sep7 += \"&network_passphrase=\" + encodeURIComponent(passphrase);\n  }\n\n  if (options.callback) {\n    sep7 += \"&callback=\" + encode.url(conf, \"url:\".concat(options.callback));\n  }\n\n  if (typeof conf.extra.originDomain === \"string\") {\n    sep7 += \"&origin_domain=\" + conf.extra.originDomain;\n    sep7 += \"&signature=\" + conf.extra.signature;\n  } // Not part of the standard.\n  // if (options.horizon) sep7 +=\"&horizon=\" + encode.url(conf, options.horizon)\n\n\n  return sep7;\n};\n/** ****************************    XDR -> URI    ******************************/\n\n\nconvert.xdrToTransaction = function (conf, xdr) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var networkPassphrase = resolve.networkPassphrase(conf, options.network);\n  var transaction = new StellarSdk.Transaction(xdr, networkPassphrase);\n  if (options.strip === \"signatures\") transaction.signatures = [];\n  return transaction;\n};\n\nconvert.xdrToQuery = function (conf, xdr) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var query = \"?xdr=\" + xdr;\n  if (options.network) query += \"&network=\" + encodeURIComponent(options.network);\n  if (options.horizon) query += \"&horizon=\" + encode.url(conf, options.horizon);\n  if (options.callback) query += \"&callback=\" + encode.url(conf, options.callback); // Handle with source-independent transactions.\n\n  if (conf.locker && !conf.locker.source) query += \"&strip=source\";\n  return query;\n};\n\nconvert.transactionToTdesc = destruct.transaction;\n\nconvert.jsonToTdesc = function (conf, json) {\n  return JSON.parse(json);\n};\n\nconvert.tdescToQuery = encode.query;\n\nconvert.queryToUri = function (conf, query) {\n  var page = conf.page || \"https://cosmic.link\";\n  return page + query;\n};","\"use strict\";\n/**\n * Exposes some of the check routines used by cosmic-lib. Individual type-checks\n * are also available for:\n *\n * > address, amount, asset, assetsArray, boolean, buffer, date, flags, hash,\n * id, memo, network, price, sequence, signer, string, threshold, url, weight\n *\n * All checks are meant to be used on tdesc formatted values. Form example, in\n * tdesc buffer values are not encoded as actual Buffer object but as something\n * like: `{ type: \"text\", value: \"Hello World!\"}`.\n *\n * @example\n * check.field(\"minTime\", \"2018-11\")\n * check.date(\"2018-11\")\n *\n * @private\n * @exports check\n */\n\nrequire(\"core-js/modules/es.array.concat\");\n\nrequire(\"core-js/modules/es.array.find\");\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.date.to-string\");\n\nrequire(\"core-js/modules/es.parse-int\");\n\nrequire(\"core-js/modules/es.regexp.exec\");\n\nrequire(\"core-js/modules/es.regexp.flags\");\n\nrequire(\"core-js/modules/es.string.match\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nvar check = exports;\n\nvar misc = require(\"@cosmic-plus/jsutils/es5/misc\");\n\nvar specs = require(\"./specs\");\n\nvar status = require(\"./status\");\n/**\n * Check that **tdesc** is valid.\n *\n * @example\n * check.tdesc({\n *   memo: { type: \"text\", value: \"Hello, World!\" },\n *   network: \"public\",\n *   source: \"tips*cosmic.link\",\n *   operations: [{ type: \"setOptions\", homeDomain: \"cosmic.link\" }]\n * })\n *\n * @param  {Object} tdesc\n */\n\n\ncheck.tdesc = function (conf, tdesc) {\n  var isValid = true;\n\n  for (var field in tdesc) {\n    try {\n      check.txField(conf, field, tdesc[field]);\n    } catch (error) {\n      isValid = false;\n      tdesc[field] = errDesc(error, tdesc[field]);\n    }\n  }\n\n  if (tdesc.operations.length > 100) {\n    isValid = false;\n    status.error(conf, \"Too much operations (max 100)\");\n  }\n\n  tdesc.operations.forEach(function (odesc) {\n    try {\n      check.odesc(conf, odesc);\n    } catch (e) {\n      isValid = false;\n    }\n  });\n\n  if (!isValid) {\n    var error = new Error(\"Invalid tdesc\"); // TODO: check if this is really useful\n\n    error.tdesc = tdesc;\n    throw error;\n  }\n};\n/**\n * Check that tdesc operation is valid (referred as **odesc**).\n *\n * @example\n * check.odesc({ type: \"payment\", destination: \"tips*cosmic.link\", amount: \"20\" })\n *\n * @param  {Object} odesc [description]\n */\n\n\ncheck.odesc = function (conf, odesc) {\n  var isValid = true;\n\n  try {\n    check.operationType(conf, odesc.type);\n  } catch (error) {\n    isValid = false;\n    odesc.type = errDesc(error, odesc.type);\n  }\n\n  for (var field in odesc) {\n    try {\n      check.operationField(conf, odesc.type, field, odesc[field]);\n    } catch (error) {\n      isValid = false;\n      odesc[field] = errDesc(error, odesc[field]);\n    }\n  }\n\n  specs.operationMandatoryFields[odesc.type].forEach(function (field) {\n    if (odesc[field] === undefined) {\n      isValid = false;\n      var error = new Error(\"Missing mandatory field: \" + field);\n      odesc[field] = errDesc(error);\n      status.error(conf, error.message);\n    }\n  });\n  if (!isValid) throw new Error(\"Invalid odesc\");\n};\n/**\n * Check that **field** is a valid transaction field and that its **value** is\n * valid.\n *\n * @param  {string} field\n * @param  {*} value\n */\n\n\ncheck.txField = function (conf, field, value) {\n  if (field === \"operations\") return;\n\n  if (!specs.transactionOptionalFields.find(function (name) {\n    return name === field;\n  })) {\n    status.error(conf, \"Invalid transaction field: \" + field, \"throw\");\n  }\n\n  check.field(conf, field, value);\n};\n/**\n * Check that **type** is a valid Stellar Operation type.\n *\n * @param  {String}\n */\n\n\ncheck.operationType = function (conf, type) {\n  if (!specs.operationMandatoryFields[type]) {\n    status.error(conf, \"Invalid operation: \" + type, \"throw\");\n  }\n};\n/**\n * Check that **field** is a valid **operation** field and that its **value** is\n * valid.\n *\n * @param {String} operation\n * @param {String} field\n * @param {*} value\n */\n\n\ncheck.operationField = function (conf, operation, field, value) {\n  if (field === \"type\") return;\n\n  if (!specs.isOperationField(operation, field)) {\n    status.error(conf, \"Invalid field for \".concat(operation, \": \").concat(field), \"throw\");\n  }\n\n  check.field(conf, field, value);\n};\n\nfunction errDesc(error) {\n  var value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n  return {\n    error: error,\n    value: value\n  };\n}\n/******************************************************************************/\n\n/**\n * Check that **field** **value** is a valid.\n *\n * @example\n * check.field(\"memo\", { type: \"text\", value: \"Hello, World!\" })\n *\n * @param {string} field The name of a Stellar Transaction parameter\n * @param {*} value\n */\n\n\ncheck.field = function (conf, field, value) {\n  if (value === \"\" && field !== \"homeDomain\" && field !== \"value\") {\n    status.error(conf, \"Missing value for field: \".concat(field), \"throw\");\n  }\n\n  var type = specs.fieldType[field];\n  if (!type) status.error(conf, \"Unknow field: \" + field, \"throw\");\n  if (value) check.type(conf, type, value);\n};\n/**\n * Check that **value** is of type **type**.\n *\n * @example\n * check.type(\"date\", \"2018-11-28\")\n *\n * @param {string} type\n * @param {string} value\n */\n\n\ncheck.type = function (conf, type, value) {\n  if (!specs.types.find(function (entry) {\n    return entry === type;\n  })) {\n    throw new Error(\"Invalid type: \" + type);\n  }\n\n  return check[type](conf, value);\n};\n/**\n * Generic check for numbers. Check that **value** is a number or a string\n * representing a number. **type** is for the customization of the message in\n * case of error. **min** and **max** may be provided as additional restriction\n * for `value`.\n *\n * @param {number|string} value\n * @param {string} [type = 'number']\n * @param {number|string} [min]\n * @param {number|string} [max]\n */\n\n\ncheck.number = function (conf, value) {\n  var type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"number\";\n  var min = arguments.length > 3 ? arguments[3] : undefined;\n  var max = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : \"unlimited\";\n  var num = +value;\n\n  if (isNaN(num)) {\n    status.error(conf, \"Invalid \".concat(type, \" (should be a number): \").concat(value), \"throw\");\n  } else if (min && num < min || max && num > max) {\n    status.error(conf, \"Invalid \".concat(type, \" (should be between \").concat(min, \" and \").concat(max, \" ): \").concat(value), \"throw\");\n  }\n};\n/**\n * Generic check for integers. Check that **value** is an integer or a string\n * representing an integer. **type** is for the customization of the message in\n * case of error. **min** and **max** may be provided as additional restriction for\n * **value**.\n *\n * @param {number|string} value\n * @param {string} [type = 'integer']\n * @param {number|string} [min]\n * @param {number|string} [max]\n */\n\n\ncheck.integer = function (conf, value) {\n  var type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"integer\";\n  var min = arguments.length > 3 ? arguments[3] : undefined;\n  var max = arguments.length > 4 ? arguments[4] : undefined;\n  check.number(conf, value, type, min, max);\n\n  if (parseInt(value) + \"\" !== value + \"\") {\n    status.error(conf, \"Not an integer: \".concat(value), \"throw\");\n  }\n};\n/**\n * Check that **value** is an UTF-8 string.\n *\n * *Note:* This use a weak (simplified) test that may not be accurate for small\n * strings.\n *\n * @param  {String} value\n */\n\n\ncheck.utf8 = function (conf, value) {\n  if (typeof value !== \"string\" || !misc.isUtf8(value)) {\n    status.error(conf, \"Invalid UTF8 string: \".concat(value), \"throw\");\n  }\n};\n/**\n * Check that **value** is a base64 string.\n *\n * @param  {String} value\n */\n\n\ncheck.base64 = function (conf, value) {\n  if (typeof value !== \"string\" || !misc.isBase64(value)) {\n    status.error(conf, \"Invalid base64 string: \".concat(value), \"throw\");\n  }\n};\n/******************************************************************************/\n\n\ncheck.amount = function (conf, amount) {\n  check.number(conf, amount, \"amount\");\n};\n\ncheck.address = function (conf, address) {\n  if (address.length !== 56 && !address.match(/.*\\*.*\\..*/)) {\n    status.error(conf, \"Invalid address: \" + misc.shorter(address), \"throw\");\n  }\n};\n\ncheck.asset = function (conf, asset) {\n  var code = asset.code.toLowerCase();\n\n  if (!asset.issuer && code !== \"xlm\" && code !== \"native\") {\n    status.error(conf, \"Missing issuer for asset: \" + code, \"throw\");\n  }\n};\n\ncheck.assetsArray = function (conf, assetsArray) {\n  var isValid = true;\n\n  for (var index in assetsArray) {\n    try {\n      check.asset(conf, assetsArray[index]);\n    } catch (error) {\n      console.error(error);\n      isValid = false;\n    }\n  }\n\n  if (!isValid) throw new Error(\"Invalid assets array\");\n};\n\ncheck[\"boolean\"] = function (conf, _boolean) {\n  if (typeof _boolean !== \"boolean\") {\n    status.error(conf, \"Invalid boolean: \" + _boolean, \"throw\");\n  }\n};\n\ncheck.buffer = function (conf, buffer) {\n  switch (buffer.type) {\n    case \"text\":\n      check.utf8(conf, buffer.value);\n      break;\n\n    case \"base64\":\n      check.base64(conf, buffer.value);\n      break;\n\n    default:\n      status.error(conf, \"Invalid buffer type: \" + buffer.type, \"throw\");\n  }\n};\n\ncheck.date = function (conf, date) {\n  if (isNaN(Date.parse(date))) {\n    status.error(conf, \"Invalid date: \" + date, \"throw\");\n  }\n};\n\ncheck.flags = function (conf, flags) {\n  check.integer(conf, flags, \"flags\", 0, 7);\n};\n\ncheck.hash = function (conf, hash) {\n  if (hash.length !== 64 || !hash.match(/^[0-9a-f]*$/)) {\n    status.error(conf, \"Invalid hash: \" + hash, \"throw\");\n  }\n};\n\ncheck.id = function (conf, id) {\n  if (!id.match(/^[0-9]*$/)) status.error(conf, \"Invalid id: \" + id, \"throw\");\n};\n\ncheck.memo = function (conf, memo) {\n  switch (memo.type) {\n    case \"text\":\n      check.utf8(conf, memo.value);\n      break;\n\n    case \"base64\":\n      check.base64(conf, memo.value);\n      break;\n\n    case \"hash\":\n    case \"return\":\n      check.hash(conf, memo.value);\n      break;\n\n    case \"id\":\n      check.id(conf, memo.value);\n      break;\n\n    default:\n      status.error(conf, \"Invalid memo type: \" + memo.type, \"throw\");\n  }\n};\n\ncheck.price = function (conf, price) {\n  if (_typeof(price) === \"object\") {\n    try {\n      check.price(null, price.n);\n      check.price(null, price.d);\n    } catch (error) {\n      status.error(conf, \"Invalid price: \" + price, \"throw\");\n    }\n  } else {\n    check.number(conf, price, \"price\", 0);\n  }\n};\n\ncheck.signer = function (conf, signer) {\n  check.weight(conf, signer.weight);\n\n  switch (signer.type) {\n    case \"key\":\n      check.address(conf, signer.value);\n      break;\n\n    case \"hash\":\n    case \"tx\":\n      check.hash(conf, signer.value);\n      break;\n\n    default:\n      status.error(conf, \"Invalid signer type: \" + signer.type, \"throw\");\n  }\n};\n\ncheck.sequence = function (conf, sequence) {\n  check.number(conf, sequence, \"sequence\", 0);\n};\n\ncheck.threshold = function (conf, threshold) {\n  check.integer(conf, threshold, \"threshold\", 0, 255);\n};\n\ncheck.weight = function (conf, weight) {\n  check.integer(conf, weight, \"weight\", 0, 255);\n};\n/******************************************************************************/\n\n/**\n * Provide dummy aliases for every other type for convenience & backward\n * compatibility.\n */\n\n\nspecs.types.forEach(function (type) {\n  if (!exports[type]) exports[type] = function (conf, value) {\n    return value;\n  };\n});","\"use strict\"\n/**\n * Balance\n */\nconst Mirrorable = require(\"@cosmic-plus/jsutils/es5/mirrorable\")\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\n\nconst Anchor = require(\"./anchor\")\nconst Asset = require(\"./asset\")\nconst Orderbook = require(\"./orderbook\")\n\nconst global = require(\"./global\")\nconst { fixed7, positive, negative, arrayRemove } = require(\"../helpers/misc\")\n\n/**\n * Definition\n */\nclass Balance extends Projectable {\n  static resolve (code, issuer) {\n    const id = Balance.makeId(code, issuer)\n    return Balance.table[id] || new Balance({ code, issuer })\n  }\n\n  static ingest (record) {\n    const params = Balance.recordToParams(record)\n    const balance = Balance.resolve(params.code, params.issuer)\n    balance.update(params)\n    balance.hasTrustline = true\n    return balance\n  }\n\n  constructor (params) {\n    const { code, issuer } = params\n\n    super()\n\n    // Identification\n    this.code = code\n    this.anchor = Anchor.resolve(issuer || \"stellar.org\")\n    this.id = Balance.makeId(code, issuer)\n    Balance.table[this.id] = this\n\n    // Link with an asset object.\n    if (this.code in this.anchor.assets) {\n      this.asset = this.anchor.assets[this.code]\n      this.known = true\n    } else {\n      this.asset = Asset.resolve(this.id)\n      this.known = false\n    }\n\n    // Set updatable properties.\n    this.update(params)\n    this.offers = new Mirrorable()\n  }\n\n  update (params) {\n    const { amount, buying, selling } = params\n    this.amount = amount || 0\n    this.buying = buying || 0\n    this.selling = selling || 0\n  }\n\n  streamPrice () {\n    if (this.orderbook) return\n\n    if (this.id === \"XLM\") {\n      this.asset.project(\"price\", this)\n    } else {\n      this.orderbook = Orderbook.forBalance(this, Asset.resolve(\"XLM\"))\n      this.orderbook.project(\"price\", this)\n      this.asset.orderbook.addChild(this.orderbook)\n    }\n  }\n}\n\nBalance.table = {}\n\nBalance.trap(\"hasTrustline\", () => {\n  if (this.hasTrustline) {\n    arrayRemove(this.asset.target.opening, this.anchor.pubkey)\n  }\n})\n\nBalance.define(\"isActive\", [\"action\", \"hasTrustline\"], function () {\n  if (this.hasTrustline) return this.action !== \"closing\"\n  else return this.action === \"opening\"\n})\n\nBalance.define(\"value\", [\"amount\", \"price\"], function () {\n  return this.amount === 0 ? 0 : this.amount * this.price\n})\n\n// targetAmount is set by \"./order.js\"\nBalance.define(\"targetMin\", [\"targetAmount\"], function () {\n  return fixed7(this.targetAmount * (1 - global.balanceTargetDeviation))\n})\nBalance.define(\"targetMax\", [\"targetAmount\"], function () {\n  return fixed7(this.targetAmount * (1 + global.balanceTargetDeviation))\n})\nBalance.define(\"targetMinDiff\", [\"amount\", \"targetMin\"], function () {\n  return fixed7(this.targetMin - this.amount)\n})\nBalance.define(\"targetMaxDiff\", [\"amount\", \"targetMax\"], function () {\n  return fixed7(this.targetMax - this.amount)\n})\nBalance.define(\"sizeMin\", [\"targetMinDiff\"], function () {\n  return negative(this.targetMinDiff)\n})\nBalance.define(\"sizeMax\", [\"targetMaxDiff\"], function () {\n  return positive(this.targetMaxDiff)\n})\nBalance.define(\"underMin\", [\"targetMinDiff\"], function () {\n  return negative(-this.targetMinDiff)\n})\nBalance.define(\"overMax\", [\"targetMaxDiff\"], function () {\n  return positive(-this.targetMaxDiff)\n})\n\n/**\n * Utilities\n */\n\nBalance.makeId = function (code, issuer) {\n  if (issuer) return `${code}:${issuer}`\n  else if (code === \"XLM\") return \"XLM\"\n  else throw new Error(`Missing issuer for ${code}.`)\n}\n\n/**\n * API-Specific Format: Record\n **/\n\nBalance.fromRecord = function (record) {\n  const params = Balance.recordToParams(record)\n  return new Balance(params)\n}\n\nBalance.recordToParams = function (record) {\n  const params = Object.create(record)\n  params.code = record.asset_type === \"native\" ? \"XLM\" : record.asset_code\n  params.issuer = record.asset_issuer\n  params.amount = +record.balance\n  params.buying = +record.buying_liabilities\n  params.selling = +record.selling_liabilities\n  return params\n}\n\n/**\n * Export\n */\nmodule.exports = Balance\n","\"use strict\";\n/**\n * Contains methods to format a `transaction descriptor` into CSS/HTML for\n * display in browser.\n *\n * @private\n * @exports format\n */\n\nrequire(\"core-js/modules/es.array.concat\");\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.date.to-string\");\n\nrequire(\"core-js/modules/es.function.name\");\n\nrequire(\"core-js/modules/es.number.constructor\");\n\nrequire(\"core-js/modules/es.object.keys\");\n\nrequire(\"core-js/modules/es.object.to-string\");\n\nrequire(\"core-js/modules/es.regexp.exec\");\n\nrequire(\"core-js/modules/es.regexp.to-string\");\n\nrequire(\"core-js/modules/es.string.replace\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nvar _regeneratorRuntime = require(\"@babel/runtime/regenerator\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator = require(\"@babel/runtime/helpers/asyncToGenerator\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nvar format = exports;\n\nvar misc = require(\"@cosmic-plus/jsutils/es5/misc\");\n\nvar nice = require(\"@cosmic-plus/jsutils/es5/nice\");\n\nvar html = require(\"@cosmic-plus/domutils/es5/html\");\n\nvar StellarSdk = require(\"@cosmic-plus/base/es5/stellar-sdk\");\n\nvar config = require(\"./config\");\n\nvar event = require(\"./event\");\n\nvar resolve = require(\"./resolve\");\n\nvar signersUtils = require(\"./signers-utils\");\n\nvar specs = require(\"./specs\");\n/**\n * Returns an HTML div describing `tdesc`.\n *\n * @param {Object} tdesc Transaction descriptor.\n * @return {HTMLElement} Transaction HTML description.\n */\n\n\nformat.tdesc = function (conf, tdesc) {\n  var trNode = html.create(\"div\", \".cosmiclib_transactionNode\");\n  if (!tdesc) return trNode; // SEP-0007 verified domain.\n\n  if (conf.extra.originDomain) {\n    var domainNode = html.create(\"div\");\n    html.append(trNode, domainNode);\n    conf.verifySep7().then(function () {\n      html.append(domainNode, \"Request from: \".concat(conf.extra.originDomain));\n      domainNode.className = \"cosmicLib_signed\";\n    });\n  }\n\n  var infoNode;\n\n  for (var index in specs.transactionOptionalFields) {\n    var entry = specs.transactionOptionalFields[index];\n    if (entry === \"horizon\" && resolve.horizon(config, conf.network)) continue;\n\n    if (tdesc[entry]) {\n      if (!infoNode) infoNode = html.create(\"ul\", \".cosmiclib_sideInfo\");\n      var lineNode = html.create(\"li\", {}, specs.fieldDesc[entry] + \": \", format.field(conf, entry, tdesc[entry]));\n      html.append(infoNode, lineNode);\n    }\n  }\n\n  if (infoNode) html.append(trNode, infoNode);\n\n  try {\n    for (var _index in tdesc.operations) {\n      var operation = tdesc.operations[_index];\n      var opNode = format.odesc(conf, operation);\n      opNode.index = _index;\n      html.append(trNode, opNode);\n    }\n  } catch (error) {\n    console.error(error);\n  }\n\n  if (!tdesc.operations.length) {\n    if (Object.keys(tdesc).length === 1) {\n      html.append(trNode, html.create(\"div\", null, \"No transaction\"));\n    } else {\n      html.append(trNode, html.create(\"div\", \".cosmiclib_operation\", \"No operation\"));\n    }\n  }\n\n  trNode.tdesc = tdesc;\n  return trNode;\n};\n/**\n * Returns an HTML div describing `odesc`.\n *\n * @param {Object} odesc Operation in cosmic link JSON format.\n * @return {HTMLElement} Operation HTML description.\n */\n\n\nformat.odesc = function (conf, odesc) {\n  var opNode = html.create(\"div\", \".cosmiclib_operation\");\n  opNode.odesc = odesc;\n  var retNode = opNode;\n\n  if (odesc.source) {\n    retNode = html.create(\"div\", \".cosmiclib_sourcedOperation\");\n    var sourceNode = html.create(\"div\", \".cosmiclib_sideInfo\", \"Source: \");\n    var addressNode = format.address(conf, odesc.source);\n    html.append(sourceNode, addressNode);\n    html.append(retNode, sourceNode, opNode);\n  }\n\n  var meaning = operationMeaning(odesc);\n\n  while (meaning) {\n    if (meaning.substr(0, 1) === \"{\") {\n      var query = meaning.substr(1).replace(/}.*/, \"\");\n      meaning = meaning.replace(/^[^}]*}/, \"\");\n\n      if (query === \"newline\") {\n        if (meaning === \"\") break;\n        html.append(opNode, html.create(\"br\"));\n      } else {\n        var fieldNode = format.field(conf, query, odesc[query]);\n        html.append(opNode, fieldNode);\n      }\n    } else {\n      var txt = meaning.replace(/{.*/, \"\");\n      meaning = meaning.replace(/^[^{]*/, \"\");\n      html.append(opNode, txt);\n    }\n  }\n\n  return retNode;\n};\n/**\n * Returns a string describing `odesc`.\n *\n * @private\n */\n\n\nfunction operationMeaning(odesc) {\n  var msg = \"\";\n\n  switch (odesc.type) {\n    case \"accountMerge\":\n      return \"Merge account inside {destination}\";\n\n    case \"allowTrust\":\n      if (odesc.authorize) {\n        return \"Allow usage of your asset {assetCode} to {trustor}\";\n      } else {\n        return \"Deny usage of your asset {assetCode} to {trustor}\";\n      }\n\n    case \"bumpSequence\":\n      return \"Set account sequence number to {bumpTo}\";\n\n    case \"changeTrust\":\n      if (odesc.limit === \"0\") {\n        return \"Refuse asset {asset}\";\n      } else if (odesc.limit) {\n        return \"Set holding limit as {limit} for asset {asset}\";\n      } else {\n        return \"Accept asset {asset}\";\n      }\n\n    case \"createAccount\":\n      return \"Create account {destination} and send {startingBalance} XLM to it\";\n\n    case \"createPassiveOffer\":\n    case \"createPassiveSellOffer\":\n      return \"Offer to passively sell {amount}{selling} at {price}{buying} / unit\";\n\n    case \"inflation\":\n      return \"Run inflation\";\n\n    case \"manageData\":\n      if (odesc.value) {\n        if (odesc.value.type === \"text\") {\n          return \"Set data entry '{name}' to: '{value}'\";\n        } else {\n          return \"Set data entry '{name}' to base64: '{value}'\";\n        }\n      } else {\n        return \"Delete data entry '{name}'\";\n      }\n\n    case \"manageOffer\":\n    case \"manageBuyOffer\":\n    case \"manageSellOffer\":\n      if (odesc.amount === \"0\" || odesc.buyAmount === \"0\") {\n        return \"Delete offer '{offerId}'\";\n      } else {\n        if (odesc.offerId) {\n          msg += \"Change offer '{offerId}' into:{newline}\";\n        }\n\n        if (odesc.type === \"manageBuyOffer\") {\n          msg += \"Offer to buy {buyAmount}{buying} at {price}{selling} / unit\";\n        } else {\n          msg += \"Offer to sell {amount}{selling} at {price}{buying} / unit\";\n        }\n\n        return msg;\n      }\n\n    case \"pathPayment\":\n      msg = \"Send {destAmount}{destAsset} to {destination} for a maximum \" + \"of {sendMax}{sendAsset}\";\n      if (odesc.path) msg += \" using conversion path: {path}\";\n      return msg;\n\n    case \"payment\":\n      return \"Send {amount}{asset} to {destination}\";\n\n    case \"setOptions\":\n      if (odesc.inflationDest) {\n        msg += \"Set inflation destination to: {inflationDest}{newline}\";\n      }\n\n      if (odesc.clearFlags) msg += \"Clear flag(s): {clearFlags}{newline}\";\n      if (odesc.setFlags) msg += \"Set flag(s): {setFlags}{newline}\";\n\n      if (odesc.masterWeight) {\n        if (odesc.masterWeight === \"0\") {\n          msg += \"Delete master key{newline}\";\n        } else {\n          msg += \"Set master key weight at: {masterWeight}{newline}\";\n        }\n      }\n\n      [\"lowThreshold\", \"medThreshold\", \"highThreshold\"].forEach(function (field) {\n        if (odesc[field]) msg += \"Set \" + field + \" at: {\" + field + \"}{newline}\";\n      });\n\n      if (odesc.signer) {\n        if (odesc.signer.type === \"tx\") {\n          if (odesc.signer.weight === \"0\") msg += \"Remove pre-signed {signer}{newline}\";else msg += \"Pre-sign {signer}{newline}\";\n        } else {\n          if (odesc.signer.weight === \"0\") msg += \"Remove signer: {signer}{newline}\";else msg += \"Set signer: {signer}{newline}\";\n        }\n      }\n\n      if (odesc.homeDomain) msg += \"Set home domain: {homeDomain}{newline}\";\n      if (odesc.homeDomain === \"\") msg += \"Unset home domain\";\n      if (!msg) msg = \"Do nothing\";\n      return msg;\n\n    default:\n      throw new Error(\"Unknow operation: \" + odesc.type);\n  }\n}\n/**\n * Returns an HTML div describing `signers`.\n *\n * @param {Object} signers Signers object as returned by @see{resolve.signers}.\n * @return {HTMLElement} Signers HTML description\n */\n\n\nformat.signatures = function (conf, transaction) {\n  var signersNode = html.create(\"div\", \".cosmiclib_signersNode\");\n  signersUtils[\"for\"](conf, transaction).then(function (utils) {\n    if (utils.signersList.length < 2 && !utils.signatures.length) return;\n    utils.sources.forEach(function (accountId) {\n      if (accountId !== specs.neutralAccountId) {\n        var div = makeAccountSignersNode(conf, utils, accountId);\n        html.append(signersNode, div);\n      }\n    });\n  });\n  return signersNode;\n};\n\nfunction makeAccountSignersNode(conf, utils, accountId) {\n  var accountSignersNode = html.create(\"div\");\n  var title = \"Signers for \" + misc.shorter(accountId);\n  var titleNode = html.create(\"span\", \".cosmiclib_threshold\", title);\n  var listNode = html.create(\"ul\", \".cosmiclib_signers\");\n  html.append(accountSignersNode, titleNode, listNode);\n  utils.signers[accountId].forEach(function (signer) {\n    var signerNode = format.signer(conf, signer);\n    var lineNode = html.create(\"li\", null, signerNode);\n\n    if (utils.hasSigned(signer.key)) {\n      html.addClass(lineNode, \"cosmiclib_signed\");\n      listNode.insertBefore(lineNode, listNode.firstChild);\n    } else {\n      html.append(listNode, lineNode);\n    }\n  });\n  return accountSignersNode;\n}\n/**\n * Retrieves the parent odesc (*Operation Descriptor*) of an HTML element, or\n * returns `undefined` if **element** is not the child of an HTML formatted\n * operation.\n *\n * @param {HTMLElement} element\n * @return {Object} odesc\n */\n\n\nformat.parentOdesc = function (conf, element) {\n  return parentProperty(element, \"odesc\");\n};\n/**\n * Retrieves the parent operation index of an HTML element, or returns\n * `undefined` if **element** is not the child of an HTML formatted operation.\n *\n * @param {HTMLElement} element\n * @return {Number} operation index\n */\n\n\nformat.parentIndex = function (conf, element) {\n  return parentProperty(element, \"index\");\n};\n/**\n * Retrieves the parent tdesc of an HTML element, or returns `undefined`\n * if **element** is not the child of an HTML formatted transaction.\n *\n * @param {HTMLElement} element\n * @return {Object} tdesc\n */\n\n\nformat.parentTdesc = function (conf, element) {\n  return parentProperty(element, \"tdesc\");\n};\n\nfunction parentProperty(element, property) {\n  while (element.parentNode) {\n    if (element.parentNode[property]) return element.parentNode[property];else element = element.parentNode;\n  }\n}\n/******************************************************************************/\n\n/**\n * Returns an HTML div describing `field` `value`.\n *\n * @param {string} field The field name of `value` as defined in `spec.js`.\n * @param {*} value The value of `field`.\n * @return {HTLMElement} `field` `value` HTML description\n */\n\n\nformat.field = function (conf, field, value) {\n  var type = specs.fieldType[field];\n  if (!type) throw new Error(\"Unknow field: \" + field);\n  var domNode = format.type(conf, type, value);\n  domNode.field = field;\n  if (field !== type) html.addClass(domNode, \"cosmiclib_\" + field);\n  return domNode;\n};\n\nformat.type = function (conf, type, value) {\n  if (_typeof(value) === \"object\" && value.error) type = \"error\";\n  var formatter = process[type] || process.string;\n  var domNode = formatter(conf, value);\n  html.addClass(domNode, \"cosmiclib_\" + type);\n  var eventObject = {\n    conf: conf,\n    type: type,\n    value: value,\n    domNode: domNode\n  };\n  if (conf.constructor.name === \"CosmicLink\") eventObject.cosmicLink = conf;\n\n  if (event.defaultClickHandlers[type]) {\n    domNode.onclick = function () {\n      return event.callClickHandler(conf, type, eventObject);\n    };\n\n    html.addClass(domNode, \"cosmiclib_clickable\");\n  }\n\n  return domNode;\n}; /// Provide a format method for each data type.\n\n\nspecs.types.forEach(function (type) {\n  format[type] = function (conf, value) {\n    return format.type(conf, type, value);\n  };\n});\n/******************************************************************************/\n\nvar process = {};\n\nprocess.string = function (conf, string) {\n  if (typeof string !== \"string\") string = string + \"\";\n  return html.create(\"span\", null, string);\n};\n\nprocess.error = function (conf, errDesc) {\n  var errorNode = html.create(\"span\", \".cosmiclib_error\");\n  errorNode.textContent = errDesc.value === \"\" ? \"(undefined)\" : errDesc.value.value || errDesc.value;\n  errorNode.title = errDesc.error.message;\n  return errorNode;\n};\n\nprocess.address = function (conf, address) {\n  var addressNode = html.create(\"span\", {\n    title: \"Resolving...\"\n  }, misc.shorter(address), html.create(\"span\", \".cosmiclib_loadingAnim\"));\n  resolveAddressAndUpdate(conf, address, addressNode);\n  return addressNode;\n};\n\nfunction resolveAddressAndUpdate(_x, _x2, _x3) {\n  return _resolveAddressAndUpdate.apply(this, arguments);\n}\n\nfunction _resolveAddressAndUpdate() {\n  _resolveAddressAndUpdate = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(conf, address, addressNode) {\n    var account, animation;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return resolve.address(conf, address);\n\n          case 3:\n            account = _context.sent;\n            addressNode.title = account.account_id;\n\n            if (account.memo) {\n              addressNode.title += \"\\nMemo (\".concat(account.memo_type, \"): \").concat(account.memo);\n            }\n\n            if (account.address) addressNode.textContent = account.address;else if (account.alias) addressNode.textContent = account.alias;\n            addressNode.extra = account;\n            _context.next = 14;\n            break;\n\n          case 10:\n            _context.prev = 10;\n            _context.t0 = _context[\"catch\"](0);\n            addressNode.title = \"Can't resolve address\";\n            html.addClass(addressNode, \"cosmiclib_error\");\n\n          case 14:\n            animation = html.grab(\".cosmiclib_loadingAnim\", addressNode);\n            if (animation) html.destroy(animation);\n\n          case 16:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[0, 10]]);\n  }));\n  return _resolveAddressAndUpdate.apply(this, arguments);\n}\n\nprocess.amount = function (conf, amount) {\n  var significant = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 3;\n  var max = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 7;\n  // Hide non-significant numbers\n  if (typeof amount !== \"number\") amount = Number(amount);\n  var nicified = nice(amount, {\n    significant: significant,\n    max: max\n  });\n\n  if (String(amount).length <= nicified.length) {\n    return html.create(\"span\", null, nicified);\n  } else {\n    return html.create(\"span\", {\n      className: \"cosmiclib_clickable\",\n      title: amount\n    }, html.create(\"span\", \".cosmiclib_tilde\", \"~\"), nicified);\n  }\n};\n\nprocess.asset = function (conf, asset) {\n  var assetNode = html.create(\"span\", null, format.field(conf, \"assetCode\", asset.code));\n\n  if (asset.issuer) {\n    html.append(assetNode, \" (\", format.field(conf, \"assetIssuer\", asset.issuer), \")\");\n  }\n\n  return assetNode;\n};\n\nprocess.assetsArray = function (conf, assetsArray) {\n  var assetsArrayNode = html.create(\"span\");\n\n  for (var i = 0; i < assetsArray.length; i++) {\n    if (i !== 0) html.append(assetsArrayNode, \", \");\n    html.append(assetsArrayNode, format.asset(conf, assetsArray[i]));\n  }\n\n  return assetsArrayNode;\n};\n\nprocess.buffer = function (conf, object) {\n  if (object.type === \"base64\") return format.hash(conf, object.value);else return format.string(conf, object.value);\n};\n\nprocess.date = function (conf, date) {\n  return html.create(\"span\", {}, new Date(date).toLocaleString());\n};\n\nprocess.hash = function (conf, hash) {\n  return html.create(\"span\", {\n    title: hash\n  }, misc.shorter(hash));\n};\n\nprocess.id = process.hash;\n\nprocess.flags = function (conf, flags) {\n  var string = \"\";\n\n  if (flags >= 4) {\n    string = \"immutable\";\n    flags = flags - 4;\n  }\n\n  if (flags >= 2) {\n    if (string) string = \", \" + string;\n    string = \"revocable\" + string;\n    flags = flags - 2;\n  }\n\n  if (+flags === 1) {\n    if (string) string = \", \" + string;\n    string = \"required\" + string;\n  }\n\n  return html.create(\"span\", {}, string);\n};\n\nprocess.memo = function (conf, memo) {\n  var typeNode = format.field(conf, \"memoType\", memo.type);\n  var valueNode;\n\n  switch (memo.type) {\n    case \"text\":\n      valueNode = format.field(conf, \"memoText\", memo.value);\n      break;\n\n    case \"base64\":\n      valueNode = format.field(conf, \"memoBinary\", memo.value);\n      break;\n\n    case \"id\":\n      valueNode = format.field(conf, \"memoId\", memo.value);\n      break;\n\n    case \"hash\":\n      valueNode = format.field(conf, \"memoHash\", memo.value);\n      break;\n\n    case \"return\":\n      valueNode = format.field(conf, \"memoReturn\", memo.value);\n  }\n\n  return html.create(\"span\", {}, valueNode, \" (\", typeNode, \")\");\n};\n\nprocess.price = function (conf, price) {\n  if (typeof price === \"string\") return process.amount(conf, price, 3, null);else return process.amount(conf, price.n / price.d, 3, null);\n};\n\nprocess.signer = function (conf, signer) {\n  var signerNode = html.create(\"span\");\n\n  switch (signer.type) {\n    case \"key\":\n    case \"ed25519_public_key\":\n      {\n        var value1 = signer.value || signer.key;\n        html.append(signerNode, \"Account \", format.field(conf, \"signerKey\", value1));\n        break;\n      }\n\n    case \"tx\":\n      {\n        var value2 = signer.value || signer.key;\n        html.append(signerNode, \"transaction \", format.field(conf, \"signerTx\", value2));\n        break;\n      }\n\n    case \"hash\":\n    case \"sha256hash\":\n      {\n        var value3 = signer.value || StellarSdk.StrKey.decodeSha256Hash(signer.key).toString(\"hex\");\n        html.append(signerNode, \"key whose hash is \", format.field(conf, \"signerHash\", value3));\n        break;\n      }\n  }\n\n  if (signer.weight > 1) {\n    var weightNode = format.weight(conf, signer.weight);\n    html.append(signerNode, \" (weight: \", weightNode, \")\");\n  }\n\n  return signerNode;\n};","\"use_strict\";\n/**\n * This module provides two ways to generate {@link SignersUtils} for a\n * Transaction object. The first one extends the object and is the intended way\n * to use those utilities. However, as extending objects can sometimes prove\n * inconvenient or intrusive, a second method allows to create a stand-alone\n * {@link SignersUtils} tied to a given transaction.\n *\n * @exports signersUtils\n */\n\nrequire(\"core-js/modules/es.array.find\");\n\nrequire(\"core-js/modules/es.object.assign\");\n\nvar _regeneratorRuntime = require(\"@babel/runtime/regenerator\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator = require(\"@babel/runtime/helpers/asyncToGenerator\");\n\nvar _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"@babel/runtime/helpers/createClass\");\n\nvar signersUtils = exports;\n\nvar misc = require(\"@cosmic-plus/jsutils/es5/misc\");\n\nvar StellarSdk = require(\"@cosmic-plus/base/es5/stellar-sdk\");\n\nvar _resolve = require(\"./resolve\");\n/**\n * **SignersUtils** is a toolbox that aims to ease the handling of\n * multisignature transactions. The idea behind it is to fetch all required\n * data once and to cache the responses into the transaction. Then, all\n * the utilities can function in a synchronous (immediate) manner.\n *\n * Those are automatically available in `cosmicLink.transaction` after\n * `await cosmicLink.lock()` is ran. Alternatively, you can extend a transaction\n * or generate its SignersUtils by using {@link module:signersUtils}. There's no\n * `cosmicLib.SignersUtils` constructor.\n *\n * An instance of SignersUtils is always tied to a given transaction. This is\n * why none of the provided methods take a transaction as parameter.\n *\n * >\n * | Members                                                                     | Methods\n * |-----------------------------------------------------------------------------|-------------\n * | [sources]{@link SignersUtils#sources}: Array of transaction sources         | [hasSigner]{@link SignersUtils#hasSigner}: Test if a key is a legit signer for transaction\n * | [signers]{@link SignersUtils#signers}: Table of transaction signers         | [hasSigned]{@link SignersUtils#hasSigned}: Test if a key has signed transaction\n * | [signersList]{@link SignersUtils#signersList}: Array of transaction signers |\n *\n * @example\n * const cosmicLink = new CosmicLink({ memo: 'Donation', maxDate: 2019 })\n *  .addOperation('payment', { destination: 'tips*cosmic.link', amount: 10 })\n *\n * await cosmicLink.lock({ network: 'test', source: 'myaddress*example.org' })\n *\n * console.log(cosmicLink.transaction.signers)\n * console.log(cosmicLink.transaction.hasSigner(GB...DXEZ))\n *\n * @alias SignersUtils\n * @namespace\n */\n\n\nvar SignersUtils =\n/*#__PURE__*/\nfunction () {\n  \"use strict\";\n\n  _createClass(SignersUtils, null, [{\n    key: \"resolve\",\n    value: function () {\n      var _resolve2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(conf, transaction, extendFlag) {\n        var extra, utils;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                extra = _resolve.extra(conf, transaction);\n\n                if (extra.cache.signersUtils) {\n                  _context.next = 15;\n                  break;\n                }\n\n                extra.cache.txHash = transaction.hash();\n                utils = new SignersUtils(extra, transaction);\n                /**\n                 * A list of the sources involved in the transaction.\n                 * @alias SignersUtils#sources\n                 * @type {Array}\n                 */\n\n                _context.next = 6;\n                return _resolve.txSources(extra, transaction);\n\n              case 6:\n                utils.sources = _context.sent;\n                _context.next = 9;\n                return _resolve.txSigners(extra, transaction);\n\n              case 9:\n                utils.signers = _context.sent;\n                _context.next = 12;\n                return _resolve.txSignersList(extra, transaction);\n\n              case 12:\n                utils.signersList = _context.sent;\n                Object.assign(utils, utilities);\n                extra.cache.signersUtils = utils;\n\n              case 15:\n                if (!extendFlag) {\n                  _context.next = 20;\n                  break;\n                }\n\n                if (!transaction.hasSigner) Object.assign(transaction, extra.cache.signersUtils);\n                return _context.abrupt(\"return\", transaction);\n\n              case 20:\n                return _context.abrupt(\"return\", extra.cache.signersUtils);\n\n              case 21:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function resolve(_x, _x2, _x3) {\n        return _resolve2.apply(this, arguments);\n      }\n\n      return resolve;\n    }()\n  }]);\n\n  function SignersUtils(conf, transaction) {\n    _classCallCheck(this, SignersUtils);\n\n    this.signatures = transaction.signatures;\n    misc.setHiddenProperty(this, \"_cosmicplus\", transaction._cosmicplus);\n  }\n\n  return SignersUtils;\n}();\n/******************************************************************************/\n\n\nvar utilities = {};\n/**\n * Tests if **accountId** is a legit signer for the transaction.\n *\n * @example\n * if (transaction.hasSigner(GB...DEZX)) console.log('Legit signer')\n *\n * @alias SignersUtils#hasSigner\n * @param {string} accountId\n * @return {boolean}\n */\n\nutilities.hasSigner = function (accountId) {\n  return this.signersList.find(function (key) {\n    return key === accountId;\n  });\n};\n/**\n * Tests if **accountId** has signed the transaction.\n *\n * @example\n * if (transaction.hasSigned(GB...DEZX)) console.log('Has signed')\n *\n * @alias SignersUtils#hasSigned\n * @param {string} accountId\n * @return {boolean}\n */\n\n\nutilities.hasSigned = function (accountId) {\n  if (accountId.substr(0, 1) === \"G\") {\n    var keypair = StellarSdk.Keypair.fromPublicKey(accountId);\n    var txHash = this._cosmicplus.cache.txHash;\n    return !!this.signatures.find(function (entry) {\n      return keypair.verify(txHash, entry.signature());\n    });\n  }\n};\n/******************************************************************************/\n\n/**\n * Returns SignersUtils for **transaction**.\n *\n * @async\n * @param {Transaction} transaction\n * @return {SignersUtils}\n */\n\n\nsignersUtils[\"for\"] = function (conf, transaction) {\n  return SignersUtils.resolve(conf, transaction);\n};\n/**\n * Extends **transaction** with SignersUtils.\n *\n * @async\n * @param {Transaction} transaction\n * @return {Transaction}\n */\n\n\nsignersUtils[\"extends\"] = function (conf, transaction) {\n  return SignersUtils.resolve(conf, transaction, true);\n};","\"use_strict\";\n/**\n * Methods to set tdesc/odesc defaults values and strip out useless data.\n *\n * @exports normalize\n * @private\n */\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.date.to-iso-string\");\n\nrequire(\"core-js/modules/es.date.to-string\");\n\nrequire(\"core-js/modules/es.regexp.exec\");\n\nrequire(\"core-js/modules/es.string.match\");\n\nrequire(\"core-js/modules/es.string.replace\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nvar normalize = exports;\n\nvar StellarSdk = require(\"@cosmic-plus/base/es5/stellar-sdk\");\n\nvar config = require(\"./config\");\n\nvar resolve = require(\"./resolve\");\n\nvar specs = require(\"./specs\");\n/**\n * Setup the default values for `tdesc`.\n */\n\n\nnormalize.tdesc = function (conf, tdesc) {\n  removeEmptyFields(tdesc);\n  if (!tdesc.operations) tdesc.operations = [];\n  if (tdesc.fee === 100 * tdesc.operations.length) delete tdesc.fee;\n  dateFields.forEach(function (field) {\n    if (tdesc[field]) {\n      tdesc[field] = normalize.date(conf, tdesc[field]);\n      if (tdesc[field] === \"1970\") delete tdesc[field];\n    }\n  });\n  if (tdesc.network) tdesc.network = normalize.network(conf, tdesc.network); // When network is neither test nor public, we want to provide a fallback\n  // Horizon URL; else we don't need it.\n\n  if (tdesc.network && tdesc.network !== \"public\" && tdesc.network !== \"test\") {\n    var url = resolve.horizon(config, tdesc.network) || tdesc.horizon;\n    tdesc.horizon = normalize.url(conf, url);\n  } else {\n    delete tdesc.horizon;\n  }\n\n  if (tdesc.callback) tdesc.callback = normalize.url(conf, tdesc.callback);\n};\n\nvar dateFields = [\"minTime\", \"maxTime\"];\n\nnormalize.date = function (conf, date) {\n  if (date.match(/^\\+[0-9]+$/)) {\n    var shifted = new Date();\n    shifted.setMinutes(shifted.getMinutes() + +date.substr(1));\n    date = shifted.toISOString().replace(/\\.[0-9]{3}/, \"\");\n  }\n\n  return date.replace(/:00\\.000/, \"\").replace(/\\.000/, \"\").replace(/T00:00Z/, \"\").replace(/-01$/, \"\").replace(/-01$/, \"\");\n};\n\nnormalize.network = function (conf, network) {\n  var networkName = resolve.networkName(conf, network);\n\n  if (networkName === \"public\" || networkName === \"test\") {\n    return networkName; // In network is neither test nor public, we want to use the network\n    // passphrase as parameter to ensure cross-wallet compatibility.\n  } else {\n    return resolve.networkPassphrase(conf, network);\n  }\n};\n\nnormalize.url = function (conf, url) {\n  if (url) return url.substr(0, 4) === \"http\" ? url : \"https://\" + url;\n};\n/**\n * Add the implicit values for fields made optional in the CosmicLink protocol\n * but required by StellarSdk.\n */\n\n\nnormalize.odesc = function (conf, odesc) {\n  removeEmptyFields(odesc); /// No limit = maximum limit.\n\n  if (odesc.limit === \"922337203685.4775807\") delete odesc.limit; /// New offer.\n\n  if (odesc.offerId === \"0\") delete odesc.offerId; /// Empty asset conversion path.\n\n  if (odesc.path && !odesc.path.length) delete odesc.path; /// Useless denominator.\n\n  if (odesc.price && odesc.price.d === 1) odesc.price = odesc.price.n + \"\";\n\n  switch (odesc.type) {\n    case \"allowTrust\":\n      /// Allow trust by default.\n      if (odesc.authorize === undefined) odesc.authorize = true;\n      break;\n\n    case \"createPassiveOffer\":\n    case \"manageOffer\":\n      /// Protocol 11 update renamed those operations.\n      if (odesc.type === \"manageOffer\") odesc.type = \"manageSellOffer\";else odesc.type = \"createPassiveSellOffer\";\n    // Fall Through\n\n    case \"createPassiveSellOffer\":\n    case \"manageBuyOffer\":\n    case \"manageSellOffer\":\n      /// Syntactic sugar for offer deletion\n      if (odesc.offerId && (odesc.amount === \"0\" || odesc.buyAmount === \"0\")) {\n        if (!odesc.buying && !odesc.selling) {\n          odesc.buying = new StellarSdk.Asset(\"XLM\", specs.neutralAccountId);\n        }\n\n        if (!odesc.price) odesc.price = \"1\";\n      } /// XLM as default asset.\n\n\n      if (odesc.buying && !odesc.selling) odesc.selling = XLM;\n      if (odesc.selling && !odesc.buying) odesc.buying = XLM;\n      break;\n\n    case \"manageData\":\n      /// Delete data entry.\n      if (!odesc.value) odesc.value = \"\";\n      break;\n\n    case \"pathPayment\":\n      /// XLM as default asset.\n      if (odesc.destAsset && !odesc.sendAsset) odesc.sendAsset = XLM;\n      if (odesc.sendAsset && !odesc.destAsset) odesc.destAsset = XLM;\n      break;\n\n    case \"payment\":\n      /// XLM as default asset.\n      if (!odesc.asset) odesc.asset = XLM;\n      break;\n  }\n};\n\nvar XLM = StellarSdk.Asset[\"native\"]();\n\nfunction removeEmptyFields(object) {\n  for (var field in object) {\n    if (object[field] === null || object[field] === undefined) delete object[field];\n  }\n}","\"use strict\";\n/**\n * Contains the methods to convert data from *{@see Transaction}* format to\n * *Tdesc* format.\n *\n * @private\n * @exports destruct\n */\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.array.map\");\n\nrequire(\"core-js/modules/es.date.to-iso-string\");\n\nrequire(\"core-js/modules/es.date.to-string\");\n\nrequire(\"core-js/modules/es.function.name\");\n\nrequire(\"core-js/modules/es.object.assign\");\n\nrequire(\"core-js/modules/es.object.to-string\");\n\nrequire(\"core-js/modules/es.regexp.exec\");\n\nrequire(\"core-js/modules/es.regexp.to-string\");\n\nrequire(\"core-js/modules/es.string.replace\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nvar destruct = exports;\n\nvar misc = require(\"@cosmic-plus/jsutils/es5/misc\");\n\nvar normalize = require(\"./normalize\");\n\nvar specs = require(\"./specs\");\n/**\n * Convert `tx` into *Tdesc*.\n *\n * @param {Transaction} tx\n * @param {Object} options\n * @return {Object} A tdesc\n */\n\n\ndestruct.transaction = function (conf, tx) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var tdesc = {};\n\n  if (tx.source === specs.neutralAccount && options.stripNeutralAccount) {\n    options.strip = \"source\";\n  } else if (tx.sequence === \"0\" && options.stripNeutralSequence) {\n    options.strip = \"sequence\";\n  }\n\n  tdesc.network = options.network;\n  tdesc.horizon = options.horizon;\n  tdesc.callback = options.callback;\n\n  if (options.strip !== \"source\") {\n    tdesc.source = tx.source;\n\n    if (options.strip !== \"sequence\") {\n      tdesc.sequence = destruct.sequence(conf, tx.sequence);\n    }\n  }\n\n  if (tx._memo._switch.name !== \"memoNone\") tdesc.memo = destruct.memo(conf, tx._memo);\n\n  if (tx.timeBounds) {\n    if (tx.timeBounds.minTime) tdesc.minTime = destruct.date(conf, tx.timeBounds.minTime);\n    if (tx.timeBounds.maxTime) tdesc.maxTime = destruct.date(conf, tx.timeBounds.maxTime);\n  }\n\n  tdesc.fee = tx.fee;\n  tdesc.operations = tx.operations.map(function (op) {\n    return destruct.operation(conf, op);\n  });\n  normalize.tdesc(conf, tdesc);\n  return tdesc;\n};\n/**\n * Convert `op` into odesc format.\n *\n * @param {Object} op A StellarSdk Operation\n * @return {Object} An odesc\n */\n\n\ndestruct.operation = function (conf, op) {\n  var odesc = {};\n\n  for (var field in op) {\n    if (field === \"type\") odesc.type = op.type;else if (field === \"line\") odesc.asset = op.line;else odesc[field] = destruct.field(conf, field, op[field]);\n  }\n\n  normalize.odesc(conf, odesc);\n  return odesc;\n};\n/******************************************************************************/\n\n/**\n * Destruct `value` according to `field` type.\n *\n * @param {string} field\n * @param {any} value\n */\n\n\ndestruct.field = function (conf, field, value) {\n  var type = specs.fieldType[field];\n  if (type) return destruct.type(conf, type, value);else throw new Error(\"Invalid field: \".concat(field));\n};\n/**\n * Destruct `value` using the destructuring function for `type`.\n *\n * @param {string} type\n * @param {any} value\n */\n\n\ndestruct.type = function (conf, type, value) {\n  if (value === null || value === undefined) return value;else return destruct[type](conf, value);\n};\n/******************************************************************************/\n\n\ndestruct.asset = function (conf, asset) {\n  return Object.assign({}, asset);\n};\n\ndestruct.assetPath = function (conf, assetPath) {\n  return assetPath.map(function (asset) {\n    return destruct.asset(asset);\n  });\n};\n\ndestruct.amount = function (conf, amount) {\n  return amount.replace(/\\.?0+$/, \"\");\n};\n\ndestruct.buffer = function (conf, buffer) {\n  if (!buffer) return null;\n  var string = buffer.toString();\n\n  if (misc.isUtf8(string)) {\n    return {\n      type: \"text\",\n      value: string\n    };\n  } else {\n    var value = buffer.toString(\"base64\").replace(/=*$/, \"\");\n    return {\n      type: \"base64\",\n      value: value\n    };\n  }\n};\n\ndestruct.date = function (conf, timestamp) {\n  return new Date(timestamp * 1000).toISOString();\n};\n\ndestruct.memo = function (conf, sdkMemo) {\n  var memo = {};\n\n  if (sdkMemo._switch.name !== \"memoNone\") {\n    memo.type = sdkMemo._arm;\n\n    if (memo.type === \"hash\" || memo.type === \"retHash\") {\n      memo.value = sdkMemo._value.toString(\"hex\");\n      if (memo.type === \"retHash\") memo.type = \"return\";\n    } else if (memo.type === \"text\") {\n      return destruct.buffer(conf, sdkMemo._value);\n    } else {\n      memo.value = sdkMemo._value.toString();\n    }\n  }\n\n  return memo;\n};\n\ndestruct.sequence = function (conf, sdkSequence) {\n  return sdkSequence.toString();\n};\n\ndestruct.signer = function (conf, sdkSigner) {\n  var signer = {\n    weight: sdkSigner.weight\n  };\n\n  if (sdkSigner.ed25519PublicKey) {\n    signer.type = \"key\";\n    signer.value = sdkSigner.ed25519PublicKey;\n  } else if (sdkSigner.sha256Hash) {\n    signer.type = \"hash\";\n    signer.value = sdkSigner.sha256Hash.toString(\"hex\");\n  } else if (sdkSigner.preAuthTx) {\n    signer.type = \"tx\";\n    signer.value = sdkSigner.preAuthTx.toString(\"hex\");\n  }\n\n  return signer;\n};\n/******************************************************************************/\n\n/**\n * Provide dummy aliases for every other type for convenience & backward\n * compatibility.\n */\n\n\nspecs.types.forEach(function (type) {\n  if (!exports[type]) exports[type] = function (conf, value) {\n    return value;\n  };\n});","\"use strict\";\n/**\n * Sep-0007 protocol utilities.\n *\n * The methods listed in the documentation are browser-only.\n *\n * @see https://github.com/stellar/stellar-protocol/blob/master/ecosystem/sep-0007.md\n *\n * @exports sep7Utils\n */\n\nrequire(\"core-js/modules/es.array.concat\");\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.date.to-string\");\n\nrequire(\"core-js/modules/es.object.to-string\");\n\nrequire(\"core-js/modules/es.regexp.exec\");\n\nrequire(\"core-js/modules/es.regexp.to-string\");\n\nrequire(\"core-js/modules/es.string.replace\");\n\nrequire(\"core-js/modules/es.string.split\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nvar _regeneratorRuntime = require(\"@babel/runtime/regenerator\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator = require(\"@babel/runtime/helpers/asyncToGenerator\");\n\nvar sep7Utils = exports;\n\nvar Buffer = require(\"@cosmic-plus/base/es5/buffer\");\n\nvar env = require(\"@cosmic-plus/jsutils/es5/env\");\n\nvar StellarSdk = require(\"@cosmic-plus/base/es5/stellar-sdk\");\n\nvar _require = require(\"@cosmic-plus/jsutils/es5/misc\"),\n    timeout = _require.timeout;\n\nvar check = require(\"./check\");\n\nvar convert = require(\"./convert\");\n\nvar decode = require(\"./decode\");\n\nvar parse = require(\"./parse\");\n/* Utils */\n\n/**\n * Proposes the user to register **handler** as her default SEP-0007 link\n * handler. SEP-0007 requests will hit `{handler}?sep7={sep7Request}`.\n *\n * Note that this makes use of a non-standard feature. Compatibility can be\n * checked using `sep7Utils.isWebHandlerSupported()`.\n *\n * [List of compatible browsers](https://caniuse.com/#feat=registerprotocolhandler).\n *\n * @example\n * cosmicLib.sep7Utils.registerWebHandler(\n *  \"https://cosmic.link/\",\n *  \"Cosmic.link\"\n * )\n *\n * @param handler {String} URL of the SEP-0007 web handler.\n * @param description {String} A brief description of the service.\n */\n\n\nsep7Utils.registerWebHandler = function (handler, description) {\n  if (!env.isBrowser) throw new Error(\"This is a browser-only function.\");\n\n  if (navigator.registerProtocolHandler) {\n    navigator.registerProtocolHandler(\"web+stellar\", \"\".concat(handler, \"?sep7=%s\"), description);\n  } else {\n    throw new Error(\"This browser can't register a SEP-0007 web handler.\");\n  }\n};\n/**\n * Returns whether or not the browser can register a SEP-0007 web handler.\n *\n * @example\n * if (cosmicLib.sep7Utils.isWebHandlerSupported()) {\n *    registerSep7HandlerButton.show()\n * }\n *\n * @returns {Boolean}\n */\n\n\nsep7Utils.isWebHandlerSupported = function () {\n  return env.isBrowser && !!navigator.registerProtocolHandler;\n};\n/* Parsing */\n\n/**\n * Initialize cosmicLink using `sep7Request`.\n * @private\n */\n\n\nsep7Utils.parseRequest = function (cosmicLink, sep7Request, options) {\n  parse.page(cosmicLink, sep7Request);\n  var query = convert.uriToQuery(cosmicLink, sep7Request);\n  var sep7 = decodeURIComponent(query.replace(/^\\?(req|sep7)=/, \"\"));\n  return sep7Utils.parseLink(cosmicLink, sep7, options);\n};\n/**\n * Initialize cosmicLink using `sep7`.\n * @private\n */\n\n\nsep7Utils.parseLink = function (cosmicLink, sep7) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  cosmicLink._sep7 = sep7;\n  if (!options.network) options.network = \"public\";\n\n  if (sep7.substr(12, 4) === \"pay?\") {\n    cosmicLink.extra.type = \"pay\";\n    return sep7Utils.parsePayLink(cosmicLink, sep7, options);\n  } else if (sep7.substr(12, 3) === \"tx?\") {\n    cosmicLink.extra.type = \"tx\";\n    return sep7Utils.parseTxLink(cosmicLink, sep7, options);\n  } else {\n    throw new Error(\"Invalid SEP-0007 link.\");\n  }\n};\n/**\n * Initialize cosmicLink using `sep7.xdr`.\n * @private\n */\n\n\nsep7Utils.parseTxLink = function (cosmicLink, sep7) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var query = convert.uriToQuery(cosmicLink, sep7);\n  var params = query.substr(1).split(\"&\");\n  var xdr;\n  params.forEach(function (entry) {\n    var field = entry.replace(/=.*$/, \"\");\n    var value = entry.substr(field.length + 1);\n\n    switch (field) {\n      case \"xdr\":\n        xdr = decodeURIComponent(value);\n        break;\n\n      case \"pubkey\":\n        check.address(cosmicLink, value);\n        cosmicLink.extra.pubkey = value;\n        break;\n\n      default:\n        sep7Utils.parseLinkCommons(cosmicLink, \"xdr\", field, value, options);\n    }\n  });\n  if (!xdr) throw new Error(\"Missing XDR parameter\");\n  options.stripNeutralSequence = true;\n  return {\n    type: \"xdr\",\n    value: xdr,\n    options: options\n  };\n};\n/**\n * Initialize cosmicLink using `sep7.pay`.\n * @private\n */\n\n\nsep7Utils.parsePayLink = function (cosmicLink, sep7) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var query = convert.uriToQuery(cosmicLink, sep7);\n  var params = query.substr(1).split(\"&\");\n  var odesc = {\n    type: \"payment\"\n  },\n      asset = {},\n      memo = {};\n  var tdesc = {\n    network: options.network,\n    operations: [odesc]\n  }; // Parse\n\n  params.forEach(function (entry) {\n    var field = entry.replace(/=.*$/, \"\");\n    var value = entry.substr(field.length + 1);\n\n    switch (field) {\n      case \"destination\":\n      case \"amount\":\n        odesc[field] = decode.field(cosmicLink, field, value);\n        break;\n\n      case \"asset_code\":\n        asset.code = decodeURIComponent(value);\n        break;\n\n      case \"asset_issuer\":\n        asset.issuer = decodeURIComponent(value);\n        break;\n\n      case \"memo_type\":\n        memo.type = value.split(\"_\")[1].toLowerCase();\n        break;\n\n      case \"memo\":\n        memo.value = decode.string(cosmicLink, value);\n        break;\n\n      default:\n        sep7Utils.parseLinkCommons(cosmicLink, \"pay\", field, value, options);\n    }\n  }); // Convert\n\n  if (memo.type || memo.value) {\n    if (memo.type === \"hash\" || memo.type === \"return\") {\n      memo.value = Buffer.from(memo.value, \"base64\").toString(\"hex\");\n    }\n\n    tdesc.memo = memo;\n  }\n\n  if (asset.code || asset.issuer) odesc.asset = asset;\n  if (!odesc.destination) throw new Error(\"Missing parameter: destination\");\n  return {\n    type: \"tdesc\",\n    value: tdesc,\n    options: options\n  };\n};\n\nsep7Utils.parseLinkCommons = function (cosmicLink, mode, field, value, options) {\n  switch (field) {\n    case \"network_passphrase\":\n      options.network = decode.network(cosmicLink, value);\n      break;\n\n    case \"callback\":\n      value = decode.url(cosmicLink, value);\n\n      if (value.substr(0, 4) !== \"url:\") {\n        throw new Error(\"Invalid callback: \" + value);\n      }\n\n      options.callback = value.substr(4);\n      break;\n\n    case \"origin_domain\":\n      cosmicLink.extra.originDomain = sep7Utils.verifySignature(cosmicLink, value);\n      break;\n\n    case \"signature\":\n      cosmicLink.extra.signature = decodeURIComponent(value);\n      break;\n\n    case \"msg\":\n      cosmicLink.extra.msg = decode.string(cosmicLink, value);\n      break;\n\n    default:\n      throw new Error(\"Invalid SEP-0007 \".concat(mode, \" field: \") + field);\n  }\n};\n/* Signing */\n\n\nsep7Utils.signLink = function (cosmicLink, domain, keypair) {\n  if (!cosmicLink.locker) throw new Error(\"cosmicLink is not locked.\");\n  cosmicLink.extra.originDomain = domain;\n  delete cosmicLink.extra.signature;\n  delete cosmicLink._sep7;\n  var link = cosmicLink.sep7;\n  var payload = sep7Utils.makePayload(link);\n  cosmicLink.extra.signature = keypair.sign(payload).toString(\"base64\");\n  delete cosmicLink._sep7;\n};\n\nsep7Utils.verifySignature =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(cosmicLink, domain) {\n    var link, signature, payload, keypair;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            link = cosmicLink.sep7.replace(/&signature=.*/, \"\"); // Let parser parse signature.\n\n            _context.next = 3;\n            return timeout(1);\n\n          case 3:\n            signature = cosmicLink.extra.signature;\n\n            if (signature) {\n              _context.next = 6;\n              break;\n            }\n\n            throw new Error(\"No signature attached for domain: \".concat(domain));\n\n          case 6:\n            payload = sep7Utils.makePayload(link);\n            _context.next = 9;\n            return sep7Utils.getDomainKeypair(domain);\n\n          case 9:\n            keypair = _context.sent;\n\n            if (!keypair.verify(payload, Buffer.from(signature, \"base64\"))) {\n              _context.next = 14;\n              break;\n            }\n\n            return _context.abrupt(\"return\", domain);\n\n          case 14:\n            throw new Error(\"Invalid signature for domain: \".concat(domain));\n\n          case 15:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nsep7Utils.getDomainKeypair =\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2(domain) {\n    var toml, signingKey;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return StellarSdk.StellarTomlResolver.resolve(domain);\n\n          case 2:\n            toml = _context2.sent;\n            signingKey = toml.URI_REQUEST_SIGNING_KEY;\n\n            if (signingKey) {\n              _context2.next = 6;\n              break;\n            }\n\n            throw new Error(\"Can't find signing key for domain: \".concat(domain));\n\n          case 6:\n            return _context2.abrupt(\"return\", StellarSdk.Keypair.fromPublicKey(signingKey));\n\n          case 7:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function (_x3) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nsep7Utils.makePayload = function (link) {\n  return Buffer.concat([Buffer.alloc(35), Buffer.alloc(1, 4), Buffer.from(\"stellar.sep.7 - URI Scheme\".concat(link))]);\n};","\"use strict\"\n/**\n * Anchor\n */\nconst aliases = require(\"@cosmic-plus/base/es5/aliases\")\nconst helpers = require(\"@cosmic-plus/jsutils/es5/misc\")\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\n\nconst Asset = require(\"./asset\")\n\n/**\n * Definition\n */\n\nclass Anchor extends Projectable {\n  static resolve (pubkey, params) {\n    return Anchor.table[pubkey] || new Anchor(pubkey, params)\n  }\n\n  constructor (pubkey, params) {\n    super()\n    if (params) Object.assign(this, params)\n\n    Anchor.table[pubkey] = this\n\n    this.pubkey = pubkey\n    this.alias = aliases.all[pubkey]\n    this.name = helpers.shorter(this.alias || this.pubkey)\n\n    this.assets = {}\n\n    if (this.emit)\n      this.emit.forEach(entry => {\n        if (typeof entry !== \"string\") this.addAsset(entry[0], entry[1])\n        else this.addAsset(entry)\n      })\n  }\n\n  addAsset (code, alias = code) {\n    this.assets[alias] = Asset.resolve(code)\n    this.assets[alias].anchors.push(this)\n  }\n}\n\nAnchor.table = {}\n\n/**\n * Utilities\n */\n\n/**\n * Register known **anchors**.\n */\nAnchor.register = function (anchors) {\n  for (let pubkey in anchors) {\n    Anchor.resolve(pubkey, anchors[pubkey])\n  }\n}\n\n/**\n * Returns the anchor local code for **assetCode**.\n */\nAnchor.prototype.tetherCode = function (assetCode) {\n  for (let index in this.emit) {\n    const entry = this.emit[index]\n\n    if (entry === assetCode) {\n      return assetCode\n    } else if (Array.isArray(entry)) {\n      if (entry[0] === assetCode) return entry[1]\n    }\n  }\n}\n\n/**\n * Export\n */\nmodule.exports = Anchor\n","\"use strict\"\n/**\n * Theme for Highstock\n */\nconst Highstock = require(\"highcharts/highstock\")\n\n/**\n * Theme Colors\n */\nconst backgroundLight = \"#edf2f9\"\nconst black = \"#111\"\nconst formBackground = \"#f8f9fb\"\nconst greyLighter = \"#fefefe\"\nconst greyLight = \"#e6e6e6\"\nconst greyMedium = \"#cccccc\"\nconst greyDarker = \"#666\"\nconst highlight = \"#7799d5\"\n\n/**\n * Main Theme\n */\n\nHighstock.theme = {\n  rangeSelector: {\n    selected: 2,\n    inputBoxBorderColor: greyLight,\n    buttonTheme: {\n      fill: formBackground,\n      states: {\n        hover: { fill: backgroundLight },\n        select: { fill: highlight, style: { color: greyLighter } }\n      }\n    }\n  },\n\n  chart: {\n    backgroundColor: greyLighter,\n    style: {\n      fontFamily: \"'Source Sans Pro', arial, sans-serif\",\n      color: black\n    }\n  },\n\n  xAxis: {\n    lineColor: greyLight,\n    tickColor: greyLight\n  },\n\n  yAxis: {\n    lineColor: greyLight,\n    tickColor: greyLight\n  },\n\n  navigator: {\n    maskFill: \"rgba(119, 153, 213, 0.07)\",\n    outlineColor: greyMedium,\n    xAxis: { gridLineColor: greyLight },\n    series: { color: highlight }\n  },\n\n  tooltip: { style: { fontSize: \"14px\" } },\n  scrollbar: { enabled: false },\n  credits: { enabled: false },\n\n  plotOptions: {\n    column: {\n      color: greyDarker,\n      dataGrouping: { enabled: false }\n    },\n\n    pie: {\n      allowPointSelect: true,\n      animation: false,\n      cursor: \"pointer\",\n      dataLabels: { style: { fontSize: \"14px\" } }\n    },\n\n    spline: {\n      color: highlight,\n      dataGrouping: { enabled: false }\n    }\n  }\n}\n\nHighstock.setOptions(Highstock.theme)\n\n/**\n * Individual Theme Components\n */\n\nHighstock.pieColors = [\n  \"rgba(231,  76,  60, 0.8)\",\n  \"rgba(230, 126,  34, 0.8)\",\n  \"rgba(242, 202,  39, 0.8)\",\n  \"rgba(46,  204, 112, 0.8)\",\n  \"rgba(52,  152, 219, 0.8)\",\n  \"rgba(155,  89, 182, 0.8)\",\n\n  \"rgba(231,  76,  60, 0.6)\",\n  \"rgba(230, 126,  34, 0.6)\",\n  \"rgba(242, 202,  39, 0.6)\",\n  \"rgba(46,  204, 112, 0.6)\",\n  \"rgba(52,  152, 219, 0.6)\",\n  \"rgba(155,  89, 182, 0.6)\",\n\n  \"rgba(231,  76,  60, 0.4)\",\n  \"rgba(230, 126,  34, 0.4)\",\n  \"rgba(242, 202,  39, 0.4)\",\n  \"rgba(46,  204, 112, 0.4)\",\n  \"rgba(52,  152, 219, 0.4)\",\n  \"rgba(155,  89, 182, 0.4)\"\n]\n\nHighstock.pieResponsive = {\n  rules: [\n    {\n      condition: { maxWidth: 500 },\n      chartOptions: {\n        legend: { enabled: true },\n        plotOptions: {\n          pie: {\n            showInLegend: true,\n            dataLabels: {\n              format: \"{point.percentage:.0f}%\",\n              distance: -20\n            }\n          }\n        }\n      }\n    }\n  ]\n}\n","\"use_strict\";\n/**\n * Generic tabbed browsing Gui.\n */\n\nrequire(\"core-js/modules/es.array.find\");\n\nrequire(\"core-js/modules/es.array.find-index\");\n\nrequire(\"core-js/modules/es.array.splice\");\n\nrequire(\"core-js/modules/es.function.name\");\n\nrequire(\"core-js/modules/es.string.link\");\n\nvar _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"@babel/runtime/helpers/createClass\");\n\nvar _possibleConstructorReturn = require(\"@babel/runtime/helpers/possibleConstructorReturn\");\n\nvar _getPrototypeOf = require(\"@babel/runtime/helpers/getPrototypeOf\");\n\nvar _assertThisInitialized = require(\"@babel/runtime/helpers/assertThisInitialized\");\n\nvar _inherits = require(\"@babel/runtime/helpers/inherits\");\n\nvar Mirrorable = require(\"@cosmic-plus/jsutils/es5/mirrorable\");\n\nvar html = require(\"./html\");\n\nvar Gui = require(\"./gui\");\n\nvar Tabs = module.exports =\n/*#__PURE__*/\nfunction (_Mirrorable) {\n  \"use strict\";\n\n  _inherits(Tabs, _Mirrorable);\n\n  function Tabs() {\n    var _this;\n\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Tabs);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Tabs).call(this));\n    _this.nav = new Tabs.Nav(_assertThisInitialized(_this));\n    _this.selector = new Tabs.Selector(_assertThisInitialized(_this));\n    _this.view = new Tabs.View(_assertThisInitialized(_this));\n    if (options.nav) html.append(options.nav, _this.nav);\n    if (options.selector) html.append(options.selector, _this.selector);\n    if (options.view) html.append(options.view, _this.view);\n    return _this;\n  }\n\n  _createClass(Tabs, [{\n    key: \"add\",\n    value: function add(id, name, content, select) {\n      this.push(new Tabs.Content(this, id, name, content));\n      if (select || !this.selected) this.select(id);\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(id) {\n      var index = this.findIndex(function (content) {\n        return content.id === id;\n      });\n      var content = this[index];\n      if (this.selected === content) this.select();\n      if (index != null) this.splice(index, 1);\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.splice(0, this.length);\n    }\n  }, {\n    key: \"select\",\n    value: function select(id) {\n      if (this.selected) {\n        this.selected.destroy();\n        if (this.selected.link) this.selected.link.className = \"\";\n      }\n\n      var selected = this.find(function (content) {\n        return content.id === id;\n      });\n\n      if (selected) {\n        selected.generate();\n        if (selected.link) selected.link.className = \"selected\";\n      }\n\n      this.selected = selected;\n      this.trigger(\"select\", id);\n    }\n  }]);\n\n  return Tabs;\n}(Mirrorable);\n\nTabs.Content =\n/*#__PURE__*/\nfunction () {\n  \"use strict\";\n\n  function TabsContent(tabs, id, name, content) {\n    var _this2 = this;\n\n    _classCallCheck(this, TabsContent);\n\n    this.id = id;\n    this.name = name;\n    this.content = content;\n\n    if (content.parentNode && content.parentNode.removeChild) {\n      content.parentNode.removeChild(content);\n    }\n\n    this.select = function () {\n      return tabs.selected === _this2 || tabs.select(id);\n    };\n\n    if (name) {\n      this.link = html.create(\"a\", {\n        onclick: this.select\n      }, name);\n      this.option = html.create(\"option\", {\n        onselect: this.select,\n        value: id\n      }, name);\n    }\n  }\n\n  _createClass(TabsContent, [{\n    key: \"generate\",\n    value: function generate() {\n      if (typeof this.content === \"function\") {\n        this.component = this.content();\n        this.domNode = html.convert(this.component);\n      } else if (!this.domNode) {\n        this.domNode = html.convert(this.content);\n      }\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      if (this.component && this.component.destroy) this.component.destroy();\n    }\n  }]);\n\n  return TabsContent;\n}();\n\nTabs.Nav =\n/*#__PURE__*/\nfunction (_Gui) {\n  \"use strict\";\n\n  _inherits(TabsNav, _Gui);\n\n  function TabsNav(tabs) {\n    var _this3;\n\n    _classCallCheck(this, TabsNav);\n\n    _this3 = _possibleConstructorReturn(this, _getPrototypeOf(TabsNav).call(this, \"<nav class=\\\"TabsNav\\\">%links...</nav>\"));\n    _this3.links = tabs.mirror(function (tab) {\n      return tab.link;\n    });\n    return _this3;\n  }\n\n  return TabsNav;\n}(Gui);\n\nTabs.Selector =\n/*#__PURE__*/\nfunction (_Gui2) {\n  \"use strict\";\n\n  _inherits(TabsSelector, _Gui2);\n\n  function TabsSelector(tabs) {\n    var _this4;\n\n    _classCallCheck(this, TabsSelector);\n\n    _this4 = _possibleConstructorReturn(this, _getPrototypeOf(TabsSelector).call(this, \"<select class=\\\"TabsSelector\\\" %onchange value=%selected>%options...</select>\"));\n\n    _this4.onchange = function (event) {\n      return event.target.selectedOptions[0].onselect();\n    };\n\n    _this4.options = tabs.mirror(function (content) {\n      return content.option;\n    });\n    tabs.project(\"selected\", _assertThisInitialized(_this4), function (content) {\n      return content && content.id;\n    });\n    return _this4;\n  }\n\n  return TabsSelector;\n}(Gui);\n\nTabs.View =\n/*#__PURE__*/\nfunction (_Gui3) {\n  \"use strict\";\n\n  _inherits(TabsView, _Gui3);\n\n  function TabsView(tabs) {\n    var _this5;\n\n    _classCallCheck(this, TabsView);\n\n    _this5 = _possibleConstructorReturn(this, _getPrototypeOf(TabsView).call(this, \"<div class=\\\"TabsView\\\">%content</div>\"));\n    tabs.link(\"selected\", _assertThisInitialized(_this5), \"content\", function (x) {\n      return x && x.domNode;\n    });\n    return _this5;\n  }\n\n  return TabsView;\n}(Gui);","\"use_stict\";\n\nvar env = require(\"@cosmic-plus/jsutils/es5/env\");\n\nif (env.isBrowser) {\n  module.exports = require(\"./stellar-sdk\").axios;\n} else {\n  module.exports = env.nodeRequire(\"axios\");\n}","\"use strict\";\n/**\n * Contains the methods to trigger and handle events.\n *\n * @private\n * @exports event\n */\n\nvar event = exports;\n\nvar html = require(\"@cosmic-plus/domutils/es5/html\");\n\nvar format = require(\"./format\");\n/** *** Click events *****/\n\n/**\n * Set the click handler for **type** HTML elements as **callback**.\n *\n * @example\n * cosmicLib.config.setClickHandler('address', showAddressPopup)\n *\n * @param {string} type Type of a transaction/operation field such as\n *     `address`, `asset`, `hash`, ...\n * @param {function} callback A function that accept one `event` argument\n */\n\n\nevent.setClickHandler = function (conf, type, callback) {\n  conf.clickHandlers[type] = callback;\n};\n/**\n * Remove the current click handler for **type**.\n *\n * @example\n * cosmicLib.config.clearClickHandler('address')\n *\n * @param {string} type Type of a transaction/operation field such as\n *     `address`, `asset`, `hash`, ...\n */\n\n\nevent.clearClickHandler = function (conf, type) {\n  conf.clickHandlers[type] = undefined;\n};\n\nevent.callClickHandler = function (conf, type, event) {\n  var handler = conf.clickHandlers[type];\n  event.extra = event.domNode.extra;\n  event.field = event.domNode.field;\n  event.tdesc = format.parentTdesc(conf, event.domNode);\n  event.odesc = format.parentOdesc(conf, event.domNode);\n  event.index = format.parentIndex(conf, event.domNode);\n  if (handler) handler(event);\n};\n/**\n * The active click handlers. Takes the form:\n *\n * ```\n * cosmicLib.config.clickHandlers = {\n *   type1: callback1,\n *   ...\n *   typeN: callbackN\n * }\n * ```\n *\n * Thoses click handlers are set by default:\n *\n * * **address**: A prompt that shows the address details\n * * **id**: A function that copy the id into the clipboard\n * * **hash**: A function that copy the hash into the clipboard or show a prompt\n *   for preimage signature when relevant\n * ```\n */\n\n\nevent.defaultClickHandlers = {\n  address: function address(event) {\n    if (!event.extra) return;\n    var message = \"\";\n\n    for (var field in event.extra) {\n      message += \"\".concat(field, \":\\n\") + \"\".concat(event.extra[field], \"\\n\\n\");\n    }\n\n    window.alert(message);\n  },\n  hash: function hash(event) {\n    var grandma = event.domNode.parentNode.parentNode.parentNode;\n\n    if (grandma.classList.contains(\"cosmiclib_signers\")) {\n      var preimage = prompt(\"Please enter preimage:\");\n      if (preimage) event.cosmicLink.sign(preimage);\n    } else {\n      html.copyString(event.value);\n    }\n  },\n  id: function id(event) {\n    return html.copyString(event.value);\n  }\n};","\"use strict\";\n/**\n * Contains the methods to convert field values from CosmicLink's\n * `transaction descriptor` format to Stellar transaction object format.\n *\n * @private\n * @exports construct\n */\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.array.iterator\");\n\nrequire(\"core-js/modules/es.date.to-string\");\n\nrequire(\"core-js/modules/es.object.to-string\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator\");\n\nvar _regeneratorRuntime = require(\"@babel/runtime/regenerator\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator = require(\"@babel/runtime/helpers/asyncToGenerator\");\n\nvar construct = exports;\n\nvar Buffer = require(\"@cosmic-plus/base/es5/buffer\");\n\nvar misc = require(\"@cosmic-plus/jsutils/es5/misc\");\n\nvar StellarSdk = require(\"@cosmic-plus/base/es5/stellar-sdk\");\n\nvar resolve = require(\"./resolve\");\n\nvar specs = require(\"./specs\");\n\nvar status = require(\"./status\");\n/**\n * Returns the StellarSdk Transaction built from tdesc.\n *\n * @param {Object} tdesc\n * @return {Transaction}\n */\n\n\nconstruct.transaction =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(conf, tdesc) {\n    var txBuilder, index, odesc, operation;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!conf.status) {\n              _context.next = 2;\n              break;\n            }\n\n            throw new Error(conf.status);\n\n          case 2:\n            _context.prev = 2;\n            _context.next = 5;\n            return makeTransactionBuilder(conf, tdesc);\n\n          case 5:\n            txBuilder = _context.sent;\n            _context.t0 = _regeneratorRuntime.keys(tdesc.operations);\n\n          case 7:\n            if ((_context.t1 = _context.t0()).done) {\n              _context.next = 16;\n              break;\n            }\n\n            index = _context.t1.value;\n            odesc = tdesc.operations[index];\n            _context.next = 12;\n            return construct.operation(conf, odesc);\n\n          case 12:\n            operation = _context.sent;\n            txBuilder.addOperation(operation);\n            _context.next = 7;\n            break;\n\n          case 16:\n            return _context.abrupt(\"return\", txBuilder.build());\n\n          case 19:\n            _context.prev = 19;\n            _context.t2 = _context[\"catch\"](2);\n\n            if (!conf.errors) {\n              console.error(_context.t2);\n              status.error(conf, _context.t2.message);\n            }\n\n            if (conf.status) {\n              _context.next = 26;\n              break;\n            }\n\n            status.fail(conf, \"Transaction build failed\", \"throw\");\n            _context.next = 27;\n            break;\n\n          case 26:\n            throw _context.t2;\n\n          case 27:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[2, 19]]);\n  }));\n\n  return function (_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n/**\n * Returns the StellarSdk Operation built from `odesc`.\n *\n * @param {Object} odesc\n * @return {Operation}\n */\n\n\nconstruct.operation =\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2(conf, odesc) {\n    var operation, field;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            operation = odesc.type;\n            delete odesc.type;\n            _context2.t0 = _regeneratorRuntime.keys(odesc);\n\n          case 3:\n            if ((_context2.t1 = _context2.t0()).done) {\n              _context2.next = 10;\n              break;\n            }\n\n            field = _context2.t1.value;\n            _context2.next = 7;\n            return construct.field(conf, field, odesc[field]);\n\n          case 7:\n            odesc[field] = _context2.sent;\n            _context2.next = 3;\n            break;\n\n          case 10:\n            return _context2.abrupt(\"return\", StellarSdk.Operation[operation](odesc));\n\n          case 11:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function (_x3, _x4) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n/**\n * Returns the TransactionBuilder for `tdesc`.\n */\n\n\nfunction makeTransactionBuilder(_x5, _x6) {\n  return _makeTransactionBuilder.apply(this, arguments);\n}\n/******************************************************************************/\n\n/**\n * Prepare `value` accordingly to `field` type.\n *\n * @param {string} field\n * @param {any} value\n */\n\n\nfunction _makeTransactionBuilder() {\n  _makeTransactionBuilder = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee9(conf, tdesc) {\n    var server, baseFee, txOpts, sourceAccount, builder, index, operation, destination, memoType, memoValue, _short;\n\n    return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n      while (1) {\n        switch (_context9.prev = _context9.next) {\n          case 0:\n            server = resolve.server(conf);\n            _context9.next = 3;\n            return server.fetchBaseFee();\n\n          case 3:\n            baseFee = _context9.sent;\n            txOpts = {};\n            txOpts.networkPassphrase = resolve.networkPassphrase(conf);\n            if (tdesc.fee) txOpts.fee = tdesc.fee;else txOpts.fee = tdesc.operations.length * baseFee;\n            if (tdesc.memo) txOpts.memo = construct.memo(conf, tdesc.memo);\n\n            if (tdesc.minTime || tdesc.maxTime) {\n              txOpts.timebounds = {\n                minTime: 0,\n                maxTime: 0\n              };\n              if (tdesc.minTime) txOpts.timebounds.minTime = construct.date(conf, tdesc.minTime);\n              if (tdesc.maxTime) txOpts.timebounds.maxTime = construct.date(conf, tdesc.maxTime);\n            }\n\n            _context9.next = 11;\n            return resolve.txSourceAccount(conf, tdesc.source, tdesc.sequence);\n\n          case 11:\n            sourceAccount = _context9.sent;\n            builder = new StellarSdk.TransactionBuilder(sourceAccount, txOpts);\n            if (!tdesc.maxTime) builder.setTimeout(StellarSdk.TimeoutInfinite); /// Check if memo is needed for destination account.\n\n            _context9.t0 = _regeneratorRuntime.keys(tdesc.operations);\n\n          case 15:\n            if ((_context9.t1 = _context9.t0()).done) {\n              _context9.next = 25;\n              break;\n            }\n\n            index = _context9.t1.value;\n            operation = tdesc.operations[index];\n\n            if (!operation.destination) {\n              _context9.next = 23;\n              break;\n            }\n\n            _context9.next = 21;\n            return resolve.address(conf, operation.destination);\n\n          case 21:\n            destination = _context9.sent;\n\n            if (destination.memo) {\n              memoType = destination.memo_type;\n              memoValue = destination.memo;\n\n              if (tdesc.memo && (tdesc.memo.type !== memoType || tdesc.memo.value !== memoValue)) {\n                _short = misc.shorter(operation.destination);\n                status.error(conf, \"Memo conflict: \".concat(_short, \" requires to set a memo\"), \"throw\");\n              } else {\n                // eslint-disable-next-line require-atomic-updates\n                tdesc.memo = {\n                  type: memoType,\n                  value: memoValue\n                };\n                builder.addMemo(new StellarSdk.Memo(memoType, memoValue));\n              }\n            }\n\n          case 23:\n            _context9.next = 15;\n            break;\n\n          case 25:\n            return _context9.abrupt(\"return\", builder);\n\n          case 26:\n          case \"end\":\n            return _context9.stop();\n        }\n      }\n    }, _callee9);\n  }));\n  return _makeTransactionBuilder.apply(this, arguments);\n}\n\nconstruct.field =\n/*#__PURE__*/\nfunction () {\n  var _ref3 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee3(conf, field, value) {\n    var type;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            type = specs.fieldType[field];\n\n            if (!type) {\n              _context3.next = 5;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", construct.type(conf, type, value));\n\n          case 5:\n            throw new Error(\"Invalid field: \".concat(field));\n\n          case 6:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n\n  return function (_x7, _x8, _x9) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n/**\n * Prepare `value` using the preparing function for `type`.\n *\n * @param {string} type\n * @param {any} value\n */\n\n\nconstruct.type =\n/*#__PURE__*/\nfunction () {\n  var _ref4 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee4(conf, type, value) {\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            return _context4.abrupt(\"return\", construct[type](conf, value));\n\n          case 1:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n\n  return function (_x10, _x11, _x12) {\n    return _ref4.apply(this, arguments);\n  };\n}();\n/******************************************************************************/\n\n\nconstruct.address =\n/*#__PURE__*/\nfunction () {\n  var _ref5 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee5(conf, address) {\n    var account;\n    return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            _context5.next = 2;\n            return resolve.address(conf, address);\n\n          case 2:\n            account = _context5.sent;\n            return _context5.abrupt(\"return\", account.account_id);\n\n          case 4:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5);\n  }));\n\n  return function (_x13, _x14) {\n    return _ref5.apply(this, arguments);\n  };\n}();\n\nconstruct.asset =\n/*#__PURE__*/\nfunction () {\n  var _ref6 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee6(conf, asset) {\n    var publicKey;\n    return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            if (!asset.issuer) {\n              _context6.next = 7;\n              break;\n            }\n\n            _context6.next = 3;\n            return construct.address(conf, asset.issuer);\n\n          case 3:\n            publicKey = _context6.sent;\n            return _context6.abrupt(\"return\", new StellarSdk.Asset(asset.code, publicKey));\n\n          case 7:\n            return _context6.abrupt(\"return\", StellarSdk.Asset[\"native\"]());\n\n          case 8:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6);\n  }));\n\n  return function (_x15, _x16) {\n    return _ref6.apply(this, arguments);\n  };\n}();\n\nconstruct.assetsArray =\n/*#__PURE__*/\nfunction () {\n  var _ref7 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee7(conf, assetsArray) {\n    var path, index, string, constructedAsset;\n    return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            path = [];\n            _context7.t0 = _regeneratorRuntime.keys(assetsArray);\n\n          case 2:\n            if ((_context7.t1 = _context7.t0()).done) {\n              _context7.next = 11;\n              break;\n            }\n\n            index = _context7.t1.value;\n            string = assetsArray[index];\n            _context7.next = 7;\n            return construct.asset(conf, string);\n\n          case 7:\n            constructedAsset = _context7.sent;\n            path.push(constructedAsset);\n            _context7.next = 2;\n            break;\n\n          case 11:\n            return _context7.abrupt(\"return\", path);\n\n          case 12:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7);\n  }));\n\n  return function (_x17, _x18) {\n    return _ref7.apply(this, arguments);\n  };\n}();\n\nconstruct.buffer = function (conf, object) {\n  if (object.type === \"base64\") {\n    return Buffer.from(object.value, \"base64\");\n  } else {\n    return object.value || null;\n  }\n};\n\nconstruct.date = function (conf, string) {\n  return Date.parse(string) / 1000;\n};\n\nconstruct.memo = function (conf, memo) {\n  if (memo.type === \"base64\") {\n    return new StellarSdk.Memo(\"text\", Buffer.from(memo.value, \"base64\"));\n  } else {\n    return new StellarSdk.Memo(memo.type, memo.value);\n  }\n};\n\nconstruct.signer =\n/*#__PURE__*/\nfunction () {\n  var _ref8 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee8(conf, signer) {\n    var sdkSigner, publicKey;\n    return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            sdkSigner = {\n              weight: +signer.weight\n            };\n\n            if (!(signer.type === \"tx\")) {\n              _context8.next = 5;\n              break;\n            }\n\n            sdkSigner.preAuthTx = signer.value;\n            _context8.next = 14;\n            break;\n\n          case 5:\n            if (!(signer.type === \"hash\")) {\n              _context8.next = 9;\n              break;\n            }\n\n            sdkSigner.sha256Hash = signer.value;\n            _context8.next = 14;\n            break;\n\n          case 9:\n            if (!(signer.type === \"key\")) {\n              _context8.next = 14;\n              break;\n            }\n\n            _context8.next = 12;\n            return construct.address(conf, signer.value);\n\n          case 12:\n            publicKey = _context8.sent;\n            sdkSigner.ed25519PublicKey = publicKey;\n\n          case 14:\n            return _context8.abrupt(\"return\", sdkSigner);\n\n          case 15:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, _callee8);\n  }));\n\n  return function (_x19, _x20) {\n    return _ref8.apply(this, arguments);\n  };\n}();\n/******************************************************************************/\n\n/**\n * Provide dummy aliases for every other type for convenience & backward\n * compatibility.\n */\n\n\nspecs.types.forEach(function (type) {\n  if (!exports[type]) exports[type] = function (conf, value) {\n    return value;\n  };\n});","\"use strict\";\n/**\n * Contains the methods to encode values formatted in `transaction descriptor`\n * format into URI format.\n *\n * @private\n * @exports encode\n */\n\nrequire(\"core-js/modules/es.array.concat\");\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.array.map\");\n\nrequire(\"core-js/modules/es.date.to-string\");\n\nrequire(\"core-js/modules/es.object.to-string\");\n\nrequire(\"core-js/modules/es.regexp.exec\");\n\nrequire(\"core-js/modules/es.regexp.to-string\");\n\nrequire(\"core-js/modules/es.string.replace\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nvar encode = exports;\n\nvar decode = require(\"./decode\");\n\nvar specs = require(\"./specs\");\n\nencode.query = function (conf, tdesc) {\n  if (conf.errors) return undefined;\n  var command;\n\n  if (!tdesc.operations.length || tdesc.operations.length > 1 || tdesc.operations[0].source) {\n    command = \"transaction\";\n  } else {\n    command = tdesc.operations[0].type;\n  }\n\n  var query = \"?type=\" + command;\n  specs.transactionOptionalFields.forEach(function (field) {\n    if (tdesc[field] !== undefined) query += encode.field(conf, field, tdesc[field]);\n  });\n  tdesc.operations.forEach(function (odesc) {\n    if (command === \"transaction\") query += \"&operation=\" + odesc.type;\n\n    for (var field in odesc) {\n      if (field === \"type\") continue; // Syntactic sugar for offer deletion.\n\n      if (odesc.type === \"manageOffer\" && odesc.amount == \"0\" && odesc.offerId) {\n        if (field === \"price\" && odesc.price === \"1\") continue;\n\n        if (field === \"buying\" && odesc.buying.code === \"XLM\" && odesc.buying.issuer === specs.neutralAccountId) {\n          continue;\n        }\n      }\n\n      query += encode.field(conf, field, odesc[field]);\n    }\n  });\n  return query;\n};\n/******************************************************************************/\n\n/**\n * Encode `value` into cosmic link query format and return\n * `&${field}=${encodedValue}`\n *\n * @param {string} field\n * @param {*} value `value` should use cosmic link JSON format\n * @return {string}\n */\n\n\nencode.field = function (conf, field, value) {\n  var type = specs.fieldType[field];\n  if (!type) throw new Error(\"Invalid field: \".concat(field));\n  var encodedValue = encode.type(conf, type, value);\n  if (encodedValue === \"\" && field !== \"homeDomain\") return \"\";else return \"&\".concat(field, \"=\").concat(encodedValue);\n};\n/**\n * Encode `value` into cosmic link query format according to `type`.\n *\n * @param {string} field\n * @param {*} value `value` should use cosmic link JSON format\n * @return {string}\n */\n\n\nencode.type = function (conf, type, value) {\n  if (value === undefined) return \"\";\n  var encodedValue = process[type] ? process[type](conf, value) : value;\n  if (encodedValue === undefined) return \"\";else return encodedValue;\n};\n/******************************************************************************/\n\n\nvar process = {};\n\nprocess.asset = function (conf, asset) {\n  if (asset.issuer) return encodeURIComponent(asset.code) + \":\" + encodeURIComponent(asset.issuer);\n};\n\nprocess.assetsArray = function (conf, assetsArray) {\n  return assetsArray.map(function (asset) {\n    return encode.asset(conf, asset);\n  }).toString();\n};\n\nprocess[\"boolean\"] = function (conf, _boolean) {\n  if (_boolean === false) return \"false\";\n};\n\nprocess.buffer = function (conf, buffer) {\n  if (buffer.type === \"text\") {\n    // Guard against prefix mis-interpretation.\n    var decoded = decode.buffer(conf, buffer.value);\n    if (decoded.type === \"text\") return encodeURIComponent(buffer.value);\n  } else if (buffer) {\n    return buffer.type + \":\" + encodeURIComponent(buffer.value);\n  }\n};\n\nprocess.date = function (conf, date) {\n  return date.replace(/Z$/, \"\");\n};\n\nprocess.memo = function (conf, memo) {\n  if (memo.type === \"text\") {\n    // Guard against prefix mis-interpretation.\n    var decoded = decode.memo(conf, memo.value);\n    if (decoded.type === \"text\") return encodeURIComponent(memo.value);\n  }\n\n  return memo.type + \":\" + encodeURIComponent(memo.value);\n};\n\nprocess.price = function (conf, price) {\n  if (typeof price === \"string\") return price;else return price.n + \":\" + price.d;\n};\n\nprocess.signer = function (conf, signer) {\n  return signer.weight + \":\" + signer.type + \":\" + signer.value;\n};\n\nprocess.string = encode.buffer;\n\nprocess.url = function (conf, url) {\n  if (url.substr(0, 8) === \"https://\") url = url.substr(8);\n  return encodeURIComponent(url);\n};\n/******************************************************************************/\n\n/**\n * Provide dummy aliases for every other type for convenience & backward\n * compatibility.\n */\n\n\nspecs.types.forEach(function (type) {\n  exports[type] = function (conf, value) {\n    return encode.type(conf, type, value);\n  };\n});","\"use strict\";\n/**\n * Contains the methods to parse transactions in various format and create a\n * `CosmicLink` object out of them.\n *\n * Also contains methods to update some of the `CosmicLink` datas when it\n * require update/re-parse of part or totallity of the object.\n *\n * @private\n * @exports parse\n */\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.array.slice\");\n\nrequire(\"core-js/modules/es.regexp.exec\");\n\nrequire(\"core-js/modules/es.string.match\");\n\nrequire(\"core-js/modules/es.string.replace\");\n\nrequire(\"core-js/modules/es.string.split\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nvar parse = exports;\n\nvar check = require(\"./check\");\n\nvar convert = require(\"./convert\");\n\nvar decode = require(\"./decode\");\n\nvar expand = require(\"./expand\");\n\nvar resolve = require(\"./resolve\");\n\nvar sep7Utils = require(\"./sep7-utils\");\n\nvar status = require(\"./status\");\n/**\n * Sets cosmicLink page as the base path of `uri`.\n *\n * @param {string} page URI basename\n */\n\n\nparse.page = function (cosmicLink, uri) {\n  var page = uri.split(\"?\")[0];\n  if (page) cosmicLink.page = encodeURI(page);\n};\n/**\n * Call the right functions to setup cosmicLink depending on `options` and\n * `value` type.\n *\n * @param {*} value A transaction in any format\n * @param {Object} options Same options as {@see CosmicLink#constructor}\n */\n\n\nparse.dispatch = function (cosmicLink) {\n  var value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"?\";\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var type = guessType(value); // Strip out URL hash\n\n  switch (type) {\n    case \"uri\":\n    case \"query\":\n    case \"xdrUri\":\n    case \"sep7\":\n    case \"sep7Request\":\n      value = value.replace(/#.*$/, \"\");\n  } // Parse transaction\n\n\n  try {\n    if (parse.rule[type]) {\n      var params = parse.rule[type](cosmicLink, value, options);\n      setTdesc(cosmicLink, params.type, params.value, params.options);\n    } else {\n      setTdesc(cosmicLink, type, value, options);\n    }\n  } catch (error) {\n    if (!cosmicLink.errors) {\n      console.error(error);\n      status.error(cosmicLink, error.message);\n    }\n\n    status.fail(cosmicLink, \"Invalid \" + type);\n    if (error.tdesc) cosmicLink._tdesc = error.tdesc;\n  } // Asynchronously check SEP-0007 link.\n\n\n  if (cosmicLink.extra.originDomain) {\n    cosmicLink.verifySep7()[\"catch\"](function (error) {\n      status.error(cosmicLink, error.message);\n      status.fail(cosmicLink, \"Invalid SEP-0007 link\");\n    });\n  }\n\n  if (options.page) parse.page(cosmicLink, options.page);\n};\n/**\n * Returns `type` which is the format of transaction represented by `value`.\n */\n\n\nfunction guessType(value) {\n  var type;\n\n  if (typeof value === \"string\") {\n    var query = convert.uriToQuery(\"\", value);\n    if (value.substr(0, 12) === \"web+stellar:\") type = \"sep7\";else if (query && query.substr(0, 6) === \"?sep7=\") type = \"sep7Request\"; // DEPRECATED since 2019-09-11 / `req=` is deprecated in favor of `sep7=`.\n    else if (query && query.substr(0, 5) === \"?req=\") type = \"sep7Request\";else if (query && query.substr(0, 5) === \"?xdr=\") type = \"xdrUri\";else if (value.substr(0, 1) === \"?\") type = \"query\";else if (value.substr(0, 1) === \"{\") type = \"json\";else if (value.match(/^[a-zA-Z0-9+-=/]+$/)) type = \"xdr\";else type = \"uri\";\n  } else {\n    if (value.tx) type = \"transaction\";else type = \"tdesc\";\n  }\n\n  return type;\n}\n/******************************************************************************/\n\n/**\n * Parse-type type extension\n */\n\n\nparse.rule = {};\n/**\n * Initialize cosmicLink using `transaction`.\n */\n\nparse.rule.transaction = function (cosmicLink, transaction, options) {\n  var network = transaction._networkPassphrase;\n\n  if (network) {\n    options.network = resolve.networkName(cosmicLink, network);\n  }\n\n  return {\n    type: \"transaction\",\n    value: transaction,\n    options: options\n  };\n};\n/**\n * Initialize cosmicLink using `xdrUri`.\n */\n\n\nparse.rule.xdrUri = function (cosmicLink, xdrUri, options) {\n  parse.page(cosmicLink, xdrUri);\n  var query = convert.uriToQuery(cosmicLink, xdrUri);\n  var temp = query.split(\"&\");\n  var xdr = temp[0].substr(5);\n  temp.slice(1).forEach(function (entry) {\n    var field = entry.replace(/=.*$/, \"\");\n    var value = entry.substr(field.length + 1);\n\n    switch (field) {\n      case \"strip\":\n        switch (value) {\n          case \"source\":\n          case \"sequence\":\n          case \"signatures\":\n            options.strip = value;\n            break;\n\n          default:\n            throw new Error(\"Invalid strip directive: strip=\".concat(value));\n        }\n\n        break;\n\n      case \"network\":\n        options.network = decode.network(cosmicLink, value);\n        break;\n\n      case \"horizon\":\n      case \"callback\":\n        options[field] = decode.url(cosmicLink, value);\n        break;\n      // Backward compatibility, deprecated since the 2019-08-26.\n\n      case \"stripSignatures\":\n        options.strip = \"signatures\";\n        break;\n\n      case \"stripSequence\":\n        options.strip = \"sequence\";\n        break;\n\n      case \"stripSource\":\n        options.strip = \"source\";\n        break;\n\n      default:\n        status.error(cosmicLink, \"Unknow option: \" + entry);\n        status.fail(cosmicLink, \"Invalid query\");\n    }\n  });\n  return {\n    type: \"xdr\",\n    value: xdr,\n    options: options\n  };\n};\n/**\n * SEP-0007 parsing\n */\n\n\nparse.rule.sep7Request = sep7Utils.parseRequest;\nparse.rule.sep7 = sep7Utils.parseLink;\n/******************************************************************************/\n\n/**\n * Set cosmicLink_tdesc from format `type`. From there, the CosmicLink methods\n * can lazy-evaluate any requested format.\n */\n\nfunction setTdesc(cosmicLink, type, value, options) {\n  if (type !== \"uri\") cosmicLink[\"_\" + type] = value;\n\n  switch (type) {\n    case \"uri\":\n      parse.page(cosmicLink, value);\n      cosmicLink._query = convert.uriToQuery(cosmicLink, value, options);\n    // eslint-disable-next-line no-fallthrough\n\n    case \"query\":\n      cosmicLink._tdesc = convert.queryToTdesc(cosmicLink, cosmicLink.query, options);\n      delete cosmicLink._query;\n      break;\n\n    case \"json\":\n      value = convert.jsonToTdesc(cosmicLink, value);\n    // eslint-disable-next-line no-fallthrough\n\n    case \"tdesc\":\n      cosmicLink._tdesc = expand.tdesc(cosmicLink, value);\n      delete cosmicLink._json;\n      check.tdesc(cosmicLink, cosmicLink.tdesc);\n      break;\n\n    case \"sep7\":\n      cosmicLink._xdr = convert.sep7ToXdr(cosmicLink, cosmicLink.sep7);\n    // eslint-disable-next-line no-fallthrough\n\n    case \"xdr\":\n      cosmicLink._transaction = convert.xdrToTransaction(cosmicLink, cosmicLink.xdr, options);\n    // eslint-disable-next-line no-fallthrough\n\n    case \"transaction\":\n      cosmicLink._tdesc = convert.transactionToTdesc(cosmicLink, cosmicLink.transaction, options);\n      delete cosmicLink._sep7;\n\n      if (options.strip === \"source\" || options.strip === \"sequence\") {\n        delete cosmicLink._xdr;\n        delete cosmicLink._transaction;\n      } else if (options.strip === \"signatures\") {\n        cosmicLink.transaction.signatures = [];\n        delete cosmicLink._xdr;\n      }\n\n  }\n}","\"use_strict\";\n/**\n * Methods that expand tdesc paramaters from their query/StellarSdk format into\n * their tdesc equivalent. This allows user to pass value in the format they\n * feel the most confortable with when creating CosmicLinks.\n *\n * @private\n * @exports expand\n */\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.array.is-array\");\n\nrequire(\"core-js/modules/es.array.map\");\n\nrequire(\"core-js/modules/es.regexp.exec\");\n\nrequire(\"core-js/modules/es.string.match\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nvar expand = exports;\n\nvar Buffer = require(\"@cosmic-plus/base/es5/buffer\");\n\nvar StellarSdk = require(\"@cosmic-plus/base/es5/stellar-sdk\");\n\nvar decode = require(\"./decode\");\n\nvar destruct = require(\"./destruct\");\n\nvar normalize = require(\"./normalize\");\n\nvar specs = require(\"./specs\");\n/**\n * Replace each tdesc field value that is in query/StellarSdk format by its\n * tdesc format counterpart. This function alter the `tdesc` passed in\n * parameter.\n *\n * @param {Object} tdesc\n * @return tdesc\n */\n\n\nexpand.tdesc = function (conf, tdesc) {\n  for (var field in tdesc) {\n    if (field === \"operations\") continue;else tdesc[field] = expand.field(conf, field, tdesc[field]);\n  }\n\n  if (tdesc.operations) tdesc.operations.forEach(function (odesc) {\n    return expand.odesc(conf, odesc);\n  });\n  normalize.tdesc(conf, tdesc);\n  return tdesc;\n};\n/**\n * Replace each odesc field value that is in query/StellarSdk format by its\n * tdesc format counterpart. This function alter the `odesc` passed in\n * parameter.\n *\n * @param {Object} odesc\n * @return tdesc\n */\n\n\nexpand.odesc = function (conf, odesc) {\n  for (var field in odesc) {\n    if (field === \"type\") continue;else odesc[field] = expand.field(conf, field, odesc[field]);\n  }\n\n  normalize.odesc(conf, odesc);\n  return odesc;\n};\n/******************************************************************************/\n\n/**\n * Expands `value` to its tdesc format according to `field` type.\n *\n * @param {string} field\n * @param {string} value\n */\n\n\nexpand.field = function (conf, field, value) {\n  var type = specs.fieldType[field];\n  if (type) return expand.type(conf, type, value);else throw new Error(\"Invalid field: \".concat(field));\n};\n/**\n * Expands `value` to its tdesc format according to `type`.\n *\n * @param {string} type\n * @param {string} value\n */\n\n\nexpand.type = function (conf, type, value) {\n  if (value === null || value === undefined) return value;\n  if (typeof value === \"number\") value = value + \"\";\n  return expand[type] ? expand[type](conf, value) : value + \"\";\n};\n/******************************************************************************/\n\n\nexpand.asset = function (conf, asset) {\n  if (asset instanceof StellarSdk.Asset) return destruct.asset(conf, asset);else if (typeof asset === \"string\") return decode.asset(conf, asset);else return asset;\n};\n\nexpand.assetPath = function (conf, assetPath) {\n  if (Array.isArray(assetPath)) return assetPath.map(function (asset) {\n    return expand.asset(conf, asset);\n  });else if (typeof assetPath === \"string\") return decode.assetPath(conf, assetPath);\n};\n\nexpand.buffer = function (conf, buffer) {\n  if (!buffer) return \"\";\n  if (buffer instanceof Buffer) return destruct.buffer(conf, buffer);else if (typeof buffer === \"string\") return decode.buffer(conf, buffer);else return buffer;\n};\n\nexpand.date = function (conf, date) {\n  if (typeof date === \"number\") date = date + \"\";\n  if (!date.match(/^[0-9]*$/) || date.length < 5) return decode.date(conf, date);else return destruct.date(conf, date);\n};\n\nexpand.memo = function (conf, memo) {\n  if (memo instanceof StellarSdk.Memo) return destruct.memo(conf, memo);else if (typeof memo === \"string\") return decode.memo(conf, memo);else return memo;\n};\n\nexpand.price = function (conf, price) {\n  if (typeof price === \"string\" && price.match(/:/)) {\n    return decode.price(conf, price);\n  } else {\n    return price;\n  }\n};\n\nexpand.signer = function (conf, signer) {\n  if (signer.key) return destruct.signer(conf, signer);else if (typeof signer === \"string\") return decode.signer(conf, signer);else return signer;\n};\n\nexpand.string = function (conf, string) {\n  if (typeof string === \"number\") return string + \"\";else return string;\n};\n/******************************************************************************/\n\n/**\n * Provide dummy aliases for every other type for convenience & backward\n * compatibility.\n */\n\n\nspecs.types.forEach(function (type) {\n  if (!exports[type]) {\n    exports[type] = function (conf, value) {\n      if (typeof value === \"number\") return value + \"\";else return value;\n    };\n  }\n});","\"use strict\"\n/**\n * History - Generic history data abstraction\n */\nconst global = require(\"./global\")\n\n/**\n * Definition\n */\n\nclass History extends Array {}\n\n/**\n * Caching\n */\n\nHistory.setCache = function (key, history) {\n  const json = JSON.stringify({ [global.currency]: history })\n  localStorage[`history:${key}`] = json\n}\n\nHistory.getCache = function (key) {\n  const json = localStorage[`history:${key}`]\n  if (json) return JSON.parse(json)[global.currency]\n}\n\n/**\n * Utilities\n */\n\nHistory.cut = function (history, length) {\n  const diff = history.length - length\n  if (diff > 0) history.splice(0, diff)\n}\n\nHistory.latest = function (history) {\n  return history[history.length - 1]\n}\n\nHistory.join = function (oldData, newData) {\n  const start = newData[0].time\n  const index = oldData.findIndex(day => day.time === start)\n  return oldData.slice(0, index).concat(newData)\n}\n\n/**\n * Time Calculations\n */\n\nHistory.oneDay = 24 * 60 * 60 * 1000\n\nHistory.today = function () {\n  return History.roundTime(new Date())\n}\n\nHistory.roundTime = function (time) {\n  const date = new Date(time)\n  date.setUTCHours(0, 0, 0, 0)\n  return +date\n}\n\nHistory.time = function (time) {\n  return +new Date(time)\n}\n\nHistory.missingDays = function (history) {\n  return History.numberToDays(History.today() - History.latest(history).time)\n}\n\nHistory.numberToDays = function (number) {\n  return number / History.oneDay\n}\n\n/**\n * Export\n */\nmodule.exports = History\n","\"use strict\"\n/**\n * Orderbook class\n */\n\nconst cosmicLib = require(\"cosmic-lib\")\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\nconst StellarSdk = require(\"@cosmic-plus/base/es5/stellar-sdk\")\nconst { timeout } = require(\"@cosmic-plus/jsutils/es5/misc\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst { fixed7 } = require(\"../helpers/misc\")\n\nconst Orderbook = module.exports = class Orderbook extends Projectable {\n  static forBalance (balance, quote) {\n    if (balance.asset === quote) return\n\n    const orderbook = new Orderbook({ balance, quote })\n    orderbook.streamOffers()\n\n    return orderbook\n  }\n\n  static forAsset (asset) {\n    return new Orderbook({ asset })\n  }\n\n  constructor (params) {\n    super()\n\n    if (params.balance) {\n      this.type = \"native\"\n      this.balance = params.balance\n      this.base = params.balance.asset\n      this.quote = params.quote\n      this.name = `${this.base.code}/${this.quote.code}`\n      this.offersCallBuilder = Orderbook.offersCallBuilder(this.balance)\n\n      this.watch(this.quote, \"price\", () => this.updateOffersPrices())\n    } else if (params.asset) {\n      this.type = \"agregated\"\n      this.base = params.asset\n      this.name = `${this.base.code} (${__(\"Agregated\")})`\n      this.childs = []\n    }\n\n    this.watch(this.base, \"globalPrice\", () => this.compute(\"price\"))\n  }\n\n  static offersCallBuilder (balance) {\n    const baseAsset = new StellarSdk.Asset(balance.code, balance.anchor.pubkey)\n    const quoteAsset = StellarSdk.Asset.native()\n    const server = cosmicLib.resolve.server()\n    return server.orderbook(baseAsset, quoteAsset)\n  }\n\n  async streamOffers () {\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n      await this.getOffers()\n      await timeout(15000)\n    }\n  }\n\n  async getOffers () {\n    try {\n      const offers = await this.offersCallBuilder.limit(200).call()\n      this.ingest(offers)\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  ingest (offers) {\n    if (!areOffersEquals(this.bids, offers.bids)) {\n      this.bids = normalizeOffers(offers.bids, this.quote, this.balance, \"bids\")\n    }\n    if (!areOffersEquals(this.asks, offers.asks)) {\n      this.asks = normalizeOffers(offers.asks, this.quote, this.balance, \"asks\")\n    }\n  }\n\n  updateOffersPrices () {\n    if (this.bids) {\n      this.set(\"bids\", updateOffersPrices(this.bids, this.quote))\n    }\n    if (this.asks) {\n      this.set(\"asks\", updateOffersPrices(this.asks, this.quote))\n    }\n  }\n\n  mergeOffers (side) {\n    if (this.childs.length < 2) {\n      this.set(side, this.childs[0] && this.childs[0][side])\n      return\n    }\n\n    /// Merge order books\n    const merged = this.childs.reduce((merged, child) => {\n      return child[side] ? merged.concat(child[side]) : merged\n    }, [])\n    if (!merged.length) {\n      this[side] = null\n      return\n    }\n\n    const sortOffers =\n      side === \"bids\"\n        ? (a, b) => b.price - a.price\n        : (a, b) => a.price - b.price\n\n    /// Update volumes.\n    let volume = 0,\n      baseVolume = 0,\n      quoteVolume = 0\n    this.set(\n      side,\n      merged.sort(sortOffers).map(row => {\n        const mergedRow = Object.assign({}, row)\n        mergedRow.volume = volume += fixed7(row.amount * row.price)\n        mergedRow.baseVolume = baseVolume += +row.amount\n        mergedRow.quoteVolume = quoteVolume += +row.quoteAmount\n        return mergedRow\n      })\n    )\n  }\n\n  addChild (orderbook) {\n    this.childs.push(orderbook)\n    this.watch(orderbook, \"bids\", () => this.mergeOffers(\"bids\"))\n    this.watch(orderbook, \"asks\", () => this.mergeOffers(\"asks\"))\n  }\n}\n\nOrderbook.define(\"bestBid\", \"bids\", function () {\n  return this.bids && this.bids[0] && this.bids[0].price\n})\nOrderbook.define(\"bestAsk\", \"asks\", function () {\n  return this.asks && this.asks[0] && this.asks[0].price\n})\nOrderbook.define(\"midpoint\", [\"bestBid\", \"bestAsk\"], function () {\n  return (this.bestBid + this.bestAsk) / 2\n})\nOrderbook.define(\"price\", [\"midpoint\"], function () {\n  if (this.base.globalPrice) return this.midpoint\n  else return this.marketPrice()\n})\nOrderbook.define(\"spread\", [\"bestBid\", \"bestAsk\"], function () {\n  return this.bestAsk - this.bestBid\n})\nOrderbook.define(\"spread%\", [\"spread\", \"midpoint\"], function () {\n  return 100 * this.spread / this.midpoint\n})\n\n/**\n * Utilities\n */\n\n/**\n * Returns whether or not an orderbook offers has been fetched at least once.\n * Agregated orderbooks return `true` only when each child orderbook has been\n * fetched.\n */\nOrderbook.prototype.isFetched = function () {\n  if (this.childs) {\n    return this.childs.reduce((and, child) => and && child.isFetched(), true)\n  } else {\n    return this.asks != null && this.bids != null\n  }\n}\n\n/**\n * Look for the best first offer in **orderbook** **side** that match **filter**\n * (if provided) among child orderbooks.\n *\n * @param  {Orderbook} orderbook [description]\n * @param  {String}    side      `bids` or `asks`\n * @param  {Function}  [filter]  A filter that is passed by the returned offer\n * @return {Object}    An orderbook offer\n */\nOrderbook.prototype.findOffer = function (side, filter) {\n  const offers = this[side]\n  const childsNum = this.childs ? this.childs.length : 1\n  const anchors = {}\n\n  let last\n  for (let index in offers) {\n    const offer = offers[index]\n    if (filter && !filter(offer)) continue\n    const anchor = offer.balance.anchor.pubkey\n    if (!anchors[anchor]) {\n      anchors[anchor] = true\n      last = offer\n    }\n    if (Object.keys(anchors).length === childsNum) break\n  }\n  return last\n}\n\nOrderbook.prototype.findAsk = function (filter) {\n  return this.findOffer(\"asks\", filter)\n}\nOrderbook.prototype.findBid = function (filter) {\n  return this.findOffer(\"bids\", filter)\n}\n\n/**\n * Returns the price of asset at **depth** XLM of orderbook's **side**.\n *\n * @param  {String} [side=\"bids\"] Either \"bids\" or \"asks\"\n * @param  {Number} [depth] The depth to look at, in term of XLM\n * @return {Number} Offer price at requested depth\n */\nOrderbook.prototype.marketPrice = function (side = \"bids\", depth = 50) {\n  const offer = this.findOffer(side, offer => offer.quoteVolume > depth)\n  return offer ? offer.price : 0\n}\n\n/**\n * Helpers\n */\n\nfunction areOffersEquals (array1, array2) {\n  if (!array1) return false\n  if (array1.length !== array2.length) return false\n  for (let index in array1.length) {\n    if (array1[index].amount !== array2[index].amount) return false\n    if (array1[index].price !== array2[index].price) return false\n  }\n  return true\n}\n\nfunction normalizeOffers (offers, quote, balance, side) {\n  offers.forEach(row => {\n    row.volume = undefined\n    row.baseVolume = undefined\n    row.basePrice = +row.price\n    row.quoteAmount = +row.amount\n    row.quoteVolume = undefined\n    row.balance = balance\n    row.side = side\n  })\n  return updateOffersPrices(offers, quote)\n}\n\nfunction updateOffersPrices (offers, quote) {\n  let volume = 0,\n    quoteVolume = 0,\n    baseVolume = 0\n  offers.forEach(row => {\n    if (row.side === \"asks\") {\n      row.quoteAmount = fixed7(row.amount * row.basePrice)\n    } else {\n      row.amount = fixed7(row.quoteAmount / row.basePrice)\n    }\n    row.price = fixed7(row.basePrice * quote.price)\n    row.volume = volume += fixed7(row.amount * row.price)\n    row.baseVolume = baseVolume += +row.amount\n    row.quoteVolume = quoteVolume += +row.quoteAmount\n  })\n  return offers\n}\n","\"use_strict\";\n/**\n * **Loopcall** is a tiny library that enables unlimited complex queries to\n * Horizon nodes. It takes a _CallBuilder_ and accepts a few optional\n * parameters. It returns an array of records similar to the ones returned by\n * `CallBuilder.call()`.\n *\n *  @module\n */\n\n/**\n * **Fetch more than 200 records**\n *\n * To get an arbitrary amount of record:\n *\n * ```js\n * const callBuilder = server.operations().order(\"asc\")\n * const the2000FirstOperations = await loopcall(callBuilder, { limit: 2000 })\n * ```\n *\n * To get all existing records (take care with that one!):\n *\n * ```js\n * const callBuilder = server.transactions().forAccount(\"GDE...YBX\")\n * const allTransactions = await loopcall(callBuilder)\n * ```\n *\n * **Conditional Break**\n *\n * To stop fetching records when a condition is met:\n *\n * ```js\n * const callBuilder = server.transactions().forAccount(\"GDE...YBX\")\n * const thisYearTransactions = await loopcall(callBuilder, {\n *   breaker: record => record.created_at.substr(0, 4) < 2018\n * })\n * ```\n *\n * `breaker` is a _Function_ that is called over each fetched record. Once it\n * returns `true`, the fetching loop breaks and the record that triggered the\n * break is discarded.\n *\n * **Conditional Filtering**\n *\n * To filter records by condition:\n *\n * ```js\n * const callBuilder = server.transactions().forAccount(\"GDE...YBX\")\n * const transactionsWithoutMemo = await loopcall(callBuilder, {\n *   filter: record => !record.memo\n * })\n * ```\n *\n * `filter` is a _Function_ that is called over each fetched record. When\n * provided, the records are added to the query results only when it returns\n * `true`.\n *\n * **Iterating over records on-the-fly**\n *\n * In some situations waiting for the result to be concatenated is not an\n * option. `breaker` offers the possibility of iterating over records while they\n * are fetched:\n *\n * ```js\n * const callBuilder = server.transactions()\n *\n * async function showTxUntilScreenIsFilled(record) {\n *   displayTxUsingRecord(record)\n *   await endOfPageReached()\n * }\n *\n * loopcall(callBuilder, { breaker: showTxUntilScreenIsFilled })\n * ```\n *\n * This example shows a part of the code to implement unlimited scrolling on a\n * webpage showing the last transactions on a Stellar network. As\n * `showTxUntilScreenIsFilled` never returns `true`, the loop never breaks.\n *\n * **Combining parameters**\n *\n * All those parameters may be combined together:\n *\n * ```js\n * const callBuilder = server.operations().order(\"asc\")\n *\n * function iterateOver1000RecordsMax() {\n *   let counter = 0\n *   return function() {\n *     counter++\n *     if (counter > 1000) return true\n *   }\n * }\n *\n * const the20firstAccountCreations = await loopcall(callBuilder, {\n *   limit: 20,\n *   breaker: iterateOver1000RecordsMax(),\n *   filter: record => record.type === \"create_account\"\n * })\n * ```\n *\n * When both are provided, `breaker` is called before `filter`.\n *\n * @alias loopcall\n * @param {CallBuilder} callBuilder A CallBuilder object\n * @param {Object} [options]\n * @param {Integer} [options.limit] The maximum number of record to return\n * @param {Function} [options.filter] A function that accepts a record argument.\n * It is called with each fetched record. If it returns a true value, the record\n * is added to returned records, else it is discarded.\n * @param {Function} [options.breaker] A function that accepts a record\n * argument. It is called with each fetched record. If it returns a true value,\n * the loop ends and the array of the filtered records is returned.\n * @returns {Array} The fetched records\n */\n\nrequire(\"core-js/modules/es.array.concat\");\n\nrequire(\"core-js/modules/es.array.filter\");\n\nrequire(\"core-js/modules/es.array.iterator\");\n\nrequire(\"core-js/modules/es.array.slice\");\n\nrequire(\"core-js/modules/es.object.to-string\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator\");\n\nvar _regeneratorRuntime = require(\"@babel/runtime/regenerator\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator = require(\"@babel/runtime/helpers/asyncToGenerator\");\n\nmodule.exports =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(callBuilder) {\n    var options,\n        callerLimit,\n        callAnswer,\n        _args = arguments;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};\n            callerLimit = options.limit ? Math.min(options.limit, 200) : 200;\n            _context.next = 4;\n            return callBuilder.limit(callerLimit).call();\n\n          case 4:\n            callAnswer = _context.sent;\n\n            if (!(options.filter || options.breaker)) {\n              _context.next = 9;\n              break;\n            }\n\n            return _context.abrupt(\"return\", loopWithBreakpoints(callAnswer, options));\n\n          case 9:\n            return _context.abrupt(\"return\", loop(callAnswer, options.limit));\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n/**\n * Concatenate records from `callAnswer` pages until `limit` is reached or no\n * more are available.\n *\n * @private\n * @param {Object} callAnswer A resolved CallBuilder.call() object\n * @param {integer} limit The maximum number of record to return\n * @returns {Array} The fetched records\n */\n\n\nfunction loop(_x2, _x3) {\n  return _loop.apply(this, arguments);\n}\n/**\n * Concatenate records from `callAnswer` pages that pass `options.filter` until\n * `options.limit` is reached, `options.breaker` returns a true value or no more\n * are available.\n *\n * @private\n * @param {Object} callAnswer A resolved CallBuilder.call() object\n * @param {Object} [options]\n * @param {integer} [options.limit] The maximum number of record to return\n * @param {function} [options.filter] A function that accept a record argument. It\n *   is called with each fetched record. If it returns a true value, the record\n *   is added to returned records, else it is discarded.\n * @param {function} [options.breaker] A function that accept a record argument.\n *   It is called with each fetched record. If it returns a true value, the loop\n *   ends and the array of the filtered records is returned.\n * @returns {Array} The fetched records\n */\n\n\nfunction _loop() {\n  _loop = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2(callAnswer, limit) {\n    var records, length, splitAt, tailRecords;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            records = [];\n\n          case 1:\n            if (!callAnswer.records.length) {\n              _context2.next = 18;\n              break;\n            }\n\n            if (!limit) {\n              _context2.next = 12;\n              break;\n            }\n\n            length = records.length + callAnswer.records.length;\n\n            if (!(limit === length)) {\n              _context2.next = 8;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", records.concat(callAnswer.records));\n\n          case 8:\n            if (!(length > limit)) {\n              _context2.next = 12;\n              break;\n            }\n\n            splitAt = limit - records.length;\n            tailRecords = callAnswer.records.slice(0, splitAt);\n            return _context2.abrupt(\"return\", records.concat(tailRecords));\n\n          case 12:\n            records = records.concat(callAnswer.records);\n            _context2.next = 15;\n            return callAnswer.next();\n\n          case 15:\n            callAnswer = _context2.sent;\n            _context2.next = 1;\n            break;\n\n          case 18:\n            return _context2.abrupt(\"return\", records);\n\n          case 19:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _loop.apply(this, arguments);\n}\n\nfunction loopWithBreakpoints(_x4, _x5) {\n  return _loopWithBreakpoints.apply(this, arguments);\n}\n\nfunction _loopWithBreakpoints() {\n  _loopWithBreakpoints = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee3(callAnswer, options) {\n    var records, index, nextRecord, recordTriggerBreak, recordPassTest;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            records = [];\n\n          case 1:\n            if (!callAnswer.records.length) {\n              _context3.next = 28;\n              break;\n            }\n\n            _context3.t0 = _regeneratorRuntime.keys(callAnswer.records);\n\n          case 3:\n            if ((_context3.t1 = _context3.t0()).done) {\n              _context3.next = 23;\n              break;\n            }\n\n            index = _context3.t1.value;\n\n            if (!(options.limit && records.length === options.limit)) {\n              _context3.next = 7;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", records);\n\n          case 7:\n            nextRecord = callAnswer.records[index];\n\n            if (!options.breaker) {\n              _context3.next = 14;\n              break;\n            }\n\n            _context3.next = 11;\n            return options.breaker(nextRecord);\n\n          case 11:\n            recordTriggerBreak = _context3.sent;\n\n            if (!recordTriggerBreak) {\n              _context3.next = 14;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", records);\n\n          case 14:\n            if (!options.filter) {\n              _context3.next = 20;\n              break;\n            }\n\n            _context3.next = 17;\n            return options.filter(nextRecord);\n\n          case 17:\n            recordPassTest = _context3.sent;\n\n            if (recordPassTest) {\n              _context3.next = 20;\n              break;\n            }\n\n            return _context3.abrupt(\"continue\", 3);\n\n          case 20:\n            records.push(nextRecord);\n            _context3.next = 3;\n            break;\n\n          case 23:\n            _context3.next = 25;\n            return callAnswer.next();\n\n          case 25:\n            callAnswer = _context3.sent;\n            _context3.next = 1;\n            break;\n\n          case 28:\n            return _context3.abrupt(\"return\", records);\n\n          case 29:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n  return _loopWithBreakpoints.apply(this, arguments);\n}","\"use strict\"\n/**\n * Overlay that prevent user interaction\n */\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst { timeout } = require(\"@cosmic-plus/jsutils/es5/misc\")\n\n/**\n * Definition\n */\n\nclass ClickWall {\n  constructor (params = {}) {\n    this.domNode = html.create(\"div\", {\n      className: \"ClickWall\",\n      onclick: () => this.click(),\n      hidden: true\n    })\n\n    Object.assign(this.domNode.style, ClickWall.style)\n    document.body.insertBefore(this.domNode, document.body.firstChild)\n\n    this.onclick = params.onclick\n    this.scrollbar = params.scrollbar\n    this.opacity = params.opacity\n    this.delay = params.delay || ClickWall.delay\n  }\n\n  click () {\n    if (this.isEnabled && this.onclick) this.onclick()\n  }\n\n  async enable () {\n    // Scrollbar hidding.\n    if (this.scrollbar === \"hide\") {\n      this.htmlOverflow = document.documentElement.style.overflow\n      this.bodyOverflow = document.body.style.overflow\n      document.documentElement.style.overflow = \"hidden\"\n      document.body.style.overflow = \"hidden\"\n    }\n\n    // Fade in.\n    html.show(this.domNode)\n    if (this.opacity) await this.setOpacity(this.opacity)\n    this.isEnabled = true\n  }\n\n  async disable () {\n    // Handle scrollbar hidding.\n    if (this.scrollbar === \"hide\") {\n      document.documentElement.style.overflow = this.htmlOverflow\n      document.body.style.overflow = this.bodyOverflow\n    }\n\n    // Fade out.\n    this.isEnabled = false\n    if (this.opacity) await this.setOpacity(0)\n    html.hide(this.domNode)\n  }\n\n  async destroy () {\n    await this.disable()\n    html.destroy(this.domNode)\n  }\n\n  async setOpacity (opacity = this.opacity) {\n    await timeout(0)\n    Object.assign(this.domNode.style, {\n      transition: `background ${this.delay}ms`,\n      background: `rgba(0, 0, 0, ${opacity})`\n    })\n    return timeout(this.delay)\n  }\n}\n\n/**\n * Configuration\n */\n\nClickWall.delay = 500\n\nClickWall.style = {\n  position: \"fixed\",\n  zIndex: 999,\n  top: 0,\n  width: \"100%\",\n  height: \"100%\"\n}\n\n/**\n * Export\n */\nmodule.exports = ClickWall\n","\"use strict\"\n/**\n * form.js  Generate formulary with ease\n *\n * Differences with ordinary interface:\n *\n * - Form request is sent only if `method=\"get\"` or `method=\"post\"` is\n *   explicitely set.\n * - Form inputs are `required` by default.\n * - Select control is renamed selector (verbs are reserved).\n */\n\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\nconst hiddenKey = require(\"@cosmic-plus/jsutils/es5/misc\").setHiddenProperty\n\nconst bindDomKey = require(\"./bind-dom-key\")\nconst handleExtraAttributes = require(\"./handle-extra-attributes\")\nconst html = require(\"./html-extra\")\n\n/**\n * Definition\n */\n\nclass Form extends Projectable {\n  /**\n   * Two forms:\n   *\n   * * new Form($form, attributes)\n   * * new Form([attributes], ...childs)\n   */\n  constructor (...params) {\n    super()\n\n    // Import or create the form DOM node.\n    if (params.length && params[0].tagName === \"FORM\") {\n      hiddenKey(this, \"domNode\", params[0])\n      if (params[1]) Object.assign(this.domNode, params[1])\n    } else {\n      hiddenKey(this, \"domNode\", html.element(\"form\", ...params))\n    }\n\n    // Validation - request is sent only if a method is explicitely set.\n    this.domNode.addEventListener(\"submit\", () => {\n      const method = this.domNode.getAttribute(\"method\")\n      if (!method) event.preventDefault()\n      this.trigger(\"submit\")\n    })\n\n    // Bind values\n    Form.bindInputs(this, this.domNode)\n    hiddenKey(this, \"dom\", handleExtraAttributes(this.domNode))\n\n    // Add message box if none exists.\n    if (!this.dom.status) {\n      this.dom.status = [Form.status()]\n      html.append(this.domNode, this.dom.status[0])\n    }\n  }\n\n  /**\n   * Controls\n   */\n\n  submit () {\n    this.domNode.submit()\n  }\n\n  reset () {\n    this.domNode.reset()\n  }\n\n  /**\n   * Status Display\n   */\n\n  report (type, ...content) {\n    const $status = this.dom.status[0]\n    if ($status) {\n      $status.className = type\n      html.rewrite($status, ...content)\n    }\n  }\n\n  info (content) {\n    this.report(\"info\", content, Form.spinner())\n  }\n\n  error (content) {\n    // Extract message from Error object. (TODO: handle it in html)\n    this.report(\"error\", content.message || content)\n    if (content instanceof Error) throw content\n    else throw new Error(content)\n  }\n}\n\n// Automatically clean report on user input.\nForm.listen(\"change\", event => event.report(null))\n\n/**\n * Binding\n */\n\nForm.bindInputs = function (object, $node) {\n  html.walk($node, binder, object)\n}\n\nfunction binder ($node, object) {\n  if ($node.name) bindDomKey(object, $node.name, $node)\n}\n\n/**\n * Helpers (Actions)\n */\n\nForm.enable = function (element, attributes) {\n  element.disabled = false\n  Object.assign(element, attributes)\n}\n\nForm.disable = function (element, attributes) {\n  element.enabled = true\n  Object.assign(element, attributes)\n}\n\nForm.hide = html.hide\nForm.show = html.show\n\n/**\n * Elements\n */\n\nForm.element = html.element\n\nForm.status = function (message = \"\") {\n  return Form.element(\"p\", { alias: \"status\" }, message)\n}\n\nForm.spinner = function () {\n  return Form.element(\"span\", { className: \"spinner\" })\n}\n\nForm.label = function (...params) {\n  return Form.element(\"label\", ...params)\n}\n\nForm.button = function (params, ...childs) {\n  if (!childs.length) childs = [params.value]\n  return Form.element(\"button\", params, ...childs)\n}\n\nForm.control = function (tag, params) {\n  const defaults = { required: true }\n  const attributes = Object.assign(defaults, params)\n  return Form.element(tag, attributes)\n}\n\nForm.textarea = function (params) {\n  return Form.control(\"textarea\", params)\n}\n\nForm.selector = function (params) {\n  const selector = Form.control(\"select\", params)\n  if (selector.values) {\n    html.append(selector, ...makeOptions(selector.values))\n  }\n  if (selector.placeholder) {\n    const placeholder = html.element(\n      \"option\",\n      { value: \"\", disabled: true, selected: true, hidden: true },\n      selector.placeholder\n    )\n    html.unshift(selector, placeholder)\n    if (params.selectedIndex != null) params.selectedIndex++\n  }\n\n  if (params.selectedIndex) selector.selectedIndex = params.selectedIndex\n  else if (params.value) selector.value = params.value\n\n  return selector\n}\n\nForm.input = function (type, params = {}) {\n  const input = Form.control(\"input\", params)\n  input.type = type\n  return input\n}\n\n// Exclude: button, datetime-local, reset, submit, select, search (no verbs)\nconst inputTypes = [\n  \"checkbox\",\n  \"color\",\n  \"date\",\n  \"email\",\n  \"file\",\n  \"hidden\",\n  \"image\",\n  \"month\",\n  \"number\",\n  \"password\",\n  \"radio\",\n  \"range\",\n  \"tel\",\n  \"text\",\n  \"time\",\n  \"url\",\n  \"week\"\n]\n\ninputTypes.forEach(type => Form[type] = params => Form.input(type, params))\nForm.datetime = params => Form.input(\"datetime-local\", params)\n\n/**\n * Elements Helpers\n */\n\nfunction makeOptions (object) {\n  if (object instanceof Array) {\n    return object.map(value => {\n      return html.element(\"option\", { value }, value)\n    })\n  } else {\n    return Object.keys(object).map(value => {\n      return html.element(\"option\", { value }, object[value])\n    })\n  }\n}\n\n/**\n * Export\n */\n\nmodule.exports = Form\n","\"use strict\"\n/**\n * Additional methods for html.\n */\nconst html = Object.create(require(\"@cosmic-plus/domutils/es5/html\"))\nmodule.exports = html\n\n/**\n * Creates an new HTML element.\n */\nhtml.element = function (tag, ...params) {\n  let attributes\n  if (\n    params[0]\n    && params[0].constructor === Object\n    && params[0].domNode === undefined\n  ) {\n    attributes = params.shift()\n  }\n\n  return html.create(tag, attributes, ...params)\n}\n\n/**\n * Walks **element** dom tree, applying **func** to each node.\n */\nhtml.walk = function (element, func, ...params) {\n  func(element, ...params)\n  element.childNodes.forEach(child => html.walk(child, func, ...params))\n}\n\n/**\n * Add **...children** as first **parent** children.\n */\nhtml.unshift = function (parent, ...children) {\n  for (let i = 0; i < children.length; i++) {\n    parent.insertBefore(children[i], parent.childNodes[i])\n  }\n}\n","\"use strict\"\n/**\n * Dialog\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst Modal = require(\"./modal\")\n\n/**\n * Definition\n */\n\nclass Dialog extends Gui {\n  constructor (params = {}) {\n    const { title, content, actions } = params\n\n    super(`\n<form class=\"Dialog\" onsubmit=\"return false\">\n\n  <h3>%title</h3>\n\n  <hr hidden=%hasNoTitle>\n\n  %content\n\n  <hr hidden=%hasNoContent>\n\n  <div class=\"Actions\">\n    %toButton:actions...\n  </div>\n</form>\n    `)\n\n    this.title = title\n    this.content = typeof params === \"string\" ? params : content\n    this.actions = actions\n\n    this.hasNoTitle = !this.title\n    this.hasNoContent = !this.content\n  }\n\n  toButton ([name, onclick, type = \"button\"]) {\n    return html.create(\"button\", { type, onclick: onclick.bind(this) }, name)\n  }\n}\n\n/**\n * Utilities\n */\n\nDialog.alert = function (params = {}) {\n  const dialog = new Dialog(params)\n  const modal = new Modal({ content: dialog })\n  dialog.actions = [[__(\"OK\"), () => modal.close()]]\n\n  modal.open()\n  return new Promise(resolve => modal.listen(\"close\", resolve))\n}\n\nDialog.confirm = function (params = {}) {\n  const dialog = new Dialog(params)\n  const modal = new Modal({ content: dialog })\n\n  const promise = new Promise(resolve => {\n    modal.listen(\"close\", () => resolve(false))\n    dialog.actions = [\n      [__(\"OK\"), () => resolve(true), \"submit\"],\n      [__(\"Cancel\"), () => resolve(false)]\n    ]\n  })\n  promise.finally(() => modal.close())\n\n  modal.open()\n  const el = dialog.domNode.querySelector(\"[autofocus]\")\n  if (el) el.focus()\n\n  return promise\n}\n\n/**\n * Export\n */\nmodule.exports = Dialog\n","\"use strict\";\n/**\n * Exports parsed query string parameters. If the same parameter is defined\n * twice, the last value is exported.\n *\n * @exports params\n */\n\nrequire(\"core-js/modules/es.array.concat\");\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.object.keys\");\n\nrequire(\"core-js/modules/es.regexp.exec\");\n\nrequire(\"core-js/modules/es.string.search\");\n\nrequire(\"core-js/modules/es.string.split\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nvar params = module.exports;\n\nvar misc = require(\"@cosmic-plus/jsutils/es5/misc\");\n\nvar hiddenKey = misc.setHiddenProperty;\n\nif (location.search) {\n  var vars = location.search.substr(1).split(\"&\");\n  vars.forEach(function (entry) {\n    var field = entry.split(\"=\", 1)[0];\n    var value = entry.substr(field.length + 1);\n    params[field] = decodeURIComponent(value);\n  });\n}\n\nhiddenKey(params, \"$set\", function (obj) {\n  Object.keys(obj).forEach(function (key) {\n    var value = obj[key];\n    if (value == null) delete params[key];else params[key] = value;\n  });\n  writeQuery();\n});\n\nfunction writeQuery() {\n  var query = \"\";\n\n  for (var field in params) {\n    query += \"&\".concat(field, \"=\").concat(encodeURIComponent(params[field]));\n  }\n\n  query = \"?\" + query.substr(1);\n  if (location.hash) query += location.hash;\n  history.replaceState(\"\", null, query);\n}","\"use strict\"\n/**\n * Compute portfolio data from Account object.\n */\nconst axios = require(\"@cosmic-plus/base/es5/axios\")\nconst cosmicLib = require(\"cosmic-lib\")\nconst Mirrorable = require(\"@cosmic-plus/jsutils/es5/mirrorable\")\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\nconst { timeout } = require(\"@cosmic-plus/jsutils/es5/misc\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst Asset = require(\"./asset\")\nconst Balance = require(\"./balance\")\nconst global = require(\"./global\")\nconst Offers = require(\"./offers\")\n\nconst portfolioHistoricValue = require(\"./portfolio-historic-value\")\n\nconst {\n  arrayContains,\n  arrayRemove,\n  arraySum,\n  arrayOnlyInFirst\n} = require(\"../helpers/misc\")\n/**\n * Class\n */\n\nclass Portfolio extends Projectable {\n  static async resolve (address) {\n    await checkNetwork()\n\n    const destination = await cosmicLib.resolve.address(address)\n    if (destination.memo)\n      throw new Error(__(\"Invalid federated address: shared account.\"))\n    if (await cosmicLib.resolve.isAccountEmpty(destination.account_id))\n      throw new Error(__(\"Empty account\"))\n\n    const portfolio = new Portfolio(destination.account_id)\n    cosmicLib.config.source = portfolio.address = address\n    portfolio.streamAccount()\n\n    return portfolio\n  }\n\n  constructor (accountId) {\n    super()\n\n    // eslint-disable-next-line no-console\n    console.log(this)\n\n    this.accountId = accountId\n    this.assets = new Mirrorable()\n    this.balances = new Mirrorable()\n    this.accountCallBuilder = Portfolio.accountCallBuilder(accountId)\n\n    this.define(\"total\", \"assets\", () => {\n      const assets = this.assets.filter(asset => asset.isSupported)\n      return arraySum(assets, \"value\")\n    })\n    this.assets.mirror(asset =>\n      this.watch(asset, [\"value\", \"isSupported\"], () => this.compute(\"total\"))\n    )\n\n    this.new = true\n  }\n\n  static accountCallBuilder (accountId) {\n    const server = cosmicLib.resolve.server()\n    return server.accounts().accountId(accountId)\n  }\n\n  async streamAccount () {\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n      await this.getAccount()\n      await timeout(5000)\n    }\n  }\n\n  async getAccount () {\n    try {\n      const account = await this.accountCallBuilder.call()\n      this.ingest(account)\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  async ingest (account) {\n    this.account = account\n\n    for (let index in account.balances) {\n      const balance = Balance.ingest(account.balances[index])\n      this.maybeAddBalance(balance)\n\n      if (balance.id === \"XLM\") {\n        balance.asset.amountMin = Portfolio.accountMinimumBalance(account)\n      }\n    }\n\n    if (this.new) {\n      delete this.new\n      await Asset.refreshPrices()\n      this.offers = Offers.forPortfolio(this)\n      await this.offers.stream()\n      this.trigger(\"open\")\n      Asset.getAllInfo()\n    }\n  }\n\n  maybeAddBalance (balance) {\n    if (!arrayContains(this.balances, balance)) {\n      this.balances.push(balance)\n      balance.asset.maybeAddBalance(balance)\n    }\n    this.maybeAddAsset(balance.asset)\n  }\n\n  maybeAddAsset (asset) {\n    if (arrayContains(this.assets, asset)) return\n\n    this.assets.push(asset)\n    asset.watch(this, \"total\", () => asset.compute(\"share\"))\n    asset.getInfo()\n  }\n\n  maybeRemoveBalance (balance) {\n    arrayRemove(this.balances, balance)\n    balance.asset.maybeRemoveBalance(balance)\n    this.maybeRemoveAsset(balance.asset)\n  }\n\n  maybeRemoveAsset (asset) {\n    if (asset.balances.length) return\n    // TODO: unwatch\n    arrayRemove(this.assets, asset)\n  }\n}\n\n/**\n * Utilities\n */\n\n/**\n * Returns the minimum XLM balance for an account. It includes the mandatory\n * network reserve, the required amount to support 1 open offer for each\n * trustline, and an additional 0.5 Lumens to cover for fees & algorithm\n * rounding issues.\n */\nPortfolio.accountMinimumBalance = function (account) {\n  const baseReserve = 0.5\n\n  let entries = (account.balances.length - 1) * 2 // Reserve an offer entry\n  entries += Object.keys(account.data_attr).length\n  entries += account.signers.length - 1\n\n  return (3 + entries) * baseReserve\n}\n\n/**\n * List known assets for which account doesn't have any trustline.\n */\nPortfolio.prototype.availableAssets = function () {\n  const allAssets = Object.values(Asset.table)\n  return arrayOnlyInFirst(allAssets, this.assets)\n}\n\n/**\n * Download & compute portfolio history.\n */\nPortfolio.prototype.getHistory = async function () {\n  if (!this.history) this.history = await portfolioHistoricValue(this)\n  return this.history\n}\n\n/**\n * Extension\n */\n\nAsset.define(\"share\", \"value\", function () {\n  return global.portfolio && this.value / global.portfolio.total\n})\n\n/**\n * Helpers\n */\n\nasync function checkNetwork () {\n  const horizon = cosmicLib.resolve.horizon()\n  try {\n    await axios.get(horizon)\n  } catch (error) {\n    throw new Error(__(\"Can't connect to the Stellar blockchain\"))\n  }\n}\n\n/**\n * Export\n */\nmodule.exports = Portfolio\n","\"use_strict\";\n\nrequire(\"core-js/modules/es.array.concat\");\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.array.splice\");\n\nrequire(\"core-js/modules/es.object.assign\");\n\nrequire(\"core-js/modules/es.object.to-string\");\n\nrequire(\"core-js/modules/es.promise\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nvar _regeneratorRuntime = require(\"@babel/runtime/regenerator\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator = require(\"@babel/runtime/helpers/asyncToGenerator\");\n\nvar _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"@babel/runtime/helpers/createClass\");\n\nvar env = require(\"@cosmic-plus/jsutils/es5/env\");\n\nvar misc = require(\"@cosmic-plus/jsutils/es5/misc\");\n\nvar html = env.isBrowser && require(\"@cosmic-plus/domutils/es5/html\");\n\nvar SideFrame = env.isBrowser && require(\"./helpers/side-frame\");\n\nvar action = require(\"./action\");\n\nvar config = require(\"./config\");\n\nvar convert = require(\"./convert\");\n\nvar format = env.isBrowser && require(\"./format\");\n\nvar parse = require(\"./parse\");\n\nvar resolve = require(\"./resolve\");\n\nvar sep7Utils = require(\"./sep7-utils\");\n\nvar status = require(\"./status\");\n/**\n * | Formats                                     | Data                                | Actions                                        | Editor                                       | HTML\n * |---------------------------------------------|-------------------------------------|------------------------------------------------|----------------------------------------------|----------------------------------------\n * |---------------------|---------------------|---------------------|---------------------|---------------------\n * | [uri]{@link CosmicLink#uri}                 |[page]{@link CosmicLink#page}        |[open]{@link CosmicLink#open}                   |[parse]{@link CosmicLink#parse}               |[htmlDescription]{@link CosmicLink#htmlDescription}\n * | [query]{@link CosmicLink#query}             |[network]{@link CosmicLink#network}  |[lock]{@link CosmicLink#lock} async             |[setTxFields]{@link CosmicLink#setTxFields}   |[htmlLink]{@link CosmicLink#htmlLink}\n * | [tdesc]{@link CosmicLink#tdesc}             |[horizon]{@link CosmicLink#horizon}  |[sign]{@link CosmicLink#sign}                   |[addOperation]{@link CosmicLink#addOperation} |\n * | [json]{@link CosmicLink#json}               |[callback]{@link CosmicLink#callback}|[send]{@link CosmicLink#send} async             |[setOperation]{@link CosmicLink#setOperation}\n * | [transaction]{@link CosmicLink#transaction} |[source]{@link CosmicLink#source}    |[signSep7]{@link CosmicLink#signSep7}           |[insertOperation]{@link CosmicLink#insertOperation}\n * | [xdr]{@link CosmicLink#xdr}                 |[status]{@link CosmicLink#status}    |[verifySep7]{@link CosmicLink#verifySep7} async\n * | [sep7]{@link CosmicLink#sep7}               |[errors]{@link CosmicLink#errors}    |\n * |                                             |[locker]{@link CosmicLink#locker}\n * |                                             |[cache]{@link CosmicLink#cache}\n * |                                             |[extra]{@link CosmicLink#extra}\n * -----\n *\n * The **CosmicLink** class represents Stellar\n * [transactions]{@link https://stellar.org/developers/guides/concepts/transactions.html}\n * encoded in various formats. It allows to convert between those formats, to\n * edit the underlying transaction, to build it, to sign it and to send it to\n * the blockchain.\n *\n * There are 3 main formats from which the other are derived:\n *\n * * The StellarSdk [Transaction]{@link {@link https://stellar.github.io/js-stellar-sdk/Transaction.html}} object. (**transaction**)\n * * The CosmicLink, which is a transaction encoded as a query. (**query**)\n * * The Tdesc, which is an internal JSON-compatible format in-between those two.\n *   It is the easier format to work with. (**tdesc**)\n *\n * Those formats can be derived into other related formats:\n *\n * * The XDR, which's a base64 representation of StellarSdk Transaction. (**xdr**)\n * * The Sep-0007 link, in its XDR form. (**sep7**)\n * * The CosmicLink URL/URI, which is a page plus the query. (**uri**)\n * * The Tdesc JSON, which is its stringified version. (**json**)\n *\n * A CosmicLink object can be created from any of those formats. Some of the\n * other formats are immediately available, while others may need an\n * `await cosmicLink.lock()` operation to become computable:\n *\n * * If you create a CosmicLink from an **uri**, a **query**, a **tdesc** or a\n *   **json**, only those 4 formats are available at first. Transaction, xdr &\n *   sep7 will become available after a `cosmicLink.lock()`. (**free formats**)\n * * If you create a CosmicLink from a **transaction**, an **xdr** or a **sep7**,\n *   all formats will immediately be available. (**locked formats**)\n *\n * For a better efficiency, formats are lazy-evaluated. This means that they are\n * computed once only if/when you call them:\n *\n * ```js\n * const cosmicLink = new CosmicLink(xdr, { network: 'test' })\n * console.log(cosmicLink.query)\n * ```\n *\n * The role of `cosmicLink.lock()` is centric to this class. In practice, the\n * free formats don't have to be tied to a **network**, a **source** or a\n * **sequence number**. For example, the CosmicQuery `?inflation` is a valid\n * generic transaction that can be locked to any network/source/sequence\n * combination.\n *\n * On the other hand, locked formats are always tied to a particular combination\n * of those, hence the need for a **lock** command:\n *\n * ```js\n * const cosmicLib = require('cosmic-lib')\n * cosmicLib.network = 'test'\n * cosmicLib.source = 'tips*cosmic.link'\n *\n * const cosmicLink = new cosmicLib.CosmicLink('?inflation')\n *\n * console.log(cosmicLink.tdesc.source)    // => undefined\n * console.log(cosmicLink.tdesc.network)   // => undefined\n * console.log(cosmicLink.tdesc.sequence)  // => undefined\n * console.log(cosmicLink.xdr)             // => undefined\n *\n * await cosmicLink.lock({)\n *\n * console.log(cosmicLink.tdesc.source)    // => 'GC6Z...2JVW'\n * console.log(cosmicLink.tdesc.network)   // => 'test'\n * console.log(cosmicLink.tdesc.sequence)  // => 29...3903\n * console.log(cosmicLink.xdr)             // => 'AAAA....AA=='\n * ```\n *\n * The **lock** command is asynchronous because free formats accept\n * [federated addresses]{@link https://stellar.org/developers/guides/concepts/federation.html},\n * but locked formats don't. The library automatically resolve\n * those and this is an asynchronous operation. At the same time, it downloads\n * the required data from the blockchain to handle multi-signers transactions.\n *\n * After the lock operation, all free formats are updated according to the new\n * state of the transaction. It is now possible to `cosmicLink.sign(keypair)`\n * it, and to `cosmicLink.send()` it to the blockchain.\n */\n\n\nvar CosmicLink =\n/*#__PURE__*/\nfunction () {\n  \"use strict\";\n\n  /**\n   * Create a new CosmicLink object. **transaction** can be one of the accepted\n   * format: uri, query, json, tdesc, transaction, xdr or sep7.\n   *\n   * @constructor\n   * @param {string|Object|Transaction} transaction A transaction in one of\n   *  thoses formats: uri, query, json, tdesc, transaction, xdr, sep7\n   * @param {Object} options Additional options\n   * @param {string} options.page The base URI to use when converting transaction\n   *     to URI format.\n   * @param {string} options.network For Transaction/XDR formats, the network for\n   *     which it have been created\n   * @param {string} options.strip Remove an element from the original\n   *     XDR transaction. Valid values are `source`, `sequence` and\n   *     `signatures`. Stripping out sequence means that the transaction request\n   *     can get signed anytime in the future, possibly several times.\n   *     Stripping out source means that it can get signed by any account.\n   * @param {boolean} options.stripNeutralAccount If set, strip source account\n   *     out of SEP-0007/XDR requests when it is equal to the neutral account\n   *     (`GAAA...AWHF`).\n   * @param {boolean} options.stripNeutralSequence If set, strip sequence out\n   *     of SEP-0007/XDR requests when it is equal to `0`.\n   * @return {CosmicLink}\n   */\n  function CosmicLink(transaction, options) {\n    _classCallCheck(this, CosmicLink);\n\n    initCosmicLink(this, transaction, options);\n  }\n  /**\n   * Refer to the underlying global configuration\n   * @private\n   */\n\n\n  _createClass(CosmicLink, [{\n    key: \"parse\",\n\n    /**\n     * Re-parse this CosmicLink. Useful in implementing transaction editors. The\n     * parameters are the same than [Constructor]{@link CosmicLink#Constructor},\n     * and the result is similar except that no new CosmicLink object is created.\n     */\n    value: function parse(transaction, options) {\n      initCosmicLink(this, transaction, options);\n    } /// Formats\n\n    /**\n     * A CosmicLink is a URI that embed a Cosmic [Query]{@link CosmicLink#query}.\n     * This format is simply the `cosmicLink.query` appended to the\n     * `cosmicLink.page`\n     */\n\n  }, {\n    key: \"setTxFields\",\n    /// Editor\n\n    /**\n     * Add/remove transaction fields and reparse the CosmicLink. **object** should\n     * follow the Tdesc format, but fields values can be written using query or\n     * StellarSdk format as well.\n     *\n     * @example\n     * cosmicLink.setTxFields({ minTime: '2018-10', maxTime: '2019-01' })\n     *\n     * @example\n     * cosmicLink.setTxFields({ minTime: null, maxTime: null })\n     *\n     * @example\n     * cosmicLink.setTxFields({ memo: 'Bonjour!' })\n     *\n     * @param {Object} object Transaction fields definition. Fields can be either\n     *   written using the JSON format or the query format\n     * @return {CosmicLink}\n     */\n    value: function setTxFields(object) {\n      checkLock(this);\n      this.parse(Object.assign(this.tdesc, object));\n      return this;\n    }\n    /**\n     * Add a new operation to CosmicLink. **params** should follow the Tdesc format,\n     * but fields values can be written using query or StellarSdk format as well.\n     *\n     * @example\n     * cosmicLink.addOperation('changeTrust', { asset: 'CNY:admin*ripplefox' })\n     *\n     * @example\n     * cosmicLink.addOperation('changeTrust', { asset: { code: 'CNY', issuer: 'admin*ripplefox } })\n     *\n     * @example\n     * cosmicLink.addOperation('changeTrust', { asset: new StellarSdk.Asset('CNY', ...) })\n     *\n     * @param {string} type The operation type.\n     * @param {Object} params The operation parameters.\n     * @return {CosmicLink}\n     */\n\n  }, {\n    key: \"addOperation\",\n    value: function addOperation(type, params) {\n      checkLock(this);\n      var odesc = Object.assign({\n        type: type\n      }, params);\n      this.tdesc.operations.push(odesc);\n      this.parse(this.tdesc);\n      return this;\n    }\n    /**\n     * Insert an operation at **index**. **params** should follow the\n     * Tdesc format, but fields can be written using query or StellarSdk format\n     * as well.\n     *\n     * @example\n     * cosmicLink.insertOperation(0, 'changeTrust', {\n     *   asset: 'CNY:admin*ripplefox'\n     * })\n     *\n     * @param {integer} index The operation index.\n     * @param {string} type  The operation type.\n     * @param {params} params The operation parameters.\n     * @return {CosmicLink}\n     */\n\n  }, {\n    key: \"insertOperation\",\n    value: function insertOperation(index, type, params) {\n      checkLock(this);\n\n      if (index > !this.tdesc.operations.length) {\n        throw new Error(\"Can't insert opereration at position \".concat(index, \": there are only \").concat(this.tdesc.operations.length, \" operations\"));\n      }\n\n      var odesc = Object.assign({\n        type: type\n      }, params);\n      this.tdesc.operations.splice(index, 0, odesc);\n      this.parse(this.tdesc);\n      return this;\n    }\n    /**\n     * Set/remove one of the CosmicLink operations. **params** should follow the\n     * Tdesc format, but fields can be written using query or StellarSdk format\n     * as well. If **type** is set to `null`, the operation at **index**\n     * is deleted.\n     *\n     * @example\n     * cosmicLink.setOperation(1, 'setOptions', { homeDomain: 'example.org' })\n     *\n     * @example\n     * cosmicLink.setOperation(2, null)\n     *\n     * @param {integer} index The operation index.\n     * @param {string} type  The operation type.\n     * @param {params} params The operation parameters.\n     * @return {CosmicLink}\n     */\n\n  }, {\n    key: \"setOperation\",\n    value: function setOperation(index, type, params) {\n      checkLock(this);\n\n      if (!this.tdesc.operations[index]) {\n        throw new Error(\"Operation \".concat(index, \" doesn't exists\"));\n      }\n\n      if (type === null) {\n        this.tdesc.operations.splice(index, 1);\n      } else {\n        this.tdesc.operations[index] = Object.assign({\n          type: type\n        }, params);\n        this.parse(this.tdesc);\n      }\n\n      return this;\n    } /// Actions\n\n    /**\n     * Select the network that this CosmicLink uses.\n     *\n     * @deprecated StellarSdk global `Network` setting is deprecated.\n     */\n\n  }, {\n    key: \"selectNetwork\",\n    value: function selectNetwork() {\n      return resolve.useNetwork(this);\n    }\n  }, {\n    key: \"lock\",\n    value: function lock(options) {\n      return action.lock(this, options);\n    }\n  }, {\n    key: \"sign\",\n    value: function sign() {\n      for (var _len = arguments.length, keypairs_or_preimage = new Array(_len), _key = 0; _key < _len; _key++) {\n        keypairs_or_preimage[_key] = arguments[_key];\n      }\n\n      return action.sign.apply(action, [this].concat(keypairs_or_preimage));\n    }\n  }, {\n    key: \"send\",\n    value: function send(horizon) {\n      return action.send(this, horizon);\n    }\n    /**\n     * The HTML DOM node that displays a description of the current transaction.\n     * This is a browser-only property.\n     *\n     * If your HTML page contains an element with `id=\"cosmiclink_description\"`,\n     * it will automatically get populated with the description of the last\n     * CosmicLink created.\n     */\n\n  }, {\n    key: \"open\",\n\n    /**\n     * Open CosmicLink in **target**.\n     *\n     * - `frame` (default): Open cosmicLink in a side-frame.\n     * - `tab`: Open cosmicLink in a new tab.\n     * - `current`: Open cosmicLink into the current window.\n     * - `sep7`: Open cosmicLink using user's SEP-0007 handler.\n     *\n     * @param {String} [target=\"frame\"] Open `cosmicLink` into the requested\n     *    target. Valid targets are: `frame`, `tab`, `current` and `sep7`.\n     */\n    value: function open() {\n      var target = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"frame\";\n\n      if (env.isNode) {\n        console.error(\"Warning: cosmicLink.open() is not supported in Node.js environment.\");\n        return;\n      }\n\n      if (this.status) throw new Error(this.status);\n\n      switch (target) {\n        case \"frame\":\n          return new SideFrame(this.uri);\n\n        case \"tab\":\n          window.open(this.uri);\n          break;\n\n        case \"current\":\n          location.href = this.uri;\n          break;\n\n        case \"sep7\":\n          if (!this.sep7) {\n            throw new Error(\"Please use cosmicLink.lock() to build SEP-0007 link.\");\n          } else {\n            location.href = this.sep7;\n          }\n\n          break;\n\n        default:\n          throw new Error(\"Invalid cosmicLink.open() target: \".concat(target));\n      }\n    }\n    /**\n     * Sign SEP-0007 link for **domain**, using **keypair**.\n     *\n     * @see [SEP-0007 request signing](https://github.com/stellar/stellar-protocol/blob/master/ecosystem/sep-0007.md#request-signing)\n     *\n     * @param {String} domain The domain or subdomain you want to sign the request\n     * for. (example: \"a-domain.org\")\n     * @param {Keypair} keypair A StellarSdk Keypair.\n     */\n\n  }, {\n    key: \"signSep7\",\n    value: function signSep7(domain, keypair) {\n      if (!this.locker) throw new Error(\"cosmicLink is not locked.\");\n      sep7Utils.signLink(this, domain, keypair);\n    }\n    /**\n     * Verify SEP-0007 signature by resolving [`cosmicLink.extra.domain`]{@link\n     * CosmicLink#extra}, if any.\n     * Throw an error if the signature is not valid.\n     *\n     * @return {undefined|String} The resolved `cosmicLink.extra.domain`, if any.\n     */\n\n  }, {\n    key: \"verifySep7\",\n    value: function () {\n      var _verifySep = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var domain;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(this.extra.originDomain instanceof Promise)) {\n                  _context.next = 7;\n                  break;\n                }\n\n                _context.next = 3;\n                return this.extra.originDomain;\n\n              case 3:\n                domain = _context.sent;\n                this.extra.originDomain = domain;\n                _context.next = 8;\n                break;\n\n              case 7:\n                if (this.extra.originDomain) {\n                  sep7Utils.verifySignature(this, this.extra.originDomain);\n                }\n\n              case 8:\n                return _context.abrupt(\"return\", this.extra.originDomain);\n\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function verifySep7() {\n        return _verifySep.apply(this, arguments);\n      }\n\n      return verifySep7;\n    }()\n  }, {\n    key: \"config\",\n    get: function get() {\n      return this.__proto__.__proto__;\n    }\n  }, {\n    key: \"uri\",\n    get: function get() {\n      if (this.query) return this.page + this.query;else return undefined;\n    }\n    /**\n     * CosmicLink's transaction encoded in the Cosmic\n     * [Query]{@link tutorial:specs_query} format. This format allows to\n     * conveniently pass around Stellar transactions over any URI.\n     */\n\n  }, {\n    key: \"query\",\n    get: function get() {\n      if (!this._query) {\n        if (this.xdr) this._query = convert.xdrToQuery(this, this.xdr, this.tdesc);else if (this.tdesc) this._query = convert.tdescToQuery(this, this.tdesc);else return undefined;\n      }\n\n      return this._query;\n    }\n    /**\n     * CosmicLink's transaction in Tdesc format. This is in-between an objectified\n     * query representation and a simplified StellarSdk Transaction object. It has\n     * been created to be convenient to understand, use and manipulate.\n     *\n     * If you need to read the transaction parameters, this is the format of\n     * choice:\n     *\n     * ```js\n     * console.log(cosmicLink.tdesc.network) // Does the transaction enforce a network?\n     * console.log(cosmicLink.tdesc.source)  // Does the transaction enforce a source?\n     * console.log(cosmicLink.tdesc.memo)    // A simplified memo object or undefined\n     * console.log(cosmicLink.operations)    // Transaction operations in simplified format\n     * ```\n     *\n     * This formats authorize [federated addresses]{@link https://stellar.org/developers/guides/concepts/federation.html}\n     * everywhere StellarSdk Transaction accept public keys. Those addresses are\n     * resolved when running the [lock]{@link CosmicLink#lock} method, and the\n     * tdesc is replaced by a resolved one.\n     *\n     * Tdesc is also very convenient to edit. To keep the CosmicLink in sync, you\n     * either need to [parse]{@link CosmicLink#parse} the edited tdesc, or to edit\n     * it using the dedicated methods:\n     *\n     * * [setTxFields]{@link CosmicLink#setTxFields}: set/clear transaction fields\n     * * [addOperation]{@link CosmicLink#addOperation}: add a new operation\n     * * [setOperation]{@link CosmicLink#setOperation}: edit/clear an operation\n     */\n\n  }, {\n    key: \"tdesc\",\n    get: function get() {\n      if (!this._tdesc) {\n        if (this.transaction) this._tdesc = convert.transactionToTdesc(this, this.transaction, this.locker);else return undefined;\n      }\n\n      return this._tdesc;\n    }\n    /**\n     * CosmicLink's transaction in JSON format. This is a stringified version of\n     * [Tdesc]{@link CosmicLink#tdesc} format.\n     */\n\n  }, {\n    key: \"json\",\n    get: function get() {\n      if (!this._json) this._json = convert.tdescToJson(this, this.tdesc);\n      return this._json;\n    }\n    /**\n     * CosmicLink's transaction in StellarSdk\n     * [Transaction]{@link https://stellar.github.io/js-stellar-sdk/Transaction.html}\n     * format.\n     *\n     * If you created the CosmicLink from uri, query, tdesc or json format, a\n     * [lock()]{@link CosmicLink#lock} operation is needed to make this format\n     * available.\n     */\n\n  }, {\n    key: \"transaction\",\n    get: function get() {\n      return this._transaction;\n    }\n    /**\n     * CosmicLink's transaction in\n     * [XDR]{@link https://stellar.org/developers/guides/concepts/xdr.html}\n     * format.\n     *\n     * If you created the CosmicLink from uri, query, tdesc or json format, a\n     * [lock()]{@link CosmicLink#lock} operation is needed to make this format\n     * available.\n     */\n\n  }, {\n    key: \"xdr\",\n    get: function get() {\n      if (!this._xdr) {\n        if (!this.transaction) return undefined;\n        this._xdr = convert.transactionToXdr(this, this.transaction);\n      }\n\n      return this._xdr;\n    }\n    /**\n     * CosmicLink transaction in\n     * [SEP-0007]{@link https://github.com/stellar/stellar-protocol/blob/master/ecosystem/sep-0007.md}\n     * link format. Only the XDR part of this protocol is currently supported by\n     * CosmicLink, minus the signature verification.\n     *\n     * If you created the CosmicLink from uri, query, tdesc or json format, a\n     * [lock()]{@link CosmicLink#lock} operation is needed to make this format\n     * available.\n     */\n\n  }, {\n    key: \"sep7\",\n    get: function get() {\n      if (!this._sep7) {\n        if (!this.xdr) return undefined;\n        this._sep7 = convert.xdrToSep7(this, this.xdr, this.tdesc);\n      }\n\n      return this._sep7;\n    } /// Data\n\n    /**\n     * The page this CosmicLink uses to construct its [URI]{@link CosmicLink#uri}.\n     *\n     * @var CosmicLink#page\n     */\n\n    /**\n     * The source for this transaction. This can be defined either locally\n     * (`cosmicLink.tdesc.source`) or globally (`cosmicLib.config.source`). The\n     * local configuration takes precedence, or, in other words, the global source\n     * is a fallback value in case the transaction emitter doesn't set one.\n     *\n     * **Note:** cosmicLink.tdesc should be edited using [setTxFields]{@link\n     * CosmicLink#setTxFields}.\n     */\n\n  }, {\n    key: \"source\",\n    get: function get() {\n      return this.tdesc && this.tdesc.source || this.config.source;\n    }\n    /**\n     * The network for this transaction. This can be defined either locally\n     * (`cosmicLink.tdesc.network`) or globally (`cosmicLib.config.network`). The\n     * local configuration takes precedence, or, in other words, the global\n     * network is a fallback value in case the transaction emitter doesn't set\n     * one.\n     *\n     * **Note:** cosmicLink.tdesc should be edited using [setTxFields]{@link\n     * CosmicLink#setTxFields}.\n     */\n\n  }, {\n    key: \"network\",\n    get: function get() {\n      return this.tdesc && this.tdesc.network || this.config.network;\n    }\n    /**\n     * The URL of the horizon node from which ledger data will be retrieved, and\n     * to which the signed transaction will be posted if there's no\n     * [callback]{@link CosmicLink#callback}.\n     *\n     * This can be defined either locally (`cosmicLink.tdesc.horizon`) or globally\n     * (using [setupNetwork]{@link module:config.setupNetwork}). This parameter is\n     * special in the sense that it's the only one for which the global\n     * configuration takes precedence.\n     *\n     * The rationale for this behavior is that we want transaction emitter to\n     * provide a fallback Horizon URL in the special case none is known for a\n     * custom network, but generally speaking it won't be right to allow the\n     * transaction emitter to force us to use a particular Horizon node.\n     *\n     * **Note:** cosmicLink.tdesc should be edited using [setTxFields]{@link\n     * CosmicLink#setTxFields}.\n     */\n\n  }, {\n    key: \"horizon\",\n    get: function get() {\n      return resolve.horizon(this.config, this.network) || this.tdesc && this.tdesc.horizon;\n    }\n    /**\n     * The URL at which the signed transaction will be posted. This can be defined\n     * either locally (`cosmicLink.tdesc.callback`) or globally\n     * (`cosmicLib.config.callback`). The local configuration takes precedence.\n     *\n     * When no callback is defined, the signed transaction is posted to\n     * [Horizon]{@link CosmicLink#horizon}. This is the default behavior.\n     *\n     * **Note:** cosmicLink.tdesc should be edited using [setTxFields]{@link\n     * CosmicLink#setTxFields}.\n     */\n\n  }, {\n    key: \"callback\",\n    get: function get() {\n      return this.tdesc && this.tdesc.callback || this.config.callback;\n    }\n  }, {\n    key: \"htmlDescription\",\n    get: function get() {\n      if (!this._htmlDescription) makeHtmlDescription(this);\n      return this._htmlDescription;\n    }\n    /**\n     * A link HTML Element that points to `cosmicLink.uri`\n     */\n\n  }, {\n    key: \"htmlLink\",\n    get: function get() {\n      if (!this._htmlLink) makeHtmlLink(this);\n      return this._htmlLink;\n    }\n  }]);\n\n  return CosmicLink;\n}();\n/**\n * Initialize or reset a CosmicLink.\n *\n * @private\n */\n\n\nfunction initCosmicLink(cosmicLink, transaction) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  checkLock(cosmicLink); /// Reset object in case of reparse.\n\n  formatsFields.forEach(function (type) {\n    return delete cosmicLink[type];\n  });\n  cosmicLink.page = cosmicLink.page || options.page || config.page;\n  /**\n   * The status of a CosmicLink. It becomes non-null in case of failure.\n   * @var CosmicLink#status\n   */\n\n  /**\n   * By default `false`, or an *Array* of errors.\n   * @var CosmicLink#errors\n   */\n\n  status.init(cosmicLink);\n  /**\n   * The CosmicLink cache contains the resolved federations addresses and the\n   * accounts object. Using the same set of data for all the CosmicLink related\n   * computations ensure consistent results.\n   *\n   * @var CosmicLink#cache\n   */\n\n  cosmicLink.cache = {\n    destination: {},\n    account: {}\n  };\n  /**\n   * After parsing a SEP-0007 link, `cosmicLink.extra` contains SEP-0007\n   * specific information:\n   *\n   * - `cosmicLink.extra.type` indicates the operation encoded into the SEP-0007\n   *   link (either `tx` or `pay`).\n   * - `cosmicLink.extra.originDomain` is a _Promise_ that resolves to the\n   *   origin_domain parameter when the link signature is valid. It rejects an\n   *   error when the signature check fails. This property is `undefined` when\n   *   the link has no origin_domain.\n   * - `cosmicLink.extra.signature` contains the link signature, if any.\n   * - `cosmicLink.extra.pubkey` contains the tx operation `pubkey`, if any.\n   * - `cosmicLink.extra.msg` contains the parsed `msg`, if any. This is\n   *   provided for compatibility purpose only. Displaying messages from\n   *   untrusted sources into trusted interfaces opens hard to mitigate attack\n   *   vectors & is discouraged.\n   *\n   * @var CosmicLink#extra\n   */\n\n  cosmicLink.extra = {};\n  parse.dispatch(cosmicLink, transaction, options);\n\n  if (env.isBrowser) {\n    makeHtmlLink(cosmicLink);\n\n    if (!cosmicLink._htmlDescription) {\n      /// #cosmiclib_htmlNode: Backward compatibility (2018-09 -> 2019-03).\n      cosmicLink._htmlDescription = html.grab(\"#cosmiclink_description\") || html.grab(\"#CL_htmlNode\");\n    }\n\n    if (cosmicLink._htmlDescription) {\n      if (cosmicLink.htmlDescription.id === \"#CL_htmlNode\") {\n        misc.deprecated(\"2019-03\", \"id=\\\"#CL_htmlNode\\\"\", \"id=\\\"cosmiclink_description\\\"\");\n      }\n\n      makeHtmlDescription(cosmicLink);\n    }\n  }\n}\n\nvar formatsFields = [\"_query\", \"_tdesc\", \"_json\", \"_transaction\", \"_xdr\"];\n/**\n * Initialize CosmicLink html nodes.\n *\n * @private\n */\n\nfunction makeHtmlDescription(cosmicLink) {\n  if (env.isNode) return;\n  var htmlDescription = cosmicLink._htmlDescription;\n\n  if (htmlDescription) {\n    html.clear(htmlDescription);\n    htmlDescription.className = \"cosmiclink_description\";\n  } else {\n    htmlDescription = html.create(\"div\", \".cosmiclink_description\");\n    cosmicLink._htmlDescription = htmlDescription;\n  }\n\n  cosmicLink._transactionNode = format.tdesc(cosmicLink, cosmicLink.tdesc);\n  cosmicLink._statusNode = status.makeHtmlNode(cosmicLink);\n  cosmicLink._signersNode = html.create(\"div\", \".cosmiclib_signersNode\");\n  html.append(htmlDescription, cosmicLink._transactionNode, cosmicLink._statusNode, cosmicLink._signersNode);\n}\n/**\n * Make the HTML link.\n * @private\n */\n\n\nfunction makeHtmlLink(cosmicLink) {\n  if (env.isNode) return;\n  var htmlLink = html.grab(\"#cosmiclink\") || html.create(\"a\");\n  htmlLink.className = \".cosmiclink\";\n  htmlLink.href = cosmicLink.page;\n\n  htmlLink.onclick = function () {\n    return htmlLink.href = cosmicLink.uri;\n  };\n\n  if (!htmlLink.title) htmlLink.title = \"Sign transaction\";\n  if (!htmlLink.textContent) htmlLink.textContent = \"CosmicLink\";\n  cosmicLink._htmlLink = htmlLink;\n  return htmlLink;\n}\n/**\n * Throw an error if CosmicLink is locked.\n * @private\n */\n\n\nfunction checkLock(cosmicLink) {\n  if (cosmicLink.locker) throw new Error(\"Cosmic link is locked.\");\n}\n\nCosmicLink.prototype.__proto__ = config;\nmodule.exports = CosmicLink;","\"use strict\";\n/**\n * Signing Side Frame\n *\n * @private\n */\n\nrequire(\"core-js/modules/es.object.assign\");\n\nvar _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"@babel/runtime/helpers/createClass\");\n\nvar _possibleConstructorReturn = require(\"@babel/runtime/helpers/possibleConstructorReturn\");\n\nvar _getPrototypeOf = require(\"@babel/runtime/helpers/getPrototypeOf\");\n\nvar _assertThisInitialized = require(\"@babel/runtime/helpers/assertThisInitialized\");\n\nvar _inherits = require(\"@babel/runtime/helpers/inherits\");\n\nvar html = require(\"@cosmic-plus/domutils/es5/html\");\n\nvar Observable = require(\"@cosmic-plus/jsutils/es5/observable\");\n\nvar _require = require(\"@cosmic-plus/jsutils/es5/misc\"),\n    timeout = _require.timeout;\n\nvar ClickWall = require(\"./click-wall\");\n\nvar cosmicLinkIcon = require(\"../../bundled/cosmic-link.svg\");\n/**\n * Class\n */\n\n\nvar SideFrame =\n/*#__PURE__*/\nfunction (_Observable) {\n  _inherits(SideFrame, _Observable);\n\n  function SideFrame(url) {\n    var _this;\n\n    _classCallCheck(this, SideFrame);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SideFrame).call(this));\n    if (SideFrame.current) SideFrame.current.close();\n    SideFrame.current = _assertThisInitialized(_this);\n    _this.shadow = makeShadow();\n    _this.closeButton = new SideFrame.CloseButton();\n    _this.domNode = html.create(\"iframe\", {\n      title: \"Signing Frame\",\n      src: url,\n      sandbox: \"allow-same-origin allow-scripts allow-forms allow-popups\",\n      hidden: true\n    });\n    Object.assign(_this.domNode.style, SideFrame.style);\n    _this.domNode.style.transform = \"translateX(100%)\";\n    html.append(document.body, _this.closeButton, _this.domNode);\n\n    _this.show();\n\n    return _this;\n  }\n\n  _createClass(SideFrame, [{\n    key: \"show\",\n    value: function show() {\n      var _this2 = this;\n\n      if (!this.domNode.hidden) return; // Timeout is required for transition to play.\n\n      timeout(0).then(function () {\n        return _this2.domNode.style.transform = \"none\";\n      });\n      html.show(this.closeButton.domNode, this.domNode);\n      return this.shadow.enable().then(function () {\n        _this2.shadow.onclick = function () {\n          return _this2.close();\n        };\n\n        _this2.closeButton.domNode.onclick = function () {\n          return _this2.close();\n        };\n\n        _this2.trigger(\"show\");\n      });\n    }\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      var _this3 = this;\n\n      if (this.domNode.hidden) return;\n      html.hide(this.closeButton.domNode);\n      this.domNode.style.transform = \"translateX(100%)\";\n      return this.shadow.disable().then(function () {\n        html.hide(_this3.domNode);\n\n        _this3.trigger(\"hide\");\n      });\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      var _this4 = this;\n\n      SideFrame.current = null;\n      this.hide().then(function () {\n        html.destroy(_this4.domNode);\n        html.destroy(_this4.closeButton.domNode);\n\n        _this4.shadow.destroy();\n\n        _this4.trigger(\"close\");\n\n        _this4.destroy();\n      });\n    }\n  }]);\n\n  return SideFrame;\n}(Observable);\n/**\n * Event\n */\n\n\nwindow.addEventListener(\"message\", function (event) {\n  var frameWindow = SideFrame.current && SideFrame.current.domNode.contentWindow;\n\n  if (event.source === frameWindow) {\n    switch (event.data) {\n      case \"show\":\n        SideFrame.current.show();\n        break;\n\n      case \"hide\":\n        SideFrame.current.hide();\n        break;\n\n      case \"close\":\n        SideFrame.current.close();\n        break;\n    }\n  }\n});\n/**\n * Frame style\n */\n\nSideFrame.style = {\n  position: \"fixed\",\n  zIndex: 1000,\n  right: 0,\n  top: 0,\n  width: \"30em\",\n  maxWidth: \"100%\",\n  height: \"100vh\",\n  border: \"0.1em solid hsl(240, 10%, 75%)\",\n  background: \"hsl(240, 40%, 98%)\",\n  backgroundImage: \"url('\".concat(cosmicLinkIcon, \"')\"),\n  backgroundRepeat: \"no-repeat\",\n  backgroundPosition: \"center\",\n  backgroundSize: \"12em 12em\",\n  padding: 0,\n  transition: \"transform 0.4s\",\n  willChange: \"transform\"\n};\n/**\n * Closing button\n */\n\nSideFrame.CloseButton = function CloseButton() {\n  _classCallCheck(this, CloseButton);\n\n  this.domNode = html.create(\"span\", {\n    hidden: true\n  }, \" Close\");\n  Object.assign(this.domNode.style, SideFrame.CloseButton.style);\n};\n\nSideFrame.CloseButton.style = {\n  position: \"fixed\",\n  zIndex: 1001,\n  top: \"0.1em\",\n  right: \"0.1em\",\n  color: \"hsl(0, 0%, 40%)\",\n  fontSize: \"0.9em\",\n  fontWeight: \"bold\",\n  cursor: \"pointer\",\n  background: \"hsl(0, 0%, 95%)\",\n  borderBottomLeftRadius: \"0.1em\",\n  padding: \"0.1em 0.3em\"\n};\n/**\n * Shadow Layer\n */\n\nfunction makeShadow() {\n  return new ClickWall({\n    scrollbar: \"hide\",\n    opacity: 0.3,\n    delay: 400\n  });\n}\n/**\n * Export\n */\n\n\nmodule.exports = SideFrame;","\"use strict\";\n/**\n * Overlay that prevent user interaction\n *\n * @private\n */\n\nrequire(\"core-js/modules/es.object.assign\");\n\nvar _regeneratorRuntime = require(\"@babel/runtime/regenerator\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator = require(\"@babel/runtime/helpers/asyncToGenerator\");\n\nvar _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"@babel/runtime/helpers/createClass\");\n\nvar html = require(\"@cosmic-plus/domutils/es5/html\");\n\nvar _require = require(\"@cosmic-plus/jsutils/es5/misc\"),\n    timeout = _require.timeout;\n/**\n * Definition\n */\n\n\nvar ClickWall =\n/*#__PURE__*/\nfunction () {\n  function ClickWall() {\n    var _this = this;\n\n    var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, ClickWall);\n\n    this.domNode = html.create(\"div\", {\n      className: \"ClickWall\",\n      onclick: function onclick() {\n        return _this.click();\n      },\n      hidden: true\n    });\n    Object.assign(this.domNode.style, ClickWall.style);\n    html.append(document.body, this.domNode);\n    this.onclick = params.onclick;\n    this.scrollbar = params.scrollbar;\n    this.opacity = params.opacity;\n    this.delay = params.delay || ClickWall.delay;\n  }\n\n  _createClass(ClickWall, [{\n    key: \"click\",\n    value: function click() {\n      if (this.isEnabled && this.onclick) this.onclick();\n    }\n  }, {\n    key: \"enable\",\n    value: function () {\n      var _enable = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                // Scrollbar hidding.\n                if (this.scrollbar === \"hide\") {\n                  this.htmlOverflow = document.documentElement.style.overflow;\n                  this.bodyOverflow = document.body.style.overflow;\n                  document.documentElement.style.overflow = \"hidden\";\n                  document.body.style.overflow = \"hidden\";\n                } // Fade in.\n\n\n                html.show(this.domNode);\n\n                if (!this.opacity) {\n                  _context.next = 5;\n                  break;\n                }\n\n                _context.next = 5;\n                return this.setOpacity(this.opacity);\n\n              case 5:\n                this.isEnabled = true;\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function enable() {\n        return _enable.apply(this, arguments);\n      }\n\n      return enable;\n    }()\n  }, {\n    key: \"disable\",\n    value: function () {\n      var _disable = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                // Handle scrollbar hidding.\n                if (this.scrollbar === \"hide\") {\n                  document.documentElement.style.overflow = this.htmlOverflow;\n                  document.body.style.overflow = this.bodyOverflow;\n                } // Fade out.\n\n\n                this.isEnabled = false;\n\n                if (!this.opacity) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                _context2.next = 5;\n                return this.setOpacity(0);\n\n              case 5:\n                html.hide(this.domNode);\n\n              case 6:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function disable() {\n        return _disable.apply(this, arguments);\n      }\n\n      return disable;\n    }()\n  }, {\n    key: \"destroy\",\n    value: function () {\n      var _destroy = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this.disable();\n\n              case 2:\n                html.destroy(this.domNode);\n\n              case 3:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function destroy() {\n        return _destroy.apply(this, arguments);\n      }\n\n      return destroy;\n    }()\n  }, {\n    key: \"setOpacity\",\n    value: function () {\n      var _setOpacity = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4() {\n        var opacity,\n            _args4 = arguments;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                opacity = _args4.length > 0 && _args4[0] !== undefined ? _args4[0] : this.opacity;\n                _context4.next = 3;\n                return timeout(0);\n\n              case 3:\n                Object.assign(this.domNode.style, {\n                  transition: \"opacity \".concat(this.delay, \"ms\"),\n                  opacity: opacity\n                });\n                return _context4.abrupt(\"return\", timeout(this.delay));\n\n              case 5:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function setOpacity() {\n        return _setOpacity.apply(this, arguments);\n      }\n\n      return setOpacity;\n    }()\n  }]);\n\n  return ClickWall;\n}();\n/**\n * Configuration\n */\n\n\nClickWall.delay = 500;\nClickWall.style = {\n  position: \"fixed\",\n  zIndex: 999,\n  top: 0,\n  width: \"100%\",\n  height: \"100%\",\n  background: \"#000\",\n  opacity: 0,\n  willChange: \"opacity\"\n};\n/**\n * Export\n */\n\nmodule.exports = ClickWall;","module.exports=`data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"512\" height=\"512\"%3E%3Cpath fill=\"%23c1c1c1\" d=\"M179.24078 179.33326l-139.467135 139.472c-42.36486 42.364-42.36486 111.057 0 153.421 42.364861 42.365 111.057145 42.365 153.421735 0l138.729-138.733c-25.99806 25.453-61.62709 35.207-95.00214 29.258l-76.60113 76.601c-24.2097 24.21-63.463495 24.21-87.673478 0-24.209708-24.21-24.209708-63.463 0-87.673l76.605518-76.606 63.49455-63.49c24.25805-23.586 63.04182-23.375 87.04055.624 24.17894 24.179 24.20971 63.362.0967 87.585l62.86162-62.866c-3.75663-21.094-13.78318-41.292-30.08405-57.593-16.29648-16.297-36.49024-26.323-57.58476-30.084-34.92606-6.226-70.73529 4.982-95.83698 30.084z\"/%3E%3Cpath fill=\"%239f9f9f\" d=\"M332.75922 332.66726l139.46713-139.472c42.36487-42.364 42.36487-111.057004 0-153.421004-42.36485-42.3660001-111.05714-42.3660001-153.42174 0L180.07562 178.50726c25.99805-25.453 61.62708-35.207 95.00214-29.258l76.60112-76.601004c24.2097-24.21 63.4635-24.21 87.67348 0 24.20972 24.209 24.20972 63.463004 0 87.673004l-76.60551 76.606-63.49456 63.49c-24.25805 23.586-63.04182 23.375-87.04054-.624-24.17895-24.179-24.20972-63.363-.0967-87.585l-62.86163 62.866c3.75663 21.094 13.78319 41.292 30.08406 57.593 16.29648 16.297 36.49023 26.323 57.58476 30.084 34.92606 6.226 70.73529-4.982 95.83698-30.084z\"/%3E%3Cpath fill=\"%23a6a6a6\" d=\"M356.90299 216.24526l-38.96398 38.964c.21537 15.871-5.62848 31.807-17.5269 44.048l62.33446-62.33c-1.25211-7.03-3.1987-13.959-5.84358-20.682zm-24.97861 117.248c-22.2722 21.797-52.72519 32.826-83.47734 30.682-3.84013-.268-7.68906-.738-11.5248-1.424l-13.98536 13.986c10.03974 2.622 20.58027 4.02 31.44193 4.02 12.3069 0 24.19213-1.793 35.41393-5.132l42.13191-42.132z\"/%3E%3Cpath fill=\"%23888\" d=\"M180.07562 178.50726c22.2722-21.797 52.72519-32.826 83.47733-30.682 3.84013.268 7.68907.738 11.52481 1.424l12.06515-12.065c-10.43531-2.852-21.42416-4.376-32.76438-4.376-11.45008 0-22.53563 1.551-33.06297 4.459zm13.98537 76.61c.20218-15.312 6.04576-30.563 17.52689-42.374l-62.33446 62.331c1.17768 6.608 2.97014 13.132 5.37795 19.473z\"/%3E%3C/svg%3E`\n","\"use strict\";\n/**\n * Contains the action methods for CosmicLink.\n *\n * @private\n * @exports action\n */\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.array.iterator\");\n\nrequire(\"core-js/modules/es.object.assign\");\n\nrequire(\"core-js/modules/es.object.to-string\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator\");\n\nvar _regeneratorRuntime = require(\"@babel/runtime/regenerator\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator = require(\"@babel/runtime/helpers/asyncToGenerator\");\n\nvar action = exports;\n\nvar axios = require(\"@cosmic-plus/base/es5/axios\");\n\nvar env = require(\"@cosmic-plus/jsutils/es5/env\");\n\nvar misc = require(\"@cosmic-plus/jsutils/es5/misc\");\n\nvar convert = require(\"./convert\");\n\nvar format = env.isBrowser && require(\"./format\");\n\nvar resolve = require(\"./resolve\");\n\nvar signersUtils = require(\"./signers-utils\");\n\nvar status = require(\"./status\");\n/**\n * Lock a CosmicLink to a network/source pair. If the cosmicLink was created\n * from a query/uri/tdesc/json, it will create the corresponding\n * transaction/xdr/sep7 formats.\n *\n * This operation must be performed by the wallet before signing & sending the\n * transaction.\n *\n * @example\n * cosmicLib.config.network = \"test\"\n * const cosmicLink = new CosmicLink(\"?setOptions\")\n * console.log(cosmicLink.network) // => undefined\n * console.log(cosmicLink.xdr)     // => undefined\n * await cosmicLink.lock()\n * console.log(cosmicLink.network) // => \"test\"\n * console.log(cosmicLink.xdr)     // => \"AAAA...AA==\"\n *\n *\n * @alias CosmicLink#lock\n * @async\n * @param {Object} [options]\n * @param {string} options.network Local fallback network\n * @param {string} options.horizon Local fallback horizon (overwrited by global configuration)\n * @param {string} options.callback Local fallback callback\n * @param {string} options.source Local fallback source\n */\n\n\naction.lock =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(cosmicLink) {\n    var options,\n        _args = arguments;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};\n\n            if (!cosmicLink.status) {\n              _context.next = 3;\n              break;\n            }\n\n            throw new Error(cosmicLink.status);\n\n          case 3:\n            if (!cosmicLink.locker) {\n              _context.next = 5;\n              break;\n            }\n\n            throw new Error(\"CosmicLink is already locked.\");\n\n          case 5:\n            _context.prev = 5;\n            _context.next = 8;\n            return applyLock(cosmicLink, options);\n\n          case 8:\n            _context.next = 14;\n            break;\n\n          case 10:\n            _context.prev = 10;\n            _context.t0 = _context[\"catch\"](5);\n\n            if (!cosmicLink.errors) {\n              console.error(_context.t0);\n              status.error(cosmicLink, _context.t0.message);\n            }\n\n            status.fail(cosmicLink, \"Transaction build failed\", \"throw\");\n\n          case 14:\n            updateSignersNode(cosmicLink);\n            return _context.abrupt(\"return\", cosmicLink);\n\n          case 16:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[5, 10]]);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nfunction applyLock(_x2, _x3) {\n  return _applyLock.apply(this, arguments);\n}\n/**\n * Sign CosmicLink's Transaction with **keypairs_or_preimage** and update the\n * other formats accordingly. Only legit signers are allowed to sign, and a\n * CosmicLink have to be [locked]{@link CosmicLink#lock} before signing.\n *\n * @alias CosmicLink#sign\n * @param {...Keypair|Buffer|string} ...keypairs_or_preimage\n */\n\n\nfunction _applyLock() {\n  _applyLock = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee4(cosmicLink, options) {\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            /**\n             * The locker property tells that a CosmicLink have been locked, and exposes\n             * the network & source values to which it have been locked.\n             *\n             * @alias CosmicLink#locker\n             */\n            cosmicLink.locker = {\n              source: cosmicLink.tdesc.source || options.source || cosmicLink.config.source,\n              network: cosmicLink.tdesc.network || options.network || cosmicLink.config.network,\n              horizon: options.horizon || cosmicLink.horizon,\n              callback: cosmicLink.tdesc.callback || options.callback || cosmicLink.config.callback\n            }; /// Preserve the underlying tdesc object.\n\n            cosmicLink._tdesc = Object.assign({}, cosmicLink.tdesc, cosmicLink.locker);\n            delete cosmicLink._query;\n            delete cosmicLink._json;\n\n            if (cosmicLink._transaction) {\n              _context4.next = 9;\n              break;\n            }\n\n            _context4.next = 7;\n            return convert.tdescToTransaction(cosmicLink, cosmicLink.tdesc);\n\n          case 7:\n            cosmicLink._transaction = _context4.sent;\n            delete cosmicLink._tdesc;\n\n          case 9:\n            delete cosmicLink._transaction._cosmicplus;\n            _context4.next = 12;\n            return signersUtils[\"extends\"](cosmicLink, cosmicLink._transaction);\n\n          case 12:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n  return _applyLock.apply(this, arguments);\n}\n\naction.sign =\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2(cosmicLink) {\n    var transaction,\n        allFine,\n        _len,\n        keypairsOrPreimage,\n        _key,\n        index,\n        keypair,\n        publicKey,\n        _short,\n        _short2,\n        _short3,\n        _args2 = arguments;\n\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (cosmicLink.locker) {\n              _context2.next = 2;\n              break;\n            }\n\n            throw new Error(\"cosmicLink is not locked.\");\n\n          case 2:\n            transaction = cosmicLink.transaction;\n            allFine = true;\n\n            for (_len = _args2.length, keypairsOrPreimage = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n              keypairsOrPreimage[_key - 1] = _args2[_key];\n            }\n\n            if (!(typeof keypairsOrPreimage[0] !== \"string\")) {\n              _context2.next = 33;\n              break;\n            }\n\n            _context2.t0 = _regeneratorRuntime.keys(keypairsOrPreimage);\n\n          case 7:\n            if ((_context2.t1 = _context2.t0()).done) {\n              _context2.next = 31;\n              break;\n            }\n\n            index = _context2.t1.value;\n            keypair = keypairsOrPreimage[index];\n            publicKey = keypair.publicKey();\n\n            if (cosmicLink.transaction.hasSigner(publicKey)) {\n              _context2.next = 16;\n              break;\n            }\n\n            _short = misc.shorter(publicKey);\n            status.error(cosmicLink, \"Not a legit signer: \" + _short);\n            allFine = false;\n            return _context2.abrupt(\"continue\", 7);\n\n          case 16:\n            if (!cosmicLink.transaction.hasSigned(publicKey)) {\n              _context2.next = 18;\n              break;\n            }\n\n            return _context2.abrupt(\"continue\", 7);\n\n          case 18:\n            _context2.prev = 18;\n            transaction.sign(keypair);\n            _context2.next = 29;\n            break;\n\n          case 22:\n            _context2.prev = 22;\n            _context2.t2 = _context2[\"catch\"](18);\n            console.error(_context2.t2);\n            _short2 = misc.shorter(publicKey);\n            status.error(cosmicLink, \"Failed to sign with key: \" + _short2);\n            allFine = false;\n            return _context2.abrupt(\"continue\", 7);\n\n          case 29:\n            _context2.next = 7;\n            break;\n\n          case 31:\n            _context2.next = 34;\n            break;\n\n          case 33:\n            try {\n              transaction.signHashX(keypairsOrPreimage[0]);\n            } catch (error) {\n              console.error(error);\n              _short3 = misc.shorter(keypairsOrPreimage[0]);\n              status.error(cosmicLink, \"Failed to sign with preimage: \" + _short3, \"throw\");\n            }\n\n          case 34:\n            /// Update other formats.\n            [\"_query\", \"_xdr\", \"_sep7\"].forEach(function (format) {\n              return delete cosmicLink[format];\n            });\n            updateSignersNode(cosmicLink);\n\n            if (allFine) {\n              _context2.next = 40;\n              break;\n            }\n\n            throw new Error(\"Some signers where invalid\");\n\n          case 40:\n            return _context2.abrupt(\"return\", transaction);\n\n          case 41:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[18, 22]]);\n  }));\n\n  return function (_x4) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nfunction updateSignersNode(cosmicLink) {\n  if (cosmicLink._signersNode) {\n    var signersNode = format.signatures(cosmicLink, cosmicLink._transaction);\n    cosmicLink.htmlDescription.replaceChild(signersNode, cosmicLink._signersNode);\n    cosmicLink._signersNode = signersNode;\n  }\n}\n/**\n * Send CosmicLink's transaction to a blockchain validator, or to\n * [StellarGuard]{@link https://stellarguard.me} when relevant. A\n * CosmicLink have to be [locked]{@link CosmicLink#lock} before sending.\n *\n * Returns a promise that resolve/reject to the horizon server response.\n *\n * @example\n * cosmicLink.send()\n *   .then(console.log)\n *   .catch(console.error)\n *\n * @alias CosmicLink#send\n * @param {horizon} [horizon] An horizon node URL\n * @return {Object} The server response\n */\n\n\naction.send =\n/*#__PURE__*/\nfunction () {\n  var _ref3 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee3(cosmicLink) {\n    var horizon,\n        _args3 = arguments;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            horizon = _args3.length > 1 && _args3[1] !== undefined ? _args3[1] : cosmicLink.horizon;\n\n            if (cosmicLink.locker) {\n              _context3.next = 3;\n              break;\n            }\n\n            throw new Error(\"cosmicLink is not locked.\");\n\n          case 3:\n            _context3.prev = 3;\n\n            if (!cosmicLink.transaction.hasSigner(STELLARGUARD_PUBKEY)) {\n              _context3.next = 10;\n              break;\n            }\n\n            _context3.next = 7;\n            return sendToStellarGuard(cosmicLink);\n\n          case 7:\n            return _context3.abrupt(\"return\", _context3.sent);\n\n          case 10:\n            if (!cosmicLink.callback) {\n              _context3.next = 16;\n              break;\n            }\n\n            _context3.next = 13;\n            return axios.post(cosmicLink.callback, {\n              xdr: cosmicLink.xdr\n            });\n\n          case 13:\n            return _context3.abrupt(\"return\", _context3.sent);\n\n          case 16:\n            _context3.next = 18;\n            return sendToHorizon(cosmicLink, horizon);\n\n          case 18:\n            return _context3.abrupt(\"return\", _context3.sent);\n\n          case 19:\n            _context3.next = 25;\n            break;\n\n          case 21:\n            _context3.prev = 21;\n            _context3.t0 = _context3[\"catch\"](3);\n            if (_context3.t0.response) console.error(_context3.t0.message, _context3.t0.response);\n            throw _context3.t0;\n\n          case 25:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[3, 21]]);\n  }));\n\n  return function (_x5) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n\nfunction sendToHorizon(_x6, _x7) {\n  return _sendToHorizon.apply(this, arguments);\n}\n\nfunction _sendToHorizon() {\n  _sendToHorizon = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee5(cosmicLink, horizon) {\n    var server;\n    return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            server = resolve.server(cosmicLink, horizon); // Keep connection alive until transaction gets validated or a non-504 error\n            // is returned. 504 error means the transaction is still following the\n            // validation process.\n            // eslint-disable-next-line no-constant-condition\n\n          case 1:\n            if (!true) {\n              _context5.next = 14;\n              break;\n            }\n\n            _context5.prev = 2;\n            _context5.next = 5;\n            return server.submitTransaction(cosmicLink.transaction);\n\n          case 5:\n            return _context5.abrupt(\"return\", _context5.sent);\n\n          case 8:\n            _context5.prev = 8;\n            _context5.t0 = _context5[\"catch\"](2);\n\n            if (!(_context5.t0.response.status !== 504)) {\n              _context5.next = 12;\n              break;\n            }\n\n            throw _context5.t0;\n\n          case 12:\n            _context5.next = 1;\n            break;\n\n          case 14:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5, null, [[2, 8]]);\n  }));\n  return _sendToHorizon.apply(this, arguments);\n}\n\nfunction sendToStellarGuard(cosmicLink) {\n  var url = cosmicLink.network === \"test\" ? \"https://test.stellarguard.me/api/transactions\" : \"https://stellarguard.me/api/transactions\";\n  return axios.post(url, {\n    xdr: cosmicLink.xdr,\n    callback: cosmicLink.callback\n  }).then(function (result) {\n    return result.data;\n  });\n}\n\nvar STELLARGUARD_PUBKEY = \"GCVHEKSRASJBD6O2Z532LWH4N2ZLCBVDLLTLKSYCSMBLOYTNMEEGUARD\";","\"use_strict\";\n/**\n * Asynchronously load external ressources.\n */\n\n/**/\n\nvar _regeneratorRuntime = require(\"@babel/runtime/regenerator\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator = require(\"@babel/runtime/helpers/asyncToGenerator\");\n\nvar load = require(\"@cosmic-plus/domutils/es5/load\");\n\nmodule.exports = load;\n/**\n *\n * Load cosmic-lib CSS from **href** or from default origin. All subsequent\n * calls will refer to the original request.\n *\n * @example\n * /// Preload at the start of your script:\n * cosmicLib.load.styles('css/cosmic-lib.css')\n *\n * /// Then wait for the request to resolve before you display CosmicLink HTML\n * /// description:\n * await cosmicLib.load.styles()\n *\n * @alias module:load#styles\n * @async\n * @param {string} [href='cosmic-lib.css']\n */\n\nload.styles =\n/*#__PURE__*/\n_asyncToGenerator(\n/*#__PURE__*/\n_regeneratorRuntime.mark(function _callee() {\n  var href,\n      promise,\n      _args = arguments;\n  return _regeneratorRuntime.wrap(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          href = _args.length > 0 && _args[0] !== undefined ? _args[0] : \"https://cdn.cosmic.plus/cosmic-lib@2.x/cosmic-lib.css\";\n          promise = load.css(href);\n\n          load.styles = function () {\n            return promise;\n          };\n\n          return _context.abrupt(\"return\", promise);\n\n        case 4:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _callee);\n}));","\"use strict\"\n/**\n * Markets statistics & data\n *\n * @exports marketData\n */\nconst marketData = exports\n\nconst axios = require(\"@cosmic-plus/base/es5/axios\")\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\n\nconst global = require(\"./global\")\nconst History = require(\"./history\")\n\n/**\n * Generic price/history\n */\n\nmarketData.assetHistory = async function (asset, limit = 1000) {\n  // Remove old prices cache from version <= 0.9.1\n  // REMOVAL: 2020-07 (one year)\n  delete localStorage[`prices.${asset.code}`]\n\n  const cache = History.getCache(asset.id)\n\n  if (cache) {\n    const missing = History.missingDays(cache)\n    if (!missing) return cache\n    if (cache.length) limit = missing + 3\n  }\n\n  const newData = await getPriceHistory(asset, limit)\n  if (!newData) return\n\n  const history = cache ? History.join(cache, newData) : newData\n  History.cut(history, 1000)\n\n  History.setCache(asset.id, history)\n  return history\n}\n\nfunction getPriceHistory (asset, limit) {\n  if (asset.type === \"crypto\") return marketData.crypto.history(asset, limit)\n  else if (asset.type === \"fiat\") return marketData.fiat.history(asset, limit)\n}\n\n/**\n * Crypto price/history by \"https://www.coingecko.com\"\n */\n\nmarketData.crypto = {}\n\nfunction coingeckoCall (page, params) {\n  return axios.get(`https://api.coingecko.com/api/v3/${page}`, { params })\n}\n\nmarketData.crypto.list = async function () {\n  const response = await coingeckoCall(\"coins/list\")\n  const list = {}\n  response.data.forEach(entry => {\n    const symbol = entry.symbol.toUpperCase()\n    list[symbol] = { apiId: entry.id, name: entry.name }\n  })\n  return list\n}\n\nmarketData.crypto.stellarNative = async function () {\n  const response = await coingeckoCall(\"exchanges/stellar_term\")\n  return response.data.tickers.map(x => x.coin_id).filter(x => x)\n}\n\nmarketData.crypto.info = async function (asset) {\n  const response = await coingeckoCall(`coins/${asset.apiId}`, {\n    localization: false,\n    tickers: false,\n    market_data: false,\n    community_data: false,\n    developer_data: false,\n    sparkline: false\n  })\n  return response.data\n}\n\nmarketData.crypto.prices = async function (assets) {\n  const ids = assets.map(asset => asset.apiId).join(\",\")\n  const quote = global.currency.toLowerCase()\n  const response = await coingeckoCall(\"simple/price\", {\n    ids,\n    vs_currencies: quote\n  })\n  const prices = {}\n  assets.forEach(asset => {\n    const assetData = response.data[asset.apiId]\n    if (assetData) prices[asset.code] = assetData[quote]\n  })\n  return prices\n}\n\nmarketData.crypto.history = async function (asset, limit = 1000) {\n  const response = await coingeckoCall(`coins/${asset.apiId}/market_chart`, {\n    vs_currency: global.currency,\n    days: Math.max(limit, 100)\n  })\n\n  const data = response.data.prices.map((record, index) => {\n    return {\n      time: record[0],\n      price: record[1],\n      // volume: response.data.total_volumes[index][1]\n      volume: +nice(response.data.total_volumes[index][1] / record[1])\n    }\n  })\n\n  // Work around end of serie inconsistencies.\n  const today = History.today()\n  if (data[data.length - 2].time === today) {\n    data.length = data.length - 1\n  } else {\n    History.latest(data).time = today\n  }\n\n  if (limit < 100) History.cut(data, limit)\n  return data\n}\n\n/**\n * Fiat prices / history by \"https://exchangeratesapi.io\"\n */\n\nmarketData.fiat = {}\n\nasync function exchangeratesCall (page, symbols, params = {}) {\n  params.base = global.currency\n  if (typeof symbols === \"string\") {\n    params.symbols = symbols\n  } else {\n    if (global.currency === \"EUR\") symbols = symbols.filter(x => x !== \"EUR\")\n    params.symbols = symbols.join(\",\")\n  }\n  params.source = \"equilibre.io\"\n\n  return axios\n    .get(`https://api.exchangeratesapi.io/${page}`, { params })\n    .then(response => {\n      if (global.currency === \"EUR\" && !response.data.start_at) {\n        response.data.rates.EUR = 1\n      }\n      return response\n    })\n}\n\nmarketData.fiat.prices = async function (assets) {\n  const symbols = assets.map(asset => asset.code)\n  const response = await exchangeratesCall(\"latest\", symbols)\n  const data = response.data.rates\n  for (let symbol in data) {\n    data[symbol] = nice(1 / data[symbol], 8)\n  }\n  return data\n}\n\nmarketData.fiat.history = async function (asset, limit = 1000) {\n  const end_at = new Date().toISOString().slice(0, 10)\n  const today = new Date(end_at)\n  today.setDate(today.getDate() - limit)\n  const start_at = today.toISOString().slice(0, 10)\n\n  // Exchangeratesapi doesn't returns EUR/EUR rate.\n  if (global.currency === \"EUR\" && asset.id === \"EUR\") {\n    return [{ time: History.today(), price: 1 }]\n  }\n\n  // Get history.\n  const response = await exchangeratesCall(\"history\", asset.code, {\n    start_at,\n    end_at\n  })\n\n  // Format data.\n  const data = Object.keys(response.data.rates)\n    .sort()\n    .map(date => {\n      return {\n        time: History.time(date),\n        price: +nice(1 / response.data.rates[date][asset.code], 8)\n      }\n    })\n\n  // Add today's entry.\n  if (History.latest(data).time !== History.today()) {\n    data.push({\n      time: History.today(),\n      price: History.latest(data).price\n    })\n  }\n\n  return data\n}\n","\"use_strict\";\n/**\n * Aliases handlers & most known Stellar addresses.\n *\n * @private\n * @exports aliases\n */\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.object.assign\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nvar aliases = exports;\n/**\n * Add new **aliases** or replace existing ones.\n *\n * @example\n * cosmicLib.config.addAliases({\n *   'GCKA6K5PCQ6PNF5RQBF7PQDJWRHO6UOGFMRLK3DYHDOI244V47XKQ4GP': 'smartlands.io',\n *   'GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5': 'stellarport.io'\n * })\n *\n * @param {Object} aliases An object such as `{ publicKey1: name1, ..., publicKeyN: nameN }`\n */\n\naliases.set = function (conf, aliases) {\n  conf.aliases = Object.assign(conf.aliases, aliases);\n};\n/**\n * Remove **publicKeys** from aliases list.\n *\n * @example\n * cosmicLib.config.removeAliases([\n *  'GCKA6K5PCQ6PNF5RQBF7PQDJWRHO6UOGFMRLK3DYHDOI244V47XKQ4GP',\n *  'GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5',\n * ])\n *\n * @param {Array} publicKeys An array of public keys\n */\n\n\naliases.remove = function (conf, publicKeys) {\n  publicKeys.forEach(function (entry) {\n    return delete conf.aliases[entry];\n  });\n};\n/**\n * Aliases handlers & most known Stellar addresses. Aliases takes the form:\n *\n * ```js\n * {\n *   'publicKey1': 'name1',\n *   'publicKey2': 'name2',\n *    ...\n *   'publicKeyN': 'nameN'\n * }\n * ```\n *\n * Aliases are only used as a displaying sugar and can't be used as a\n * replacement for federated address as it would lead to security issues.\n */\n\n\naliases.all = {\n  GDZCEWJ5TVXUTFH6V5CVDQDE43KRXYUFRHKI7X64EWMVOVYYZJFWIFQ2: \"aex.com\",\n  GASWJWFRYE55KC7MGANZMMRBK5NPXT3HMPDQ6SEXZN6ZPWYXVVYBFRTE: \"anchorusd.com\",\n  GDUKMGUGDZQK6YHYA5Z6AY2G4XDSZPSZ3SW5UN3ARVMO6QSRDWP5YLEX: \"anchorusd.com\",\n  GAEGOS7I6TYZSVHPSN76RSPIVL3SELATXZWLFO4DIAFYJF7MPAHFE7H4: \"apay.io\",\n  GAUTUYY2THLF7SGITDFMXJVYH3LHDSMGEAKSBU267M2K7A3W543CKUEF: \"apay.io\",\n  GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR: \"apay.io\",\n  GC5LOR3BK6KIOK7GKAUD5EGHQCMFOGHJTC7I3ELB66PTDFXORC2VM5LP: \"apay.io\",\n  GCYKQ2627BPKMSUZJK64GPYVKD4TRNACP45X6B754PR6TCYJXCHGUTWB: \"apiscapitalfunds.com\",\n  GAUWES2POH347NNJGRI4OBM34LMOCMWSTZ3RAOZMOBH4PFVBWFMHLNTC: \"astral9.io\",\n  GDZURZR6RZKIQVOWZFWPVAUBMLLBQGXP2K5E5G7PEOV75IYPDFA36WK4: \"atlantisblue.org\",\n  GABQBEZCNQRUHURCG6E2UZC6QXXEPLALHBVA6J6IQNKNJL66VPY7FO7G: \"auskunft.de\",\n  GACVB2E6IEV2UT6IDVOO5B5CNN7WPKJFR36B7KD7ZNXDANPTSYNMZYQM: \"binance.com\",\n  GAHK7EEG2WWHVKDNT4CEQFZGKF2LGDSW2IVM4S5DP42RBW3K6BTODB4A: \"binance.com\",\n  GCO2IP3MJNUOKS4PUDI4C7LGGMQDJGXG3COYX3WSB4HHNAHKYV5YL3VC: \"binance.com\",\n  GBOXNWGBB7SG3NVIA7O25M7JIRSXQ4KKU3GYARJEFMQXSR3APF3KRI6S: \"bitbox.one\",\n  GAWPTHY6233GRWZZ7JXDMVXDUDCVQVVQ2SXCSTG3R3CNP5LQPDAHNBKL: \"bitfinex.com\",\n  GD4J347D3NT267QWCMJDZKJPEQFO2VENLZV6NUHFJQIDVMHGPWYRZ2BC: \"bitgo.com\",\n  GB6YPGW5JFMMP2QB2USQ33EUWTXVL4ZT5ITUNCY3YKVWOJPP57CANOF3: \"bittrex.com\",\n  GDZHCJ73D23MJ76OAR2NQQICB3D3ENUPFT6KVYON3KXY73U6SWN25SU5: \"bittrex.com\",\n  GBBAMI2WU6WJHDL3CQKT4LPXUC76WCEMQJMJIVQGL2G5IKJ2JHEVHG3G: \"bitx.tk\",\n  GATTH3VPK4PMXLE7JSEJ3OC72OYOGJYINLHSCJX365BP6SAV6GKSHJAV: \"bostravel.online\",\n  GB7GRJ5DTE3AA2TCVHQS2LAD3D7NFG7YLTOEWEBVRNUUI2Q3TJ5UQIFM: \"btc38.com\",\n  GB3RMPTL47E4ULVANHBNCXSXM2ZA5JFY5ISDRERPCXNJUDEO73QFZUNK: \"cex.io\",\n  GBV4ZDEPNQ2FKSPKGJP2YKDAIZWQ2XKRQD4V4ACH3TCTFY6KPY3OAVS7: \"changelly.com\",\n  GBRPTWEZTUKYM6VJXLHXBFI23M2GSY3TCVIQSZKFQLMOJXH7VPDGKBDP: \"charnatoken.top\",\n  GBOAYBE3NJKS4WPIVM2H5DVFIDYLAHHD2DAWYL5LLUVYF77M3JIVGCTR: \"citron.cash\",\n  GCJGYOH2EYW6FFISLBA3L3R3PUYCQ6DQ47GXVAMG7JLLIKPAPV3RLBSV: \"citron.cash\",\n  GBDUXW4E5WRM5EM6UXBLE7Y5XGSXJX472BSSBPKFPQ3PJCJHRIA6SH4C: \"coinbase.com\",\n  GBP4RYNGHJXLLSMUA4ZXE7TZBN7ILFUTLTIKUJFJQGALD3764HJBB5AX: \"coinbase.com\",\n  GDQP2KPQGKIHYJGXNUIYOMHARUARCA7DJT5FO2FFOOKY3B2WSQHG4W37: \"coinbase.com\",\n  GBUQWP3BOUZX34TOND2QV7QQ7K7VJTG6VSE7WMLBTMDJLLAW7YKGU6EP: \"coins.asia\",\n  GAWODAROMJ33V5YDFY3NPYTHVYQG7MJXVJ2ND3AOGIHYRWINES6ACCPD: \"cowrie.exchange\",\n  GDMXNQBJMS3FYI4PFSYCCB4XODQMNMTKPQ5HIKOUWBOWJ2P3CF6WASBE: \"cryptomkt.com\",\n  GA4BYMUO5D7OLGVJWZ2D5FCWU7SB63FNZ4QUU574SMNA6ELK5TZD3SO3: \"cryptomover.com\",\n  GABSZVZBYEO5F4V5LZKV7GR4SAJ5IKJGGOF43BIN42FNDUG7QPH6IMRQ: \"cryptomover.com\",\n  GBWZHAVWY23QKKDJW7TXLSIHY5EX4NIB37O4NMRKN2SKNWOSE5TEPCY3: \"cryptomover.com\",\n  GCVBUIXKKLH2DYHZRSLZUIZSVJUL74RTW6FVCCEYB2OE3RH7RVDBPCFG: \"cryptomover.com\",\n  GDBCHKTHJUKDGSIQSTBUXFWVP3QVART5LED6KRZQ5X4Z5WLT4BGYXWCI: \"cryptomover.com\",\n  GDU2FEL6THGGOFDHHP4I5FHNWY4S2SXYUBCEDB5ZREMD6UFRT4SYWSW2: \"cryptomover.com\",\n  GD7UVDDJHJYKUXB4SJFIC6VJDQ4YADQCMRN3KLHJFV4H6NIUAEREVCO7: \"cryptotari.io\",\n  GCGEQJR3E5BVMQYSNCHPO6NPP3KOT4VVZHIOLSRSNLE2GFY7EWVSLLTN: \"equid.co\",\n  GBKTJSNUSR6OCXA5WDWGT33MNSCNQHOBQUBYC7TVS7BOXDKWFNHI4QNH: \"exrates.me\",\n  GAQ6W5I7LIWQAE47ZY7EQWRVVF2JELYXG6OKL7HHOSL5MWVEIGRPGYCO: \"factrpay.io\",\n  GAZEX2USUBMMWFRZFS77VDJYXUFLXI4ZGFPWX6TBNZCSTEQWNLFZMXFF: \"fchain.io\",\n  GBETHKBL5TCUTQ3JPDIYOZ5RDARTMHMEKIO2QZQ7IOZ4YC5XV3C2IKYU: \"fchain.io\",\n  GCMS2VO5ANJCESJBZVC3INFSETS3K4UWMU47W7KSQ2BYASEQAN4NUSTM: \"fchain.io\",\n  GCNY5OXYSY4FKHOPT2SPOQZAOEIGXB5LBYW3HVU3OWSTQITS65M5RCNY: \"fchain.io\",\n  GCC4YLCR7DDWFCIPTROQM7EB2QMFD35XRWEQVIQYJQHVW6VE5MJZXIGW: \"flutterwave.com\",\n  GC75WHUIMU7LV6WURMCA5GGF2S5FWFOK7K5VLR2WGRKWKZQAJQEBM53M: \"frasindo.com\",\n  GBUAVXCI7JKH6D2ZHZ6KZ7Z5MHHCXHI4DSUUC4KOISDMRPVY3MRBF3OY: \"freight-coin.com\",\n  GDGDECMFS34OVTQJKTCHORPE7LOYDH2XYNRMUHLGCJFP56VUN6AW5LCF: \"freight-coin.com\",\n  GBUYUAI75XXWDZEKLY66CFYKQPET5JR4EENXZBUZ3YXZ7DS56Z4OKOFU: \"funtracker.site\",\n  GDRSWSKJCIB6Z65UA7W5RG62A7M5K3A5IHMED6DYHLPLWLVQCOOGDQ7S: \"gate.io\",\n  GARFMAHQM4JDI55SK2FGEPLOZU7BTEODS3Y5QNT3VMQQIU3WV2HTBA46: \"glitzkoin.com\",\n  GDYNTGXBDWARLJ34GRQ4ON4EGBXSTPR5LEDTD5LLOOHPS6EZU6QXIIYO: \"goodx.network\",\n  GCXDR4QZ4OTVX6433DPTXELCSEWQ4E5BIPVRRJMUR6M3NT4JCVIDALZO: \"gopax.co.kr\",\n  GAJ7V3EMD3FRWAPBEJAP7EC4223XI5EACDZ46RFMY5DYOMCIMWEFR5II: \"gratz.io\",\n  GA6KR5DMGJ6OPPG4OONB65JPU3TZE2CWCLKTBV4DHXFA2Z4XKWQSVCTC: \"heir.io\",\n  GB2X6RCO2VAXOD7GXE5VJWXOUTYDKPHIAHJSM2CGZJXKZSIHREEP4654: \"heir.io\",\n  GB6DMQ5IZUPRRMNTPU4H5FX32DRYCZ447REBEQ32YGVPPGZI5MX4AHOT: \"hotoken.io\",\n  GC4KAS6W2YCGJGLP633A6F6AKTCV4WSLMTMIQRSEQE5QRRVKSX7THV6S: \"indodax.com\",\n  GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P: \"interstellar.exchange\",\n  GBBRMEXJMS3L7Y3DZZ2AHBD545GZ72OAEHHEFKGZAHHASHGWMHK5P6PL: \"irene.energy\",\n  GANZBUS4726LBT2CBJ3BGF3TP4NJT5MHZMI423NHMXFRWGO2DCBQEXYZ: \"jetmint.org\",\n  GCQHDR2KSCVNULFX3C2NKFEXNJEUELJVMQAN3OCLAM5KXG4DWQSRMXYZ: \"jetmint.org\",\n  GD4T35DMXYDE7BJWYPUWK43VFJO5IBUQYG2YGMICPTWP4JTNWQELKAVA: \"kava.world\",\n  GBTBVILDGCOIK26EPEHYCMKM7J5MTQ4FD5DO37GVTTBP45TVGRAROQHP: \"koinex.in\",\n  GA5XIGA5C7QTPTWXQHY6MCJRMTRZDOSHR6EFIBNDQTCQHG262N4GGKTM: \"kraken.com\",\n  GB6JTIT5PHAZA4VMFI7TGGG44TE3LEDFPG52GSKBZOPDDDMNJAGSF46T: \"kucoin.com\",\n  GBJNV2MQA7M5GNBRDFW46JLXIN7ZLYVVM4UW4CWDZO4KZKXIXCRYHMH2: \"kucoin.com\",\n  GCTLB7LW7B5ON4QIBIDEWA7MC2KJL2NZEXK24RU32QNOB5IMMCGNLMBD: \"kucoin.com\",\n  GC3L2FLR2QMUSOJ6QMQHKIWUKEXGOXSIN2KY72SDUHPC2KO6HOSQIXIF: \"levelg.net\",\n  GD2RRX6BKVTORZ6RIMBLWFVUOAYOLTS2QFJQUQPXLI3PBHR3TMLQNGZX: \"liquido.cc\",\n  GCCD6AJOYZCUAQLX32ZJF2MKFFAUJ53PVCFQI3RHWKL3V47QYE2BNAUT: \"lumenaut.net\",\n  GBVB43NLVIP2USHXSKI7QQCZKZU2Z6U6A5PAHMIW7LLNVMQJTOX2BZI5: \"luxpayband.io\",\n  GDTEQF6YGCKLIBD37RJZE5GTL3ZY6CBQIKH7COAW654SYEBE6XJJOLOW: \"luxpayband.io\",\n  GD2YURFWC5LIRLM4CCVZZHCFV6WXO46VOSBBPTJG6MPQN6ANYZZOLQJL: \"martialartscoin.io\",\n  GA6HCMBLTZS5VYYBCATRBRZ3BZJMAFUDKYYF6AH6MVCMGWMRDNSWJPIH: \"mobius.network\",\n  GAKBPBDMW6CTRDCXNAPSVJZ6QAN3OBNRG6CWI27FGDQT2ZJJEMDRXPKK: \"moni.com\",\n  GB56YLTH5SDOYTUGPWY5MXJ7VQTY7BEM2YVJZTN5O555VA6DJYCTY2MP: \"moonpool.space\",\n  GATEMHCCKCY67ZUCKTROYN24ZYT5GK4EQZ65JJLDHKHRUZI3EUEKMTCH: \"naobtc.com\",\n  GAXELY4AOIRVONF7V25BUPDNKZYIVT6CWURG7R2I6NQU26IQSQODBVCS: \"naobtc.com\",\n  GBTCBCWLE6YVTR5Y5RRZC36Z37OH22G773HECWEIZTZJSN4WTG3CSOES: \"naobtc.com\",\n  GD6RMKTCHQGEOGYWIKSY5G7QWXPZOAEZIKPKEVZUAXOQCZRVBRRFGLJM: \"nydro.energy\",\n  GDNXSZSF7HIGVRL2LG6VWXN5PWV3KHI77DQTHLLPKNPLUZFKRRDQJBXP: \"nydro.energy\",\n  GBOEEVARKVASOQSSXCAHNTGJTVALJE2QM3AQQ2K3VXACQ6JJREQRJZKB: \"okex.com\",\n  GDPB3BGHJAHAKVIWUNLST7N6OGZ73W6AUAI7QDZJW26LEWL46VDAKBH6: \"old.repocoin.io\",\n  GCVWTTPADC5YB5AYDKJCTUYSCJ7RKPGE4HT75NIZOUM4L7VRTS5EKLFN: \"old.sureremit.co\",\n  GBGVRE5DH6HGNYNLWQITKRQYGR4PWQEH6MOE5ELPY3I4XJPTZ7CVT4YW: \"papayabot.com\",\n  GBR3RS2Z277FER476OFHFXQJRKYSQX4Z7XNWO65AN3QPRUANUASANG3L: \"papayabot.com\",\n  GBVUDZLMHTLMZANLZB6P4S4RYF52MVWTYVYXTQ2EJBPBX4DZI2SDOLLY: \"pedity.com\",\n  GBIL5TOVTZFNV3XS3E2LWTKU5SYOJ3UBCVBSKAMP4EE4MV2VSZQK7NRZ: \"pigzbe.com\",\n  GBQWA6DU6OXHH4AVTFCONQ76LHEWQVZAW7SFSW4PPCAI2NX4MJDZUYDW: \"piiko.co\",\n  GAJWJTV5GW5J2WCBPQNWLAL2EYUIIUB6OIROHOV7YVJJWZXPXQWSMHRH: \"points.network\",\n  GCGNWKCJ3KHRLPM3TM6N7D3W5YKDJFL6A2YCXFXNMRTZ4Q66MEMZ6FI2: \"poloniex.com\",\n  GAZPKDTEZ5UM3BF4E7FL7EMXRMLH76F2TNVXRLOF6SCVXOFWSPCEWFI5: \"pr.network\",\n  GCZNF24HPMYTV6NOEHI7Q5RJFFUI23JKUKY3H3XTQAFBQIBOHD5OXG3B: \"repocoin.io\",\n  GAREELUB43IRHWEASCFBLKHURCGMHE5IF6XSE7EXDLACYHGRHM43RFOX: \"ripplefox.com\",\n  GCLDH6L6FBLTD3H3B23D6TIFVVTFBLZMNBC3ZOI6FGI5GPQROL4FOXIN: \"ripplefox.com\",\n  GB2WB73G5IWRXEUTJANAIF52JFTDXOXORAP4S5HZRW23TZG2ONDVZMVA: \"scopuly.com\",\n  GDMS6EECOH6MBMCP3FYRYEVRBIV3TQGLOFQIPVAITBRJUMTI6V7A2X6Z: \"six.network\",\n  GCKA6K5PCQ6PNF5RQBF7PQDJWRHO6UOGFMRLK3DYHDOI244V47XKQ4GP: \"smartlands.io\",\n  GAIGG2ICK2ATV7VUQC6MZHOSMRMFJK3T65IVNUZ7EJEEAU5UJQPPDIST: \"steemanchor.com\",\n  GB3KBOFUCVTWEZ7YIZ7PAKLQMKPCTGWU3LOMANMCT7V6I3AAK4USTEEM: \"steemanchor.com\",\n  GCVHEKSRASJBD6O2Z532LWH4N2ZLCBVDLLTLKSYCSMBLOYTNMEEGUARD: \"stellarguard.me\",\n  GA6D2S6XDBT7WZIZNDGUBLXUGDAGLZGZ2SYT2JLXD4BB2W76XS66FZ2S: \"stellar.org\",\n  GAENIE5LBJIXLMJIAJ7225IUPA6CX7EGHUXRX5FLCZFFAQSG2ZUYSWFK: \"stellar.org\",\n  GANOI26P6VAUL4NFVA4FAIOIBOR46NORONBIWUPRIGAMP7T5W5MOY4O6: \"stellar.org\",\n  GAX3BRBNB5WTJ2GNEFFH7A4CZKT2FORYABDDBZR5FIIT3P7FLS2EFOZZ: \"stellar.org\",\n  GAYOCVRRNXGQWREOZBDP4UEW475NKZKLA4EIEIBKBSJN2PQQWUQ5KGUH: \"stellar.org\",\n  GB6NVEN5HSUBKMYCE5ZOWSK5K23TBWRUQLZY3KNMXUZ3AQ2ESC4MY4AQ: \"stellar.org\",\n  GBEZOC5U4TVH7ZY5N3FLYHTCZSI6VFGTULG7PBITLF5ZEBPJXFT46YZM: \"stellar.org\",\n  GBVVWWN4YP76FKGO7RB42FSZDYD2PBXY2PJY3F6JJWLYU74TKUG775UP: \"stellar.org\",\n  GCO4EFT6KUOQKVZO2O4GR5CJKMARBORXRE7KAKH36ZFAX662ZHINQ6UA: \"stellar.org\",\n  GDKIJJIKXLOM2NRMPNQZUUYK24ZPVFC6426GZAEP3KUK6KEJLACCWNMX: \"stellar.org\",\n  GDTNE54IWDB3UQLMIUSBKIDTMUW7FNKBU4VB2GVW4OL65BZN7W5VRNVY: \"stellar.org\",\n  GDUY7J7A33TQWOSOQGDO776GGLM3UQERL4J3SPT56F6YS4ID7MLDERI4: \"stellar.org\",\n  GDWNY2POLGK65VVKIH5KQSH7VWLKRTQ5M6ADLJAYC2UEHEBEARCZJWWI: \"stellar.org\",\n  GA5Z7QOQFSNIFFRZ3CDHLOWRPBWHPX5EGCTKT5KXU2CGJD7EIK2ZMALP: \"stellarpay.org\",\n  GAMA33LC7FK5RF4XE5HOVX456GX4VHDZUCJ7APY4TZ4IHG65ZWVXD333: \"stellarpay.org\",\n  GAYYPNEDENPNDNVPQD7U54JXMZZYTZAHWJLRRWBLP5PU6PBRSLH7LKNA: \"stellarpay.org\",\n  GBNWX7R4WVOWEYVKWN7KJ773X6C7OKNIGMVVDQI4B7XXMR6Y4OCUTBX2: \"stellarpay.org\",\n  GC2PJ6J37QM3DOQ63DVGCXTRC5QOKAJUBQO2XKBXOJCWTCOCP75KWUDX: \"stellarpay.org\",\n  GCAIDZBFE3WEIZSXQONQKUUTG6VLVKG2BBJYGWKEHQ2FZZ76VR326WYW: \"stellarpay.org\",\n  GCE3XS3D2F2W5LQWZHLG25ANAFIQOVMORH46JHVXOMW3FN27IPVJEGGG: \"stellarpay.org\",\n  GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5: \"stellarport.io\",\n  GDCHDRSDOBRMSUDKRE2C4U4KDLNEATJPIHHR2ORFL5BSD56G4DQXL4VW: \"stellarterm.com\",\n  GAFXX2VJE2EGLLY3EFA2BQXJADAZTNR7NC7IJ6LFYPSCLE7AI3AK3B3M: \"stemchain.io\",\n  GBSTRH4QOTWNSVA6E4HFERETX4ZLSR3CIUBLK7AXYII277PFJC4BBYOG: \"stronghold.co\",\n  GBSTRUSD7IRX73RQZBL3RQUH6KS3O4NYFY3QCALDLZD77XMZOPWAVTUK: \"stronghold.co\",\n  GCSTRLTC73UVXIYPHYTTQUUSDTQU2KQW5VKCE4YCMEHWF44JKDMQAL23: \"stronghold.co\",\n  GDSTRSHXHGJ7ZIVRBXEYE5Q74XUVCUSEKEBR7UCHEUUEK72N7I7KJ6JH: \"stronghold.co\",\n  GCEGERI7COJYNNID6CYSKS5DPPLGCCLPTOSCDD2LG5SJIVWM5ISUPERI: \"superlumen.org\",\n  GCZYLNGU4CA5NAWBAVTHMZH4JXWKP2OUJ6OK3I7XXZCNA5622WUJVLTG: \"sureremit.co\",\n  GDEGOXPCHXWFYY234D2YZSPEJ24BX42ESJNVHY5H7TWWQSYRN5ZKZE3N: \"sureremit.co\",\n  GCTXRQIYWEDP6G7OXZI6IXUSIXHHSN5NKYRB3NI5J4Z7G5JMIBHLLBTC: \"tamm.fund\",\n  GAP5LETOV6YIE62YAM56STDANPRDO7ZFDBGSNHJQIYGGKSMOZAHOOS2S: \"tempo.eu.com\",\n  GDGQDVO6XPFSY4NMX75A7AOVYCF5JYGW2SHCJJNWCQWIDGOZB53DGP6C: \"ternio.io\",\n  GDS3XDJAA4VY6MJYASIGSIMPHZ7AQNZ54RKLWT7MWCOU5YKYEVCNLVS3: \"thefutbolcoin.io\",\n  GDSVWEA7XV6M5XNLODVTPCGMAJTNBLZBXOFNQD3BNPNYALEYBNT6CE2V: \"thewwallet.com\",\n  GBFJGO46OV6E2QS2ZUMCF256ZL4BFOZWFHULRNLPSPW47HH5HFAKJTON: \"tontinetrust.com\",\n  GAKRDXBHA2TTOYJZQIAQ7ZDS555P24RAYRUUZWU3KHSLIOZMVV4IITXT: \"traxalt.com\",\n  GAW4E6NGM4NPNX2LO2BKDPCCTUX3FJLKWHPU4VQPGBIBQGD6JTVF5C7C: \"upbit.com\",\n  GCNHYZLBCSVZHSQJ2DOIBHYBF4J24DJYGS5QKURX4AGSLBK6SDJOYWIN: \"winsome.gift\",\n  GASBLVHS5FOABSDNW5SPPH3QRJYXY5JHA2AOA2QHH2FJLZBRXSG4SWXT: \"wirexapp.com\",\n  GBOFQCVZF2DSFLJPJMKH7CIECCN7TYVAT2CSD73IVEBJJQU2VW6JNFHT: \"wirexapp.com\",\n  GBZ35ZJRIKJGYH5PBKLKOZ5L6EXCNTO7BKIL7DAVVDFQ2ODJEEHHJXIM: \"ximcoin.com\",\n  GAO4DADCRAHA35GD6J3KUNOB5ELZE5D6CGPSJX2WBMEQV7R2M4PGKJL5: \"xirkle.com\",\n  GA3FUYFOPWZ25YXTCA73RK2UGONHCO27OHQRSGV3VCE67UEPEFEDCOPA: \"xlmpool.com\",\n  GDSRCV5VTM3U7Y3L6DFRP3PEGBNQMGOWSRTGSBWX6Z3H6C7JHRI4XFJP: \"x.token.io\"\n};","\"use strict\"\n/**\n * Account offers\n */\n\nconst cosmicLib = require(\"cosmic-lib\")\nconst loopcall = require(\"@cosmic-plus/loopcall\")\nconst Mirrorable = require(\"@cosmic-plus/jsutils/es5/mirrorable\")\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\nconst hiddenKey = require(\"@cosmic-plus/jsutils/es5/misc\").setHiddenProperty\nconst { day } = require(\"@cosmic-plus/jsutils/es5/misc\")\n\nconst Asset = require(\"./asset\")\nconst Balance = require(\"./balance\")\n\nconst { fixed7 } = require(\"../helpers/misc\")\n\n/**\n * Definition: Offers (collection)\n */\n\nclass Offers extends Mirrorable {\n  static forPortfolio (portfolio) {\n    const offers = Offers.forAccount(portfolio.accountId)\n    hiddenKey(offers, \"portfolio\", portfolio)\n    return offers\n  }\n\n  static forAccount (accountId) {\n    const offers = new Offers()\n    hiddenKey(offers, \"accountId\", accountId)\n    hiddenKey(offers, \"callBuilder\", Offers.callBuilder(accountId))\n    return offers\n  }\n\n  static callBuilder (accountId) {\n    const server = cosmicLib.resolve.server()\n    return server.offers(\"accounts\", accountId)\n  }\n\n  async stream (delay = 15000) {\n    // Resolves after first get().\n    return this.get().then(() => setTimeout(() => this.stream(), delay))\n  }\n\n  async get () {\n    try {\n      const records = await loopcall(this.callBuilder, { limit: 200 })\n      this.ingest(records)\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  ingest (records) {\n    this.forEach(offer => offer.alive = false)\n    const offers = records.map(record => Offer.ingest(record)).filter(x => x)\n    this.splice(0, 0, ...offers)\n    this.clean()\n  }\n\n  clean () {\n    for (let index = this.length - 1; index > -1; index--) {\n      const offer = this[index]\n      if (!offer.alive) {\n        this.splice(index, 1)\n        offer.destroy()\n      }\n    }\n  }\n}\n\n/**\n * Utilities\n */\n\nOffers.prototype.listOutdated = function () {\n  return this.filter(offer => offer.outdated)\n}\n\n/**\n * Definition: Offer (one)\n */\n\nclass Offer extends Projectable {\n  static resolve (record) {\n    return Offer.table[recordToId(record)]\n  }\n\n  static ingest (record) {\n    const offer = Offer.resolve(record)\n    if (offer) offer.update(record)\n    else return new Offer(record)\n  }\n\n  constructor (record) {\n    super()\n\n    this.intern = recordToId(record)\n    Offer.table[this.intern] = this\n\n    const quote = Asset.resolve(\"XLM\")\n    const asset = record.buying.asset_code ? record.buying : record.selling\n    this.balance = Balance.resolve(asset.asset_code, asset.asset_issuer)\n    this.asset = this.balance.asset\n    this.side = record.buying.asset_code ? \"buy\" : \"sell\"\n\n    this.define(\n      \"price\",\n      \"rawPrice\",\n      this.side === \"sell\"\n        ? () => quote.price * this.rawPrice\n        : () => quote.price / this.rawPrice\n    )\n    this.watch(quote, \"price\", () => this.compute(\"price\"))\n\n    this.update(record)\n\n    this.balance.offers.push(this)\n    this.asset.offers.push(this)\n\n    this.listen(\"destroy\", () => {\n      delete Offer.table[this.intern]\n      this.balance.offers.splice(this.balance.offers.indexOf(this), 1)\n      this.asset.offers.splice(this.asset.offers.indexOf(this), 1)\n    })\n  }\n\n  update (record) {\n    Object.assign(this, record)\n    this.alive = true\n\n    this.rawPrice = record.price\n    this.compute(\"price\")\n    this.rawAmount = record.amount\n    if (this.side === \"buy\") {\n      this.amount = fixed7(this.rawAmount * this.rawPrice)\n    }\n\n    this.date = day(this.last_modified_time)\n    this.outdated = this.date !== day()\n  }\n}\n\nOffer.table = {}\n\n/**\n * Helpers\n */\n\nfunction recordToId (record) {\n  return `${record.id}-${record.last_modified_ledger}`\n}\n\n/**\n * Export\n */\n\nmodule.exports = Offers\n","\"use strict\"\n/**\n * Compute Historic Value from historic balances\n */\nconst Asset = require(\"./asset\")\nconst portfolioHistoricBalances = require(\"./portfolio-historic-balances\")\nconst { arraySum } = require(\"../helpers/misc\")\n\n/**\n * Function\n */\n\nmodule.exports = async function portfolioHistoricValue (portfolio) {\n  const history = await portfolioHistoricBalances(portfolio)\n  const assets = markHeldAssets(history)\n  const historicPrices = await getHistoricPrices(assets)\n\n  history.forEach(day => {\n    shrinkHistoricPrices(day.time, historicPrices)\n    computeDayValues(day, historicPrices)\n  })\n\n  // eslint-disable-next-line no-console\n  console.log(history)\n  return history\n}\n\nfunction markHeldAssets (history) {\n  const ids = {}\n  history.forEach(day => {\n    Object.keys(day.asset).forEach(key => ids[key] = true)\n  })\n\n  const assets = Object.keys(ids).map(Asset.resolve)\n  assets.forEach(asset => asset.hasBeenHeld = true)\n  return assets\n}\n\n/**\n * Returns an object containing the historic price of each **asset**.\n */\nasync function getHistoricPrices (assets) {\n  const historicPrices = {}\n\n  const promises = assets.map(asset => asset.getHistoricPrice())\n  await Promise.all(promises)\n\n  assets.forEach(asset => {\n    if (asset.historicPrice) historicPrices[asset.id] = asset.historicPrice\n  })\n\n  return historicPrices\n}\n\n/**\n * Remove oldest prices from **historicPrices** until the first element of each\n * serie is the price just before **time**.\n */\nfunction shrinkHistoricPrices (time, historicPrices) {\n  for (let asset in historicPrices) {\n    const prices = historicPrices[asset]\n    const index = prices.findIndex(entry => entry.time > time)\n    if (index > 1) historicPrices[asset] = prices.slice(index - 1)\n    else if (index === -1) historicPrices[asset] = prices.slice(-1)\n  }\n}\n\n/**\n * Computes `price` & `value` fields for portfolio history using\n * **historicPrices**.\n */\nfunction computeDayValues (day, historicPrices) {\n  day.price = {}\n  day.value = {}\n  day.total = 0\n\n  // Compute each asset value at `day.time` as well as the portfolio total.\n  for (let asset in day.asset) {\n    day.price[asset] = historicPrices[asset]\n      ? historicPrices[asset][0].price\n      : 0\n    day.value[asset] = day.asset[asset] * day.price[asset]\n    day.total += day.value[asset]\n  }\n\n  // Filter data for display in chart.\n  day.filtered = {}\n  const marginals = []\n\n  for (let asset in day.value) {\n    const share = day.value[asset] / day.total\n    if (share) {\n      day.filtered[asset] = day.value[asset]\n      if (share < 0.03) marginals.push(asset)\n    }\n  }\n\n  if (marginals.length > 1) {\n    day.filtered.others = arraySum(marginals.map(asset => day.value[asset]))\n    marginals.forEach(asset => delete day.filtered[asset])\n  }\n}\n","\"use strict\"\n/**\n * Account Historic Balances\n */\nconst cosmicLib = require(\"cosmic-lib\")\nconst loopcall = require(\"@cosmic-plus/loopcall\")\n\nconst Asset = require(\"./asset\")\nconst Balance = require(\"./balance\")\nconst History = require(\"./history\")\n\nconst { fixed7 } = require(\"../helpers/misc\")\n\n/**\n * Function\n */\n\nmodule.exports = async function portfolioHistoricBalances (\n  portfolio,\n  limit = 1000\n) {\n  const cache = History.getCache(portfolio.account.id)\n\n  if (cache) {\n    const missing = History.missingDays(cache)\n    if (!missing) return cache\n    if (cache.length) limit = missing + 1\n  }\n\n  const newData = await getPortfolioHistory(portfolio, limit)\n  if (!newData) return\n\n  const history = cache ? History.join(cache, newData) : newData\n  History.cut(history, 1000)\n\n  History.setCache(portfolio.account.id, history)\n  return history\n}\n\nasync function getPortfolioHistory (portfolio, limit = 100) {\n  // Start from today...\n  const day = { time: History.today(), asset: {}, balance: {} }\n  portfolio.balances.forEach(balance => {\n    updateBalance(day, balance, +balance.amount)\n  })\n  const history = [day]\n\n  const loopUntil = Date.now() - History.oneDay * limit\n  await effectsLoopcall(portfolio.accountId, {\n    filter: record => ingestRecord(history, record),\n    breaker: () => history[0].time < loopUntil\n  })\n\n  History.cut(history, limit)\n  return history\n}\n\nfunction ingestRecord (history, record) {\n  // ... then go back in time...\n  let day = history[0]\n  const recordDate = History.roundTime(record.created_at) - History.oneDay\n\n  // ... filling each day with previous state...\n  while (recordDate !== day.time) {\n    day = {\n      time: day.time - History.oneDay,\n      asset: Object.assign({}, day.asset),\n      balance: Object.assign({}, day.balance)\n    }\n    if (day.time === STRONGHOLD_SHUTDOWN) applyStrongholdFix(day)\n    history.unshift(day)\n  }\n\n  // ... and mutating that day after recorded effects.\n  const handler = handle[record.type]\n  if (handler) handler(day, record)\n}\n\nfunction effectsLoopcall (accountId, { filter, breaker }) {\n  const server = cosmicLib.resolve.server()\n  const callBuilder = server\n    .effects()\n    .forAccount(accountId)\n    .order(\"desc\")\n  return loopcall(callBuilder, { filter, breaker })\n}\n\n/**\n * Effect handlers\n */\n\nconst handle = {}\n\nhandle.trade = function (day, record) {\n  const bought = recordToBalance(record, \"bought\")\n  updateBalance(day, bought, -record.bought_amount)\n\n  const sold = recordToBalance(record, \"sold\")\n  updateBalance(day, sold, +record.sold_amount)\n}\n\nhandle.account_credited = function (day, record) {\n  updateBalance(day, recordToBalance(record), -record.amount)\n}\n\nhandle.account_debited = function (day, record) {\n  updateBalance(day, recordToBalance(record), +record.amount)\n}\n\nhandle.trustline_removed = function (day, record) {\n  updateBalance(day, recordToBalance(record), 0)\n}\n\nhandle.trustline_created = function (day, record) {\n  const balance = recordToBalance(record)\n  if (day.balance[balance.id] !== 0) {\n    console.error(\"Balances mismatch: \", day.balance[balance.id], record)\n  }\n  delete day.balance[balance.id]\n\n  const asset = assetForBalance(balance, day)\n  if (day.asset[asset.id] === 0) delete day.asset[asset.id]\n}\n\nhandle.account_created = function (day) {\n  day.balance.XLM = 0\n  day.asset.XLM = 0\n}\n\nfunction updateBalance (day, balance, amount) {\n  updateData(day.balance, balance.id, amount)\n  const asset = assetForBalance(balance, day)\n  updateData(day.asset, asset.id, amount)\n}\n\nfunction updateData (data, id, amount) {\n  if (!data[id]) data[id] = 0\n  data[id] = Math.max(0, fixed7(data[id] + amount))\n}\n\nfunction recordToBalance (record, prefix) {\n  const codeKey = prefix ? `${prefix}_asset_code` : \"asset_code\"\n  const issuerKey = prefix ? `${prefix}_asset_issuer` : \"asset_issuer\"\n\n  if (!record[codeKey]) return Balance.resolve(\"XLM\")\n  else return Balance.resolve(record[codeKey], record[issuerKey])\n}\n\n/**\n * Special cases\n */\n\nconst STRONGHOLD_KEY1 =\n  \"GBSTRH4QOTWNSVA6E4HFERETX4ZLSR3CIUBLK7AXYII277PFJC4BBYOG\"\nconst STRONGHOLD_KEY2 =\n  \"GBSTRUSD7IRX73RQZBL3RQUH6KS3O4NYFY3QCALDLZD77XMZOPWAVTUK\"\nconst STRONGHOLD_SHUTDOWN = 1556582400000\n\n/**\n * Account for Stronhold balances until they redeemed their tether the\n * 2019-04-30.\n */\nfunction applyStrongholdFix (day) {\n  for (let asset in day.asset) {\n    const anchor = asset.substr(-56)\n    if (anchor === STRONGHOLD_KEY1 || anchor === STRONGHOLD_KEY2) {\n      const id = asset.split(\":\")[0]\n      updateData(day.asset, id, day.asset[asset])\n      delete day.asset[asset]\n    }\n  }\n}\n\n/**\n * Return **balance**'s asset at `day.time`, which may not be the same as today\n * as anchors have been shutdown/unpegged in the past.\n */\nfunction assetForBalance (balance, day) {\n  // Optimizations.\n  if (balance.asset.id.length < 60) return balance.asset\n  if (day.time > STRONGHOLD_SHUTDOWN) return balance.asset\n\n  switch (balance.anchor.pubkey) {\n  case STRONGHOLD_KEY1:\n  case STRONGHOLD_KEY2:\n    return Asset.table[balance.code] || balance.asset\n  }\n  return balance.asset\n}\n","\"use strict\"\n\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\n\n/**\n * Bind **$input**'s **nodeKey** to **object** **objKey**. If **nodeKey** is not\n * provided, the default value is used.\n */\nmodule.exports = function bindnodeKey (object, objKey, $input, nodeKey) {\n  const binder = bind[$input.tagName]\n  if (binder) binder(object, objKey, $input, nodeKey)\n  else object[objKey] = $input[nodeKey || \"value\"]\n}\n\n/**\n * Element-specific binders\n */\nconst bind = {}\n\nbind.SELECT = function (object, objKey, $select, nodeKey = \"value\") {\n  object[objKey] = $select[nodeKey]\n  if (bind.SELECT.interactive.indexOf(nodeKey) !== -1) {\n    importKeyOn(\"change\", object, objKey, $select, nodeKey)\n  }\n}\nbind.SELECT.interactive = [\"selectedIndex\", \"selectedOptions\", \"value\"]\n\nbind.TEXTAREA = function (object, objKey, $textarea, nodeKey = \"value\") {\n  object[objKey] = $textarea[nodeKey]\n  if (nodeKey === \"value\") {\n    importKeyOn(\"input\", object, objKey, $textarea, nodeKey)\n  }\n}\n\nbind.INPUT = function (object, objKey, $input, nodeKey) {\n  object[objKey] = $input[nodeKey]\n  if ($input.type === \"radio\") {\n    bind.radio(...arguments)\n  } else if ($input.type === \"checkbox\") {\n    bind.checkbox(...arguments)\n  } else if (!nodeKey || nodeKey === \"value\") {\n    importKeyOn(\"input\", object, objKey, $input, nodeKey || \"value\")\n  }\n}\n\nbind.radio = function (object, objKey, $radio) {\n  const setter = () => {\n    if ($radio.checked) object[objKey] = $radio.value\n  }\n  $radio.addEventListener(\"change\", setter)\n  setter()\n}\n\nbind.checkBox = function (object, objKey, $checkbox, nodeKey = \"checked\") {\n  object[objKey] = $checkbox[nodeKey]\n  if (nodeKey === \"checked\") {\n    importKeyOn(\"change\", object, objKey, $checkbox, nodeKey)\n  }\n}\n\n/**\n * Event setter.\n */\nfunction importKeyOn (eventName, object, objKey, $input, nodeKey) {\n  $input.addEventListener(eventName, () => {\n    object[objKey] = $input[nodeKey]\n    $input.setCustomValidity(\"\")\n  })\n  if (object instanceof Projectable) {\n    object.link(objKey, $input, nodeKey, null, { init: false })\n  }\n}\n","\"use strict\"\n\nconst { timeout } = require(\"@cosmic-plus/jsutils/es5/misc\")\n\nconst html = require(\"./html-extra\")\n\n/**\n * Walk **$node** tree and handle extra attributes for each domNode. Extra\n * attributes are:\n *\n * * alias:  Define an identifier for the local context.\n * * label:  Enclose the node into a dedicated label element.\n */\nmodule.exports = function walkNodeTree ($node) {\n  const aliases = {}\n  html.walk($node, handleExtraAttributes, aliases)\n  return aliases\n}\n\nfunction handleExtraAttributes ($node, aliases) {\n  setAliases($node, aliases)\n  handleLabel($node)\n  handleValidate($node)\n}\n\n/**\n * Bind **$node** to **aliases** properties for to its className, alias, name\n * and/or id.\n */\nfunction setAliases ($node, aliases) {\n  // Ordered by priority\n  if ($node.className) {\n    if (!aliases[$node.className]) aliases[$node.className] = []\n    aliases[$node.className].push($node)\n  } else if ($node.alias) {\n    aliases[$node.alias] = $node\n    delete aliases[$node.alias]\n  } else if ($node.name) {\n    aliases[$node.name] = $node\n  } else if ($node.id) {\n    aliases[$node.id] = $node\n  }\n}\n\n/**\n * Enclose **$node** into its own label if it has a `label=` attribute.\n */\nfunction handleLabel ($node) {\n  // `<option>` tags have a `label` attribute in HTML5.\n  if (!$node.label || $node.tagName === \"OPTION\") return\n\n  const $label = html.element(\"label\", { for: $node })\n  const $span = html.element(\"span\", $node.label)\n  html.replace($node, $label)\n  html.append($label, $span, $node)\n  delete $node.label\n}\n\n/**\n * Setup automatic validation using **$node**'s validate function.\n */\nfunction handleValidate ($node) {\n  const validate = $node.validate\n  if (!validate || !$node.hasProperty(\"oninput\")) return\n\n  $node.addEventListener(\"input\", () => {\n    $node.setCustomValidity(\"\")\n    timeout(0).then(() => validateNodeValue($node, validate))\n  })\n  delete $node.validate\n}\n\nfunction validateNodeValue ($node, validate) {\n  try {\n    validate($node.value)\n  } catch (error) {\n    $node.setCustomValidity(error.message)\n    $node.reportValidity()\n    console.error(error)\n  }\n}\n","\"use strict\"\n/**\n * Activity Gui\n */\n\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst ActiveOffersTable = require(\"./widgets/active-offers-table\")\nconst global = require(\"./logic/global\")\n\n/**\n * Class\n */\n\nmodule.exports = class ActivityGui extends Gui {\n  constructor (portfolio) {\n    super(`\n<section class=\"ActivityGui\">\n  <h2>${__(\"Activity\")}</h2>\n\n  %table\n\n  <p class=\"note\">\n    ${__(\"All orders are passed against Stellar Lumens (XLM).\")}\n    ${__(\n    \"For your comfort, prices are displayed in their %%globalCurrency equivalent.\"\n  )}\n    ${__(\n    \"However, those converted values will change according to XLM price movement.\"\n  )}\n  </p>\n\n</section>\n    `)\n\n    this.portfolio = portfolio\n    this.table = new ActiveOffersTable(portfolio)\n    this.globalCurrency = global.currency\n  }\n}\n","\"use strict\"\n/**\n * Active Offers Table\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst { CosmicLink } = require(\"cosmic-lib\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst global = require(\"../logic/global\")\n\nmodule.exports = class ActiveOffersTable extends Gui {\n  constructor (portfolio) {\n    super(`\n<section class=\"ActiveOffersTable\">\n  <table>\n    <tr>\n      <th class=\"name\">${__(\"Name\")}</th>\n      <th align=\"left\">${__(\"Anchor\")}</th>\n      <th align=\"left\">${__(\"Direction\")}</th>\n      <th align=\"right\">${__(\"Amount\")}</th>\n      <th align=\"right\">${__(\"Price\")} (%globalCurrency)</th>\n    </tr>\n    %toOfferRow:offers...\n    <tr><td colspan=\"5\" align=\"center\" onclick=%cancelOffers>\n      <h3>${__(\"Cancel All\")}</h3>\n    </td></tr>\n  </table>\n</section>\n    `)\n\n    this.portfolio = portfolio\n    this.offers = portfolio.offers\n    this.globalCurrency = global.currency\n  }\n\n  toOfferRow (offer) {\n    return new OfferRow(offer)\n  }\n\n  cancelOffers () {\n    if (!this.offers.length) return\n\n    const txParams = {\n      memo: \"Equilibre.io\",\n      network: \"public\",\n      maxTime: \"+5\",\n      source: this.portfolio.accountId\n    }\n\n    const cosmicLink = new CosmicLink(txParams)\n    this.offers.forEach(offer => {\n      cosmicLink.addOperation(\"manageOffer\", { offerId: offer.id, amount: 0 })\n    })\n\n    const sideFrame = cosmicLink.open()\n    sideFrame.listen(\"destroy\", () => {\n      this.portfolio.getAccount()\n      this.portfolio.offers.get()\n    })\n  }\n}\n\nclass OfferRow extends Gui {\n  constructor (offer) {\n    super(`\n<tr>\n  <td>\n    <img src=%image alt=\"\">\n    <span>%name</span>\n  </td>\n  <td>%anchor</td>\n  <td>%side</td>\n  <td align=\"right\">%nice:amount</td>\n  <td align=\"right\">%nice:price</td>\n</tr>\n    `)\n\n    this.offer = offer\n    offer.project([\"amount\", \"price\"], this)\n\n    this.name = offer.balance.code\n    this.side = offer.side === \"buy\" ? __(\"Buy\") : __(\"Sell\")\n    this.anchor = offer.balance.anchor.name\n    offer.asset.link(\"image\", this)\n  }\n\n  nice (number) {\n    return nice(number)\n  }\n}\n","\"use strict\"\n/**\n * Portfolio Graphical User Interface\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst Tabs = require(\"@cosmic-plus/domutils/es5/tabs\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst AssetPriceChart = require(\"./widgets/asset-price-chart\")\nconst PortfolioPieChart = require(\"./widgets/portfolio-pie-chart\")\nconst PortfolioHistoricValueChart = require(\"./widgets/portfolio-historic-value-chart\")\nconst PortfolioTable = require(\"./widgets/portfolio-table\")\n\nconst global = require(\"./logic/global\")\n\n/**\n * Class\n */\n\nmodule.exports = class PortfolioGui extends Gui {\n  constructor (portfolio) {\n    super(`\n<section><h2>${__(\"Portfolio\")}: %total %currency</h2>\n\n  %nav\n  <section>%view</section>\n\n  %priceChart\n\n  <p class=\"note\">\n    ${__(\"Anchor prices are from Stellar DEX\")} /\n    ${__(\"Global prices are from %%coingecko when available.\")}\n  </p>\n\n</section>`)\n\n    this.portfolio = portfolio\n\n    // Init.\n    portfolio.project(\"total\", this, x => nice(x, 2))\n    this.currency = global.currency\n    this.coingecko = new Gui(\n      `<a target=\"_blank\" rel=\"noopener\" href=\"https://coingecko.com\">coingecko</a>`\n    )\n\n    // Bind components together.\n    this.table = new PortfolioTable(portfolio)\n    this.project(\"selected\", this.table)\n    this.table.project(\"selected\", this)\n\n    this.pieChart = new PortfolioPieChart(portfolio)\n    this.project(\"selected\", this.pieChart)\n    this.pieChart.project(\"selected\", this)\n\n    this.trap(\"selected\", () => this.maybeDrawPriceChart())\n\n    // Create history chart.\n    this.historyChart = new PortfolioHistoricValueChart(portfolio)\n\n    // Create overview.\n    const overview = this.overview = new Tabs()\n    overview.add(\"table\", __(\"Balances\"), this.table)\n    overview.add(\"chart\", __(\"Repartition\"), this.pieChart)\n    overview.add(\"history\", __(\"History\"), this.historyChart)\n\n    overview.project([\"nav\", \"view\"], this)\n    overview.listen(\"select\", () => this.reflow())\n\n    // Save & load last selected tab.\n    overview.listen(\"select\", id => localStorage[\"PortfolioSummary.tab\"] = id)\n    overview.select(localStorage[\"PortfolioSummary.tab\"])\n    if (!overview.selected) overview.select(\"table\")\n  }\n\n  reflow () {\n    if (!this.overview.selected) return\n    const content = this.overview.selected.content\n    if (content.reflow) content.reflow()\n  }\n\n  maybeDrawPriceChart () {\n    if (this.priceChart) this.priceChart.destroy()\n\n    const asset = this.selected\n    const assetHasChart = asset && (asset.isTether || asset.apiId)\n\n    if (assetHasChart && asset.code !== global.currency) {\n      this.priceChart = new AssetPriceChart(asset)\n    } else {\n      this.priceChart = null\n    }\n  }\n}\n","\"use strict\"\n/**\n * Asset Price Chart\n */\nconst Highstock = require(\"highcharts/highstock\")\nrequire(\"./helpers/highstock-theme\")\n\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst global = require(\"../logic/global\")\n\n/**\n * Class\n */\n\nmodule.exports = class AssetPriceChart extends Gui {\n  constructor (asset) {\n    super(`\n      <section><h3>${asset.code} ${__(\"to\")} ${global.currency}</h3>\n        <div -ref=%container><p>${__(\"Loading...\")}</p></div>\n      </section>\n    `)\n\n    this.asset = asset\n\n    asset.getHistoricPrice().then(data => this.drawChart(data))\n    this.listen(\"destroy\", () => this.chart && this.chart.destroy())\n  }\n\n  drawChart (data) {\n    this.chart = Highstock.stockChart(this.container, {\n      yAxis: [\n        { labels: { align: \"left\" }, height: \"80%\", resize: { enabled: true } },\n        { labels: { align: \"left\" }, top: \"80%\", height: \"20%\", offset: 0 }\n      ],\n      series: [\n        {\n          type: \"spline\",\n          name: \"Price\",\n          data: data.map(x => [x.time, +nice(x.price)])\n        },\n        {\n          type: \"column\",\n          name: \"Volume\",\n          data: data.map(x => [x.time, x.volume]),\n          yAxis: 1\n        }\n      ]\n    })\n  }\n}\n","\"use strict\"\n/**\n * Portfolio Pie Chart\n */\nconst Highstock = require(\"highcharts/highstock\")\nrequire(\"./helpers/highstock-theme\")\n\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst global = require(\"../logic/global\")\n\n/**\n * Class\n */\n\nmodule.exports = class PortfolioPieChart extends Gui {\n  constructor (portfolio) {\n    super(`\n<div class=\"PortfolioPieChart\">\n  <h3>${__(\"Repartition by Asset\")}</h3>\n\n  <div -ref=%container align=\"center\"></div>\n</div>\n    `)\n    this.portfolio = portfolio\n\n    this.watch(this.portfolio, \"total\", () => this.draw())\n    this.listen(\"destroy\", () => this.chart && this.chart.destroy())\n  }\n\n  reflow () {\n    if (this.chart) this.chart.reflow()\n  }\n\n  draw () {\n    if (this.chart) this.chart.destroy()\n\n    this.chart = Highstock.chart(this.container, {\n      colors: Highstock.pieColors,\n      responsive: Highstock.pieResponsive,\n\n      title: \"\",\n      legend: { enabled: false },\n      chart: { type: \"pie\" },\n      tooltip: {\n        pointFormat: `\n${__(\"Amount\")}: {point.niceAmount} {point.code}<br>\n${__(\"Price\")}: {point.nicePrice} ${global.currency}<br>\n<b>${__(\"Value\")}: {point.y} ${global.currency}</b>\n`\n      },\n\n      plotOptions: {\n        pie: {\n          dataLabels: {\n            format:\n              \"{point.niceAmount} {point.code}<br>({point.percentage:.0f}%)\"\n          },\n          point: {\n            events: {\n              select: x => this.selected = x.target.options.asset,\n              legendItemClick: () => false\n            }\n          }\n        }\n      },\n\n      series: [\n        {\n          name: __(\"Amount\"),\n          colorByPoint: true,\n          ignoreHiddenPoint: true,\n          data: this.portfolio.assets\n            .filter(asset => asset.value)\n            .map(makePoint)\n            .sort((a, b) => b.y - a.y)\n        }\n      ]\n    })\n  }\n}\n\n/**\n * Helpers\n */\n\nfunction makePoint (asset) {\n  const point = Object.create(asset)\n  point.y = +nice(asset.value, 2)\n  point.niceAmount = +nice(asset.amount)\n  point.nicePrice = +nice(asset.price)\n  return point\n}\n","\"use strict\"\n/**\n * Portfolio Historic Value Chart\n */\nconst Highstock = require(\"highcharts/highstock\")\nrequire(\"./helpers/highstock-theme\")\n\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst Asset = require(\"../logic/asset\")\nconst global = require(\"../logic/global\")\n\n/**\n * Definition\n */\n\nmodule.exports = class PortfolioHistoryChart extends Gui {\n  constructor (portfolio) {\n    super(`\n<div class=\"PortfolioHistoryChart\">\n  <h3>${__(\"Portfolio Historical Value\")}</h3>\n\n  <div -ref=%container>\n    <p>\n      ${__(\"Downloading historical data...\")}\n      <span class=\"spinner\"></span>\n    </p>\n    <p>\n      ${__(\"The very first time, it may take about a minute.\")}\n  </div>\n\n</div>\n    `)\n\n    this.portfolio = portfolio\n    this.portfolio.getHistory().then(history => this.drawChart(history))\n    this.listen(\"destroy\", () => this.chart && this.chart.destroy())\n  }\n\n  reflow () {\n    if (this.chart) {\n      // Work around a rangeSelector position bug.\n      if (!this.hasBeenReflown) {\n        setTimeout(() =>\n          this.chart.update({ rangeSelector: { enabled: true } })\n        )\n      }\n      this.chart.reflow()\n    }\n    this.hasBeenReflown = true\n  }\n\n  drawChart (history) {\n    const series = this.historyToSeries(history)\n\n    this.chart = Highstock.stockChart(this.container, {\n      chart: { type: \"area\" },\n\n      navigator: {\n        series: {\n          data: history.map(x => [x.time, +nice(x.total) || null])\n        }\n      },\n\n      tooltip: {\n        shared: true,\n        split: false,\n        pointFormat: `\n<span style=\"color:{point.color}\">\\u25CF</span>\n{series.name}: {point.percentage:.0f}%\n<br>`,\n        footerFormat: `<b>Total: {point.total} ${global.currency}</b>`\n      },\n\n      yAxis: [\n        {\n          labels: {\n            align: \"left\",\n            formatter: function () {\n              return `${this.value} ${global.currency}`\n            }\n          },\n          resize: { enabled: true }\n        }\n      ],\n\n      plotOptions: {\n        series: {},\n        area: {\n          stacking: \"normal\",\n          connectNulls: true,\n          lineWidth: 0,\n          states: {\n            hover: { enabled: false },\n            inactive: { enabled: false }\n          }\n        }\n      },\n\n      series,\n      colors: Highstock.pieColors\n    })\n\n    // Work around a rangeSelector position bug.\n    if (!this.hasBeenReflown) {\n      this.chart.update({ rangeSelector: { enabled: false } })\n    }\n  }\n\n  historyToSeries (history) {\n    const series = []\n\n    const assets = Object.values(Asset.table).filter(a => a.hasBeenHeld)\n    assets.sort((a, b) => b.value - a.value)\n\n    // Main assets historical values.\n    assets.forEach(asset => {\n      let isEmpty = true\n      const data = history.map(day => {\n        const value = +nice(day.filtered[asset.id], 2) || null\n        if (value) isEmpty = false\n        return [day.time, value]\n      })\n      if (!isEmpty) series.push({ name: asset.id, data })\n    })\n\n    // Add merged marginal balances.\n    series.push({\n      name: __(\"Others\"),\n      color: \"#DDD\",\n      data: history.map(x => [x.time, +nice(x.filtered.others, 2)])\n    })\n\n    return series\n  }\n}\n","\"use strict\"\n/**\n * Portfolio Table\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\n/**\n * Class\n */\nmodule.exports = class PortfolioTable extends Gui {\n  constructor (portfolio) {\n    super(`\n<table class=\"PortfolioTable\">\n  <tr>\n    <th class=\"name\">${__(\"Name\")}</th>\n    <th align=\"left\">${__(\"Anchor\")}</th>\n    <th align=\"right\">${__(\"Amount\")}</th>\n    <th align=\"right\">${__(\"Price\")}</th>\n    <th align=\"right\">${__(\"Value\")}</th>\n  </tr>\n  %rows...\n</table>\n`)\n\n    this.portfolio = portfolio\n    this.rows = portfolio.assets.mirror(asset => this.toAssetRow(asset))\n    this.watch(portfolio, \"total\", () => this.sort())\n    this.trap(\"selected\", () => this.onselect(this.selected))\n  }\n\n  toAssetRow (asset) {\n    const row = new AssetRow(asset)\n    row.domNode.onclick = () => {\n      if (this.selected === row.asset) this.selected = null\n      else this.selected = row.asset\n    }\n    return row\n  }\n\n  sort () {\n    this.rows.sort((a, b) => b.asset.value - a.asset.value)\n  }\n\n  onselect (asset) {\n    if (this.selectedRow) this.selectedRow.simpleView()\n    this.selectedRow = this.rows.find(row => row.asset === asset)\n    if (this.selectedRow) this.selectedRow.detailledView()\n  }\n}\n\nclass AssetRow extends Gui {\n  constructor (asset) {\n    super(`\n<tr %class>\n  <td align=\"left\">\n    <img src=%image alt=\"\">\n    <span>%name</span>\n  </td>\n  <td align=\"left\">\n    <div hidden=%simple>%anchors...</div>\n    <div class=%mode>%anchorTotal</div>\n  </td>\n  <td align=\"right\">\n    <div hidden=%simple>%amounts...</div>\n    <div class=%mode>%amountTotal</div>\n  </td>\n  <td align=\"right\">\n    <div hidden=%simple>%prices...</div>\n    <div class=%mode title=%priceDetails>%priceTotal</div>\n  </td>\n  <td align=\"right\">\n    <div hidden=%simple>%values...</div>\n    <div class=%mode>%valueTotal</div>\n  </td>\n</tr>\n    `)\n\n    this.asset = asset\n\n    this.name = asset.code\n    this.anchors = asset.balances.mirror(x => cell(x.anchor, \"name\"))\n    this.amounts = asset.balances.mirror(x => cell(x, \"amount\", nice))\n    this.prices = asset.balances.mirror(x => priceCell(x, \"price\", nice))\n    this.values = asset.balances.mirror(x => cell(x, \"value\", x => nice(x, 2)))\n    asset.link(\"image\", this)\n    asset.link(\"amount\", this, \"amountTotal\", nice)\n    asset.link(\"price\", this, \"priceTotal\", nice)\n    asset.link(\"value\", this, \"valueTotal\", x => nice(x, 2))\n    asset.balances.feed(this, \"anchorHeader\", anchorName)\n\n    const orderbook = this.asset.orderbook\n    this.define(\"priceDetails\", \"orderbook\", () => priceDetails(orderbook))\n    this.watch(orderbook, [\"bestAsk\", \"bestBid\", \"spread%\"], () => {\n      this.compute(\"priceDetails\")\n    })\n\n    this.simpleView()\n  }\n\n  simpleView () {\n    this.simple = true\n    this.class = \"\"\n    this.mode = \"\"\n    this.anchorTotal = this.anchorHeader\n  }\n\n  detailledView () {\n    this.simple = false\n    this.class = \"selected\"\n    this.mode = \"footer\"\n    this.anchorTotal = \"Total\"\n  }\n}\n\n/**\n * Helpers\n */\n\nfunction anchorName (balances) {\n  if (balances.length === 1) return balances[0].anchor.name\n  else return `${__(\"multiple\")} (${balances.length})`\n}\n\nfunction cell (object, key, func) {\n  const node = html.create(\"div\", null, object[key])\n  object.link(key, node, \"textContent\", func)\n  return node\n}\n\nfunction priceCell (object, key, func) {\n  const node = cell(object, \"price\", func)\n  object.trap(\"orderbook\", () => {\n    if (object.orderbook) {\n      object.orderbook.trap([\"bestAsk\", \"bestBid\", \"spread%\"], () => {\n        node.title = priceDetails(object.orderbook)\n      })\n    }\n  })\n  return node\n}\n\nfunction priceDetails (orderbook) {\n  if (orderbook.base.code === \"XLM\") return \"\"\n  return `\nBuy: ${nice(orderbook.bestBid)} \\\n- Sell: ${nice(orderbook.bestAsk)} \\\n- Spread: ${nice(orderbook[\"spread%\"], 2)}%\n  `\n}\n","\"use strict\"\n/**\n * Settings Graphical User Interface\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst Form = require(\"./helpers/form\")\nconst global = require(\"./logic/global\")\n\n/**\n * Available translations.\n */\nconst languages = {\n  us: \"English\",\n  fr: \"Franais\"\n}\n\n/**\n * Possible reference currencies.\n */\nconst currencies = [\n  \"AUD\",\n  \"BRL\",\n  \"CAD\",\n  \"CHF\",\n  \"CNY\",\n  \"CZK\",\n  \"DKK\",\n  \"EUR\",\n  \"GBP\",\n  \"HKD\",\n  \"HUF\",\n  \"IDR\",\n  \"ILS\",\n  \"INR\",\n  \"JPY\",\n  \"KRW\",\n  \"MXN\",\n  \"MYR\",\n  \"NOK\",\n  \"NZD\",\n  \"PHP\",\n  \"PLN\",\n  \"RUB\",\n  \"SEK\",\n  \"SGD\",\n  \"THB\",\n  \"TRY\",\n  \"USD\",\n  \"ZAR\"\n]\n\n/**\n * Class\n */\n\nclass SettingsGui extends Gui {\n  constructor () {\n    super(`\n      <section><h2>${__(\"Settings\")}</h2>\n        <section><h3>${__(\"General Settings\")}</h3>\n          <hr>\n          %general\n        </section>\n      </section>\n    `)\n\n    this.general = new GeneralSettings(global)\n  }\n}\n\nclass GeneralSettings extends Form {\n  constructor (global) {\n    super(\n      Form.selector({\n        label: __(\"Language\"),\n        name: \"language\",\n        values: languages\n      }),\n      Form.selector({\n        label: __(\"Currency\"),\n        name: \"currency\",\n        values: currencies\n      })\n    )\n\n    // Two-way binding.\n    global.project([\"currency\", \"language\"], this)\n    this.project([\"currency\", \"language\"], global)\n\n    // Refresh interface.\n    this.listen(\"change\", () => location.reload())\n  }\n}\n\n/**\n * Export\n */\n\nmodule.exports = SettingsGui\n","\"use strict\"\n/**\n * Target Graphical User Interface\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst Dialog = require(\"./helpers/dialog\")\nconst Target = require(\"./logic/target\")\nconst TargetSetup = require(\"./widgets/target-setup\")\nconst TargetsControls = require(\"./widgets/targets-controls\")\nconst TargetsTable = require(\"./widgets/targets-table\")\n\n/**\n * Class\n */\n\nmodule.exports = class RebalanceGui extends Gui {\n  constructor (portfolio) {\n    super(`\n<section class=\"RebalanceGui\">\n  <h2>${__(\"Rebalance\")}</h2>\n\n  %table\n\n  %controls\n\n</section>\n    `)\n\n    this.portfolio = portfolio\n\n    // Load & bind template from localStorage.\n    const targetKey = `target:${portfolio.account.id}`\n    const template = localStorage[targetKey]\n    this.target = Target.forPortfolio(portfolio, template)\n    this.target.link(\"json\", localStorage, targetKey, null, { init: false })\n    this.target.json = this.target.toJson()\n\n    // Targets table.\n    this.table = new TargetsTable(this.target)\n    this.table.project(\"selected\", this)\n    this.project(\"selected\", this.table)\n\n    // Controls.\n    this.controls = new TargetsControls(this.target)\n\n    this.trap(\"selected\", () => {\n      if (this.selected) this.showTargetSetup(this.selected)\n    })\n  }\n\n  async showTargetSetup (target) {\n    const setup = new TargetSetup(target)\n    const dialog = Dialog.confirm({ content: setup })\n\n    if (await dialog) setup.confirm()\n    else setup.cancel()\n\n    this.selected = null\n    target.computeAll()\n  }\n}\n","\"use strict\"\n/**\n * Modal boxes helper\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\n\nconst ClickWall = require(\"./click-wall\")\n\n/**\n * Definition\n */\n\nclass Modal extends Gui {\n  constructor (params = {}) {\n    super(`\n<div class=\"Modal\" %style %hidden>%content</div>\n    `)\n\n    Object.assign(this.style, Modal.style)\n    this.hidden = true\n    this.content = params.content\n\n    // Handle styling parameters.\n    this.trap(Modal.styleParams, event => this.style[event.key] = event.value)\n    Modal.styleParams.forEach(key => this[key] = params[key])\n\n    // Initialization.\n    document.body.insertBefore(this.domNode, document.body.firstChild)\n  }\n\n  setPosition () {\n    const translate = { x: 0, y: 0 }\n    if (!this.left && !this.right) {\n      this.style.left = \"50%\"\n      translate.x = \"-50%\"\n    }\n    if (!this.top && !this.bottom) {\n      this.style.bottom = \"50%\"\n      translate.y = \"50%\"\n    }\n    this.style.transform = `translate(${translate.x}, ${translate.y})`\n  }\n\n  async open () {\n    Modal.clickWall.enable()\n\n    this.hidden = false\n    this.setPosition()\n\n    await Modal.shadow.enable()\n    Modal.shadow.onclick = () => this.close()\n\n    Modal.clickWall.disable()\n    this.trigger(\"open\")\n  }\n\n  async close () {\n    Modal.clickWall.enable()\n\n    this.hidden = true\n    await Modal.shadow.disable()\n\n    Modal.clickWall.disable()\n    this.trigger(\"close\")\n    this.destroy()\n  }\n}\n\n/**\n * Configuration\n */\n\nModal.styleParams = [\n  \"height\",\n  \"width\",\n  \"top\",\n  \"right\",\n  \"bottom\",\n  \"left\",\n  \"padding\"\n]\n\nModal.style = {\n  zIndex: 1000,\n  position: \"fixed\"\n}\n\nModal.shadow = new ClickWall({\n  scrollbar: \"hide\",\n  opacity: 0.3,\n  delay: 300\n})\n\nModal.clickWall = new ClickWall()\nModal.clickWall.domNode.style.zIndex = \"2000\"\n\n/**\n * Export\n */\nmodule.exports = Modal\n","\"use strict\"\n/**\n * Target class.\n *\n * A (portfolio) Target object represents a statically or dynamically allocated\n * target slice of the user portfolio. It is a theoric goal that the rebalancing\n * process aims to reach as much as possible.\n *\n * A Target may be composed by several Target subentries, in such a way that the\n * complete portfolio balancing target ends up being a tree made of Targets.\n */\nconst Mirrorable = require(\"@cosmic-plus/jsutils/es5/mirrorable\")\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\n\nconst Asset = require(\"./asset\")\nconst Balance = require(\"./balance\")\nconst Order = require(\"./order\")\n\nconst strategy = require(\"./strategy\")\nconst {\n  arrayContains,\n  arrayRemove,\n  arraySum,\n  fixed7,\n  positive\n} = require(\"../helpers/misc\")\n\n/**\n * Definition\n */\n\nclass Target extends Projectable {\n  constructor (asset) {\n    super()\n\n    if (asset) {\n      this.asset = asset\n      this.mode = \"ignore\"\n      this.order = Order.rebalance(this)\n\n      asset.target = this\n      this.watch(asset, \"value\", () => this.compute(\"valueDiff\"))\n\n      // Asset with 0 amount won't trigger recompute by moving portfolio total\n      // value.\n      this.watch(asset, \"price\", () => {\n        if (!this.asset.amount && this.size) this.computeAll()\n      })\n\n      // Operations on trustlines.\n      this.opening = []\n      this.closing = []\n\n      // XLM is never ignored.\n      if (asset.id === \"XLM\") {\n        this.mode = \"weight\"\n        this.size = 1\n      }\n    } else {\n      this.childs = new Mirrorable()\n      this.childs.listen(\"add\", child => child.parent = this)\n      this.childs.listen(\"change\", () => this.computeAll())\n    }\n\n    // Normalize & compute\n    this.trap(\"size\", () => {\n      if (this.size) {\n        this.size = positive(this.size)\n        if (this.mode === \"percentage\") this.size = Math.min(100, this.size)\n      }\n      this.computeAll()\n    })\n  }\n\n  get root () {\n    if (this.parent) return this.parent.root\n    else return this\n  }\n}\n\nTarget.define(\"name\", [\"group\", \"asset\"], function () {\n  return this.group || this.asset.id\n})\nTarget.define(\"modified\", [\"json\"], function () {\n  return this.hasChanged()\n})\nTarget.define(\"valueDiff\", [\"value\", \"asset\"], function () {\n  return this.asset && this.value - this.asset.value\n})\nTarget.define(\"valueDiffP\", \"valueDiff\", function () {\n  return this.value ? this.valueDiff / this.value : null\n})\nTarget.define(\"amountDiff\", [\"amount\"], function () {\n  return fixed7(this.amount - this.asset.amount)\n})\nTarget.define(\"amountDelta\", [\"amountDiff\"], function () {\n  return Math.abs(this.amountDiff)\n})\n// Gets computed by \"strategy.js\".\nTarget.define(\"share\", null, function () {\n  return this.value / this.root.portfolio.total\n})\nTarget.define(\"shareDiff\", [\"share\"], function () {\n  return this.share - this.asset.share\n})\n\n/**\n * Actions\n */\n\nTarget.prototype.computeAll = function () {\n  if (this.parent) {\n    this.root.computeAll()\n  } else if (this.portfolio && this.portfolio.total) {\n    try {\n      this.error = null\n      this.value = this.portfolio.total\n      this.compute(\"modified\")\n      strategy.apply(this)\n    } catch (error) {\n      this.error = error.message\n      console.error(error)\n    }\n    this.trigger(\"update\")\n  }\n}\n\n/**\n * Add a target for **asset** into portfolio.\n */\nTarget.prototype.addAsset = function (asset) {\n  if (!this.childs) throw new Error(\"Target is not a group: \", target)\n  if (asset.target) throw new Error(\"Asset already has a target: \", asset)\n\n  // Add asset & target to current portfolio.\n  const target = new Target(asset)\n  target.parent = this\n  asset.anchors\n    .filter(anchor => !anchor.unpeg)\n    .forEach(anchor => target.addAnchor(anchor))\n  this.childs.push(target)\n\n  // Default setup.\n  target.mode = \"weight\"\n  target.size = 1\n\n  return target\n}\n\n/**\n * Open a new trustline then fund the new position.\n */\nTarget.prototype.addAnchor = function (anchor) {\n  const code = anchor.tetherCode(this.asset.code)\n  const issuer = anchor.pubkey\n  const balance = Balance.resolve(code, issuer)\n\n  if (balance.action === \"closing\") {\n    arrayRemove(this.closing, issuer)\n    balance.action = null\n  } else {\n    this.root.portfolio.maybeAddBalance(balance)\n    this.opening.push(issuer)\n    balance.action = \"opening\"\n  }\n\n  this.root.compute(\"modified\")\n  this.order.refresh()\n}\n\n/**\n * Begin anchor liquidation process, remove the trustline once done.\n */\nTarget.prototype.removeAnchor = function (anchor) {\n  const code = anchor.tetherCode(this.asset.code)\n  const issuer = anchor.pubkey\n  const balance = Balance.resolve(code, issuer)\n\n  if (balance.action === \"opening\") {\n    this.root.portfolio.maybeRemoveBalance(balance)\n    arrayRemove(this.opening, issuer)\n    balance.action = null\n  } else {\n    this.closing.push(issuer)\n    balance.action = \"closing\"\n  }\n\n  this.root.compute(\"modified\")\n  this.order.refresh()\n}\n\n/**\n * Utilities\n */\n\n/**\n * Return deterministically sorted **target** childs without mutating source\n * object.\n */\nTarget.sortChilds = function (target) {\n  const childs = target.childs.slice()\n  return childs.sort((a, b) => a.name.localeCompare(b.name))\n}\n\n/**\n * Source: Portfolio\n */\n\nTarget.forPortfolio = function (portfolio, json) {\n  const target = json ? Target.fromJson(json) : new Target()\n  target.portfolio = portfolio\n\n  portfolio.target = target\n  target.watch(portfolio, \"total\", () => target.computeAll())\n\n  // Add/Remove assets after trustline change.\n  portfolio.assets.forEach(asset => {\n    if (\n      !target.childs.find(child => asset === child.asset)\n      && asset.isSupported\n    )\n      target.childs.push(new Target(asset))\n  })\n  target.childs.forEach((child, index) => {\n    if (\n      !portfolio.assets.find(asset => asset === child.asset)\n      || !child.asset.isSupported\n    )\n      target.childs.splice(index, 1)\n  })\n  portfolio.assets.listen(\"add\", asset => {\n    if (asset.isValid) target.childs.push(new Target(asset))\n  })\n  portfolio.assets.listen(\"remove\", asset => {\n    const index = target.childs.findIndex(child => child.asset === asset)\n    target.childs.splice(index, 1)\n  })\n\n  return target\n}\n\n/**\n * Format: JSON\n */\n\nTarget.fromJson = function (json) {\n  const object = JSON.parse(json)\n  const target = Target.fromObject(object)\n  target.json = json\n  return target\n}\n\nTarget.prototype.toJson = function (beautifyFlag) {\n  const object = this.toObject()\n  return JSON.stringify(object, null, beautifyFlag && 2)\n}\n\nTarget.prototype.hasChanged = function () {\n  return this.toJson() !== (this.json || \"{\\\"childs\\\":[]}\")\n}\n\n/**\n * Format: Object\n */\n\nTarget.fromObject = function (object) {\n  if (typeof object === \"string\") object = { asset: object }\n\n  // Create Target instance.\n  const asset = object.asset && Asset.resolve(object.asset)\n  const target = new Target(asset)\n  target.size = object.size\n  target.mode = object.mode\n\n  // Conversion from versions <= 0.5  REMOVAL: 2020-05 (one year).\n  if (target.mode === \"equal\") target.mode = \"weight\"\n  if (target.mode === \"skip\") target.mode = \"ignore\"\n\n  // Fix for versions <= 0.6.1 - REMOVAL: 2020-06 (one year).\n  if (target.asset && target.asset.id === \"XLM\" && target.mode === \"ignore\") {\n    target.mode = \"weight\"\n    target.size = 1\n  }\n\n  // Set defaults.\n  if (!target.mode) target.mode = \"weight\"\n  if (target.size == null && target.mode === \"weight\") target.size = 1\n\n  // Group Target: Parse childs.\n  if (object.childs) {\n    target.group = object.group\n    const childs = object.childs.map(entry => Target.fromObject(entry))\n\n    // Conversion from versions <= 0.5  REMOVAL: 2020-05 (one year).\n    //\n    // When there was no \"equal\" target, percentage targets whose sum is under\n    // 100 would act like \"weight\".\n    const percentChilds = childs.filter(child => child.mode === \"percentage\")\n    if (\n      percentChilds.length\n      && !childs.find(child => child.mode === \"weight\")\n      && arraySum(percentChilds, \"size\") !== 100\n    ) {\n      percentChilds.forEach(child => child.mode = \"weight\")\n    }\n\n    target.childs.push(...childs)\n  } else {\n    // Asset Target: Deal with trustline opening/closing.\n    const balances = target.asset.balances\n    if (object.opening) target.opening = object.opening\n    if (object.closing) target.closing = object.closing\n\n    balances.forEach(balance => {\n      const issuer = balance.anchor.pubkey\n      if (arrayContains(target.closing, issuer)) {\n        // Trustline is still not closed.\n        balance.action = \"closing\"\n      } else {\n        // Trustline has been opened.\n        arrayRemove(target.opening, issuer)\n      }\n    })\n\n    // Trustline has been closed.\n    target.closing.forEach(issuer => {\n      if (!balances.find(balance => balance.anchor.pubkey === issuer)) {\n        arrayRemove(target.closing, issuer)\n      }\n    })\n\n    // No balance for asset.\n    if (!balances.length) asset.target = null\n  }\n\n  return target\n}\n\nTarget.prototype.toObject = function () {\n  if (this.mode === \"ignore\") return\n\n  // Parameters reduction.\n  let object = { mode: this.mode, size: this.size }\n  if (object.mode === \"weight\") {\n    delete object.mode\n    if (object.size === 1) delete object.size\n  }\n\n  // Asset target.\n  if (this.asset) {\n    object.asset = this.name\n    if (this.opening.length) object.opening = this.opening\n    if (this.closing.length) object.closing = this.closing\n    if (Object.keys(object).length === 1) object = object.asset\n\n    // Group target.\n  } else if (this.childs) {\n    object.group = this.group\n    const childs = Target.sortChilds(this)\n    object.childs = childs.map(target => target.toObject()).filter(x => x)\n  }\n\n  return object\n}\n\n/**\n * Format: CosmicLink\n */\n\nTarget.prototype.toCosmicLink = function () {\n  if (this !== this.root) {\n    throw new Error(\"Only root target can be converted to CosmicLink\")\n  }\n\n  // Create operations.\n  const operations = this.toOperations()\n\n  // Set outdated offers to be replaced.\n  const outdated = this.portfolio.offers.listOutdated()\n  const remaining = []\n\n  operations.forEach(o => o.offer.id = null)\n  outdated.forEach(offer => {\n    const operation = operations.find(o => o.offer.balance === offer.balance)\n    if (operation) operation.offer.id = offer.id\n    else remaining.push(offer)\n  })\n\n  operations.forEach(operation => {\n    if (!operation.offer.id && remaining.length) {\n      operation.offer.id = remaining.pop().id\n    }\n  })\n\n  // Create CosmicLink.\n  const cosmicLink = Order.operationsToCosmicLink(operations)\n\n  // Close outdated offers which are not replaced.\n  remaining.forEach(offer => {\n    cosmicLink.tdesc.operations.unshift({})\n    cosmicLink.setOperation(0, \"manageOffer\", { offerId: offer.id, amount: 0 })\n  })\n\n  // Open/close trustlines.\n  this.portfolio.balances\n    .filter(b => b.asset.target)\n    .forEach(balance => {\n      if (shouldOpenTrustline(balance)) {\n        cosmicLink.tdesc.operations.unshift({})\n        cosmicLink.setOperation(0, \"changeTrust\", { asset: balance.id })\n      }\n      if (shouldCloseTrustline(balance)) {\n        cosmicLink.tdesc.operations.unshift({})\n        cosmicLink.setOperation(0, \"changeTrust\", {\n          asset: balance.id,\n          limit: 0\n        })\n      }\n    })\n\n  return cosmicLink.tdesc.operations.length ? cosmicLink : null\n}\n\nfunction shouldOpenTrustline (balance) {\n  if (balance.asset.target.mode === \"remove\") return false\n  else return balance.action === \"opening\"\n}\n\nfunction shouldCloseTrustline (balance) {\n  if (!balance.hasTrustline) return false\n  else\n    return (\n      balance.amount === 0 && balance.action === \"closing\"\n      || balance.asset.target.mode === \"remove\" && balance.asset.amount === 0\n    )\n}\n\n/**\n * Format: Operations\n */\nTarget.prototype.toOperations = function () {\n  if (this.childs) {\n    return [].concat(...this.childs.map(child => child.toOperations()))\n  } else if (this.order) {\n    return this.order.operations\n  } else {\n    return []\n  }\n}\n\n/**\n * Export\n */\n\nmodule.exports = Target\n","\"use strict\"\n/**\n * Order class\n */\n\nconst cosmicLib = require(\"cosmic-lib\")\nconst CosmicLink = cosmicLib.CosmicLink\nconst Mirrorable = require(\"@cosmic-plus/jsutils/es5/mirrorable\")\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst global = require(\"./global\")\nconst {\n  positive,\n  negative,\n  fixed7,\n  clamp,\n  absoluteMin,\n  arraySum,\n  arrayScale\n} = require(\"../helpers/misc\")\n\n/**\n * Class\n */\n\nconst Order = module.exports = class Order extends Projectable {\n  static rebalance (target) {\n    if (target.asset.code === \"XLM\") return\n\n    const order = new Order(\"balance\", target.asset.orderbook, target)\n    order.watch(target, \"amount\", () => order.refresh())\n    order.watch(target.asset.orderbook, [\"bids\", \"asks\"], () => order.refresh())\n    target.asset.offers.listen(\"change\", () => order.refresh(), order)\n\n    return order\n  }\n\n  constructor (type, orderbook, ...parameters) {\n    super()\n    this.type = type\n    this.method = Order.type[this.type]\n    this.operations = new Mirrorable()\n    this.orderbook = orderbook\n    this.parameters = parameters\n\n    this.operations.listen(\"update\", () => {\n      this.compute([\"cosmicLink\", \"description\"])\n    })\n\n    this.refresh()\n  }\n\n  refresh () {\n    this.operations.splice(0, this.operations.length)\n    this.operations.trigger(\"update\")\n    this.method(this, ...this.parameters)\n    this.trigger(\"refresh\")\n  }\n\n  /**\n   * Operations Management\n   */\n\n  getOperation (offer, make) {\n    const id = `${offer.balance.anchor.name}:${make ? offer.price : \"take\"}`\n    const operation = this.operations.find(x => x.id === id)\n    if (operation) {\n      return operation\n    } else {\n      const newOperation = { id }\n      this.operations.push(newOperation)\n      return newOperation\n    }\n  }\n\n  addOperation (offer, amount) {\n    const operation = this.getOperation(offer, amount > 0)\n    this.setOperation(operation, offer, Number(amount) || operation.amount)\n  }\n\n  setOperation (operation, offer, amount) {\n    operation.amount = fixed7(amount)\n    operation.cost = amount * offer.price\n    operation.offer = offer\n    this.operations.trigger(\"update\")\n  }\n}\n\nOrder.define(\"description\", \"operations\", function () {\n  return Order.operationsToDescription(this.operations)\n})\n\n/**\n * Utilities\n */\n\nOrder.operationsToCosmicLink = function (operations = []) {\n  // Create CosmicLink.\n  const cosmicLink = new CosmicLink({\n    network: \"public\",\n    memo: \"Equilibre.io\",\n    maxTime: \"+5\",\n    source: global.portfolio.accountId\n  })\n\n  // Set operations.\n  operations.forEach(operation => {\n    cosmicLink.addOperation(\"manageOffer\", operationToOdesc(operation))\n  })\n\n  return cosmicLink\n}\n\nOrder.operationsToDescription = function (operations = []) {\n  const desc = []\n  operations.forEach(op => {\n    if (operationDirection(op) === \"buy\") {\n      desc.push(`\n${__(\"Buy\")} ${nice(op.amount)} ${op.offer.balance.code} ${__(\"at\")} \\\n${nice(op.offer.price)} ${global.currency}\n      `)\n    } else {\n      desc.push(`\n${__(\"Sell\")} ${nice(op.amount)} ${op.offer.balance.code} ${__(\"at\")} \\\n${nice(op.offer.price)} ${global.currency}\n      `)\n    }\n  })\n  return desc\n}\n\n/**\n * Helpers\n */\n\nfunction operationDirection (op) {\n  if (\n    op.amount > 0 && op.offer.side === \"bids\"\n    || op.amount < 0 && op.offer.side === \"asks\"\n  ) {\n    return \"buy\"\n  } else {\n    return \"sell\"\n  }\n}\n\nfunction operationToOdesc (operation) {\n  const offer = operation.offer\n  const base = offer.balance.code + \":\" + offer.balance.anchor.pubkey\n  const quote = \"XLM\"\n\n  let odesc\n  if (operationDirection(operation) === \"buy\") {\n    odesc = {\n      buying: base,\n      selling: quote,\n      amount: fixed7(operation.amount * offer.price_r.n / offer.price_r.d),\n      price: { n: offer.price_r.d, d: offer.price_r.n }\n    }\n  } else {\n    odesc = {\n      buying: quote,\n      selling: base,\n      amount: operation.amount,\n      price: offer.price_r\n    }\n  }\n  odesc.offerId = operation.offer.id\n\n  return odesc\n}\n\n/**\n * Orders types\n */\n\nOrder.type = {}\n\nOrder.type.market = function (order, size) {\n  if (!size) return\n\n  const side = size > 0 ? \"asks\" : \"bids\"\n  const amount = Math.abs(size)\n  const offer = order.orderbook.findOffer(side, offer => {\n    return offer.baseVolume > amount\n  })\n  order.addOperation(offer, amount)\n}\n\nOrder.type.limit = function (order, size, { orderbook, filter }) {\n  if (!size) return\n\n  const side = size > 0 ? \"bids\" : \"asks\"\n  const offer = (orderbook || order.orderbook).findOffer(side, filter)\n  if (offer) order.addOperation(tightenSpread(offer), Math.abs(size))\n}\n\n/**\n * Rebalancing\n */\n\nOrder.type.balance = function (order, target) {\n  const asset = target.asset\n  const orderbook = asset.orderbook\n\n  // Requirements\n\n  if (target.amount == null || target.amountDelta === 0) return\n\n  if (!orderbook.isFetched()) {\n    order.description = [__(\"Fetching orderbook...\")]\n    return\n  }\n\n  if (asset.liabilities) {\n    const currentOffers = asset.offers.filter(offer => !offer.outdated)\n    if (currentOffers.length) {\n      order.description = [__(\"Rebalancing...\")]\n      return\n    }\n  }\n\n  // Rebalancing\n\n  setBalancesTargets(target)\n  if (!areTargetAnchorsBalanced(target)) {\n    balanceTargetAnchors(target, target.amountDiff)\n  } else if (isOneOperationEnough(target, target.amountDiff)) {\n    addOneOperation(target, target.amountDiff)\n  } else {\n    addMultipleOperations(target, target.amountDiff)\n  }\n}\n\n/**\n * Set the `targetAmount` property of **target** balances according to\n * `target.amount`.\n */\nfunction setBalancesTargets (target) {\n  // Empty orderbooks cannot be traded.\n  const balances = []\n  target.asset.balances.forEach(balance => {\n    if (balance.orderbook.price == null || !balance.isActive) {\n      balance.targetAmount = null\n    } else {\n      balances.push(balance)\n    }\n  })\n\n  // Special cases.\n  if (!balances.length) {\n    return\n  } else if (balances.length === 1) {\n    return balances[0].targetAmount = target.amount\n  }\n\n  // Set each balance tradable amount.\n  const targetAmount = fixed7(target.amount / balances.length)\n  balances.forEach(balance => balance.targetAmount = targetAmount)\n}\n\n/**\n * Returns whether or not **target** asset anchors current funds are risk\n * balanced.\n */\nfunction areTargetAnchorsBalanced (target) {\n  const balances = target.asset.balances\n  return !(arraySum(balances, \"underMin\") && arraySum(balances, \"overMax\"))\n}\n\n/**\n * Create a set of operations that even out anchor amounts of `target.asset`.\n */\nfunction balanceTargetAnchors (\n  target,\n  size = target.amountDiff,\n  riskMax = global.anchorsRebalanceRiskMax\n) {\n  const balances = target.asset.balances\n\n  // Compute the amount to transfer between anchors.\n  const under = -arraySum(balances, \"underMin\")\n  const over = arraySum(balances, \"overMax\")\n  const misallocated = Math.max(under - positive(size), over + negative(size))\n\n  // Eventually limit risk by capping that amount.\n  const currentRisk = Math.abs(target.valueDiffP)\n  const amountCap = target.amount * positive(riskMax - currentRisk)\n  const transferAmount = Math.min(misallocated, amountCap)\n\n  // Factor in the amount of asset to buy/sell to balance portfolio.\n  const buy = fixed7(transferAmount + positive(size))\n  const sell = fixed7(transferAmount - negative(size))\n\n  // Generate operations accordingly.\n  addMultipleOperations(target, buy)\n  addMultipleOperations(target, -sell)\n}\n\n/**\n * Returns whether or not it is possible meet **target** rebalancing target in\n * one operation.\n */\nfunction isOneOperationEnough (target, size) {\n  const balances = target.asset.balances\n  return !!balances.filter(b => b.sizeMin <= size && size <= b.sizeMax).length\n}\n\n/**\n * Adds an operation to `target.order` that trades **size** `target.asset` on\n * **orderbook**.\n */\nfunction addOneOperation (target, size, orderbook = target.asset.orderbook) {\n  const noMinValue = target.mode === \"quantity\" || target.amount === 0\n  const baseAsk = orderbook.asks[0].basePrice\n  if (!noMinValue && Math.abs(size * baseAsk) < global.minOfferValue) return\n\n  const filter = makeOfferFilter(target, size)\n  Order.type.limit(target.order, size, { orderbook, filter })\n}\n\n/**\n * Split a trade over multiple anchors.\n */\nfunction addMultipleOperations (target, size) {\n  const balances = target.asset.balances\n  let tradeSize = 0,\n    trade = balances.map(() => 0)\n\n  // 1. Sell balances being closed.\n  if (negative(size)) {\n    const liquidate = balances.map(balance => {\n      return balance.action === \"closing\" ? -balance.amount : 0\n    })\n    tradeSize = _addToTrade(trade, liquidate, size)\n  }\n\n  // 2. If this was not enough, trade imbalanced anchors.\n  const misallocatedKey = positive(size) ? \"underMin\" : \"overMax\"\n  if (tradeSize !== size) {\n    const misallocated = balances.map(balance => {\n      return balance.action === \"closing\" ? 0 : -balance[misallocatedKey]\n    })\n    tradeSize = _addToTrade(trade, misallocated, size - tradeSize)\n  }\n\n  // 3. If this was not enough, trade balanced anchors.\n  if (tradeSize !== size) {\n    const sizeKey = positive(size) ? \"sizeMax\" : \"sizeMin\"\n    const tradable = balances.map(balance => {\n      if (balance.action === \"closing\") return 0\n      else return balance[sizeKey] - balance[misallocatedKey]\n    })\n    _addToTrade(trade, tradable, size - tradeSize)\n  }\n\n  // Create operations according to **trade**.\n  balances.forEach((balance, index) => {\n    const size = fixed7(trade[index])\n    addOneOperation(target, size, balance.orderbook)\n  })\n}\n\n/**\n * Adds **amounts** to **trade**, which is an array of trade sizes. Caps summed\n * **trade** sizes to **sizeMax**. Returns the summed **trade** size.\n */\nfunction _addToTrade (trade, amounts, sizeMax) {\n  const amountsSum = arraySum(amounts)\n  const tradeSize = absoluteMin(sizeMax, amountsSum)\n  const toBeAdded = arrayScale(amounts, tradeSize)\n  toBeAdded.forEach((value, index) => trade[index] += value)\n  return +nice(arraySum(trade), 7)\n}\n\n/**\n * Returns a balancing offer filter for **tradedAmount** to be used with\n * `Orderbook.findOffer()`.\n */\nfunction makeOfferFilter (target, size) {\n  return offer => {\n    return (\n      size >= offer.balance.sizeMin\n      && size <= offer.balance.sizeMax\n      && offer.baseVolume > Math.abs(size) * global.skipMarginalOffers\n    )\n  }\n}\n\n/**\n * Create a copy of **offer** with a delta to global market price reduced by\n * **percentage**.\n */\nfunction tightenSpread (offer, percentage = global.spreadTightening) {\n  const clone = Object.assign({}, offer)\n  const diff = percentage * offer.balance.asset.orderbook[\"spread%\"] / 100\n\n  if (offer.side === \"bids\") clone.price = offer.price * (1 + diff)\n  else clone.price = offer.price * (1 - diff)\n\n  if (offer.balance.asset.globalPrice) clampOfferPrice(clone)\n  updateOfferPriceR(clone)\n\n  return clone\n}\n\n/**\n * Floor/ceil **offer**'s price between global market price and a **premium**.\n * **premium** soft cap is given in argument; hard cap is the average anchor\n * price.\n */\nfunction clampOfferPrice (offer, premium = global.maxSpread / 2) {\n  const globalPrice = offer.balance.asset.price\n  const anchorPrice = offer.balance.orderbook.price\n\n  if (offer.side === \"bids\") {\n    const minPrice = Math.min(anchorPrice, globalPrice * (1 - premium))\n    offer.price = clamp(offer.price, minPrice, globalPrice)\n  } else {\n    const maxPrice = Math.max(anchorPrice, globalPrice * (1 + premium))\n    offer.price = clamp(offer.price, globalPrice, maxPrice)\n  }\n}\n\n/**\n * Set `offer.price_r` according to `offer.price`.\n *\n * @param  {Object} offer\n */\nfunction updateOfferPriceR (offer) {\n  const quote = offer.balance.orderbook.quote\n\n  offer.price_r = {\n    n: nice(offer.price * 10000000000, 0),\n    d: nice(quote.price * 10000000000, 0)\n  }\n\n  // Ten characters maximum\n  while (offer.price_r.n > 999999999 || offer.price_r.d > 999999999) {\n    offer.price_r.n = nice(offer.price_r.n / 10, 0)\n    offer.price_r.d = nice(offer.price_r.d / 10, 0)\n  }\n}\n\n/**\n * Append Order.type to Order class\n */\n\nfor (let key in Order.type) {\n  if (!Order[key]) Order[key] = (...parameters) => new Order(key, ...parameters)\n}\n","\"use strict\"\n/**\n * Rebalancing strategies\n */\nconst strategy = exports\n\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst global = require(\"./global\")\nconst { arraySum, fixed7, positive } = require(\"../helpers/misc\")\n\n/**\n * Applicator\n */\n\nstrategy.apply = function (target) {\n  const delayed = []\n  let sum = 0,\n    weights = 0\n\n  target.childs.forEach(child => {\n    const mode = child.mode\n    if (mode === \"weight\") {\n      delayed.push(child)\n      weights += child.size\n    } else {\n      strategy[mode](child)\n      sum += child.value\n    }\n  })\n\n  const remains = positive(target.value - sum)\n  delayed.forEach(child => strategy.weight(child, remains, weights))\n\n  checkAllocationLimits(sum, target.value, delayed.length)\n  maybeThrottleTargetAmounts(target)\n}\n\nfunction checkAllocationLimits (allocated, available, checkUnderFlag) {\n  const margin = global.misallocationTolerance\n\n  if (allocated > available * (1 + margin)) {\n    const over = +nice(allocated - available, 2)\n    const overP = +nice(100 * over / available, 2)\n    let msg = __(\"Rebalance setup is over portfolio value by\")\n    msg += ` ${over} ${global.currency} (${overP}%) `\n    throw new Error(msg)\n  } else if (!checkUnderFlag && allocated < available * (1 - margin)) {\n    const under = +nice(available - allocated, 2)\n    const underP = +nice(100 * under / available, 2)\n    let msg = __(\"Rebalance setup is under portfolio value by\")\n    msg += ` ${under} ${global.currency} (${underP}%) `\n    throw new Error(msg)\n  }\n}\n\n/**\n * When not enough Lumens are available to fully rebalance the portfolio,\n * harmoniously reduce traded amounts in order to reach target in several steps\n * in a risk-managed way.\n */\nfunction maybeThrottleTargetAmounts (target) {\n  // Check if `target.amount` throttling is required.\n  const Asset = require(\"./asset\")\n  const XLM = Asset.resolve(\"XLM\")\n  const targets = target.childs.filter(t => t.asset !== XLM)\n  const liquidity = XLM.value - XLM.valueMin\n\n  const buyTargets = targets.filter(t => t.valueDiff > 0)\n  const buyValue = arraySum(buyTargets, \"valueDiff\")\n\n  if (liquidity > buyValue) return\n\n  // Throttle `target.amount`.\n  const sellTargets = targets.filter(t => t.valueDiff < 0)\n  const sellValue = -arraySum(sellTargets, \"valueDiff\")\n\n  const canSell = XLM.target.value - XLM.valueMin\n  const throttleRatio = 1 - positive(canSell / sellValue)\n\n  targets.forEach(child => {\n    child.amount = fixed7(child.amount - child.amountDiff * throttleRatio)\n  })\n\n  if (throttleRatio > 0.95) {\n    throw new Error(__(\"The XLM share is too low\"))\n  }\n}\n\n/**\n * Strategies\n */\n\nstrategy.amount = function (target) {\n  target.amount = target.size\n  target.value = target.amount * target.asset.price\n  target.compute(\"share\")\n}\n\nstrategy.ignore = function (target) {\n  target.value = target.asset.value\n  target.amount = target.asset.amount\n  target.compute(\"share\")\n}\n\nstrategy.remove = function (target) {\n  target.amount = 0\n  target.value = 0\n  target.compute(\"share\")\n}\n\nstrategy.percentage = function (target) {\n  strategy.weight(target, target.parent.value, 100)\n}\n\nstrategy.weight = function (target, remains, weights) {\n  if (!weights) {\n    target.value = target.amount = 0\n  } else {\n    target.value = target.size * remains / weights\n    target.amount = fixed7(target.value / target.asset.price)\n  }\n  target.compute(\"share\")\n}\n","\"use strict\"\n/**\n * Target Setup Form\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\n\nconst Anchor = require(\"../logic/anchor\")\nconst TargetSetupAnchors = require(\"./target-setup-anchors\")\nconst TargetSetupSize = require(\"./target-setup-size\")\nconst { arrayOnlyInFirst } = require(\"../helpers/misc\")\n\n/** Definition **/\n\nmodule.exports = class TargetSetup extends Gui {\n  constructor (target) {\n    super(`\n<div class=\"TargetSetup\">\n  <h3>%name</h3>\n  <hr>\n\n  %sizeSetup\n  %anchorsSetup\n\n</div>\n    `)\n\n    this.target = target\n    this.backup = {\n      size: target.size,\n      mode: target.mode,\n      opening: target.opening.slice(),\n      closing: target.closing.slice()\n    }\n\n    this.name = target.asset.name\n    this.sizeSetup = new TargetSetupSize(target)\n\n    if (this.target.asset.anchors.length > 1) {\n      this.anchorsSetup = new TargetSetupAnchors(target)\n    }\n  }\n\n  confirm () {\n    this.sizeSetup.maybeSwitchMode()\n\n    const asset = this.target.asset\n    if (asset.id === \"XLM\") {\n      // Use `target.value` as `target.amount` gets modified in throttle mode.\n      if (this.target.value < asset.amountMin * asset.price) {\n        this.target.mode = \"amount\"\n        this.target.size = asset.amountMin\n      }\n    }\n\n    this.close()\n  }\n\n  cancel () {\n    this.target.mode = this.backup.mode\n    this.target.size = this.backup.size\n\n    const opened = arrayOnlyInFirst(\n      this.target.opening,\n      this.backup.opening\n    ).concat(arrayOnlyInFirst(this.backup.closing, this.target.closing))\n    opened\n      .map(Anchor.resolve)\n      .forEach(anchor => this.target.removeAnchor(anchor))\n\n    const closed = arrayOnlyInFirst(\n      this.target.closing,\n      this.backup.closing\n    ).concat(arrayOnlyInFirst(this.backup.opening, this.target.opening))\n    closed.map(Anchor.resolve).forEach(anchor => this.target.addAnchor(anchor))\n\n    this.close()\n  }\n\n  close () {\n    document.activeElement.blur()\n    this.sizeSetup.destroy()\n    if (this.anchorsSetup) this.anchorsSetup.destroy()\n    this.destroy()\n  }\n}\n","\"use strict\"\n/**\n * Target Setup Anchors\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\n/* Definition */\n\nmodule.exports = class TargetSetupAnchors extends Gui {\n  constructor (target) {\n    super(`\n<fieldset class=\"TargetSetupAnchors\">\n  <legend>${__(\"Anchor\")}:</legend>\n  %toAnchorCheckbox:anchors...\n</fieldset>\n  `)\n\n    this.target = target\n    this.anchors = target.asset.anchors.filter(anchor => {\n      const portfolio = target.root.portfolio\n      return !anchor.unpeg || doesPortfolioUseAnchor(portfolio, anchor)\n    })\n  }\n\n  toAnchorCheckbox (anchor) {\n    return new AnchorCheckbox(anchor, {\n      getState: () => isTargetAnchorActive(this.target, anchor),\n      callback: this.switchAnchor.bind(this)\n    })\n  }\n\n  switchAnchor (anchor, checked) {\n    if (checked) {\n      this.target.addAnchor(anchor)\n    } else if (areTwoOrMoreAnchorsActive(this.target)) {\n      this.target.removeAnchor(anchor)\n    }\n  }\n}\n\nfunction doesPortfolioUseAnchor (portfolio, anchor) {\n  return portfolio.balances.find(b => b.anchor === anchor)\n}\n\nfunction isTargetAnchorActive (target, anchor) {\n  const balance = target.asset.balances.find(b => b.anchor === anchor)\n  return balance && balance.isActive\n}\n\nfunction areTwoOrMoreAnchorsActive (target) {\n  const count = target.asset.balances.reduce((sum, balance) => {\n    return balance.isActive ? sum + 1 : sum\n  }, 0)\n  return count > 1\n}\n\nclass AnchorCheckbox extends Gui {\n  constructor (anchor, params = {}) {\n    const { getState, callback } = params\n\n    super(`\n<span class=\"AnchorCheckbox half\">\n  <input -ref=%checkbox type=\"checkbox\" %checked>\n  <label -ref=%label %onclick>%name</label>\n</span>\n`)\n    this.name = anchor.name\n    this.checked = getState()\n\n    this.onclick = () => {\n      callback(anchor, !this.checked)\n      this.checked = getState()\n    }\n  }\n}\n","\"use strict\"\n/**\n * Target Setup Size\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\n\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\n/** Definition **/\n\nmodule.exports = class TargetSetupSize extends Gui {\n  constructor (target) {\n    super(`\n<fieldset class=\"TargetSetupSize\">\n  <legend>${__(\"Size\")}:</legend>\n\n  <input autofocus class=\"half\" type=\"number\" step=\"any\" min=\"0\" %max\n    value=%size placeholder=%share onchange=%maybeSwitchMode>\n\n  <select class=\"half\" onchange=%setMode value=%mode>\n    <option value=\"weight\">${__(\"Weight\")}</option>\n    <option value=\"percentage\">${__(\"Percentage\")}</option>\n    <option value=\"amount\">${__(\"Amount\")}</option>\n    <option value=\"ignore\" hidden=%targetIsXlm>${__(\"Ignore\")}</option>\n    <option value=\"remove\" hidden=%targetIsXlm>${__(\"Remove\")}</option>\n  </select>\n\n</fieldset>\n    `)\n\n    this.target = target\n    this.targetIsXlm = target.asset.id === \"XLM\"\n\n    target.project(\"share\", this, x => nice(100 * x, 2))\n\n    target.project(\"size\", this)\n    this.project(\"size\", target, x => x != null ? Number(x) : null)\n\n    target.project(\"mode\", this)\n    this.project(\"mode\", target)\n  }\n\n  maybeSwitchMode () {\n    if (this.size == 0) {\n      this.mode = \"amount\"\n    } else if (!this.size) {\n      if (this.mode !== \"remove\") this.mode = \"ignore\"\n    } else if (this.mode === \"ignore\" || this.mode === \"remove\") {\n      this.mode = \"percentage\"\n      this.target.computeAll()\n    }\n  }\n\n  setMode () {\n    // TODO: Move this logic to Target model.\n    switch (this.mode) {\n    case \"weight\":\n      this.size = 1\n      this.max = null\n      break\n    case \"percentage\":\n      this.size = +nice(100 * this.target.asset.share, 2)\n      this.max = 100\n      break\n    case \"amount\":\n      this.size = this.target.asset.amount\n      this.max = null\n      break\n    case \"ignore\":\n    case \"remove\":\n      this.target.set(\"size\", null)\n      break\n    }\n  }\n}\n","\"use strict\"\n/**\n * Targets Controls\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\n/**\n * Class\n */\n\nmodule.exports = class TargetsControls extends Gui {\n  constructor (target) {\n    super(`\n<section class=\"TargetControls\">\n  <form onsubmit=\"return false\" hidden=%hideRebalance>\n    <button onclick=%rebalance disabled=%invalid>${__(\"Rebalance\")}</button>\n  </form>\n\n  <form onsubmit=\"return false\" hidden=%hideSave>\n    <button onclick=%save disabled=%invalid>${__(\"Save\")}</button>\n    <button onclick=%cancel>${__(\"Cancel\")}</button>\n  </form>\n\n  %toParagraph:error\n</section>\n    `)\n\n    this.target = target\n    target.project([\"error\", \"modified\"], this)\n\n    this.define(\"hideRebalance\", [\"modified\"], () => this.modified)\n    this.define(\"hideSave\", [\"modified\"], () => !this.modified)\n    this.define(\"invalid\", [\"error\"], () => !!this.error)\n  }\n\n  toParagraph (error) {\n    if (error) return html.create(\"p\", \".error\", error)\n  }\n\n  cancel () {\n    location.reload()\n  }\n\n  save () {\n    this.target.json = this.target.toJson()\n  }\n\n  rebalance () {\n    const cosmicLink = this.target.toCosmicLink()\n\n    if (cosmicLink) {\n      const sideFrame = cosmicLink.open()\n      sideFrame.listen(\"destroy\", () => {\n        this.target.portfolio.getAccount()\n        this.target.portfolio.offers.get()\n      })\n    }\n  }\n}\n","\"use strict\"\n/**\n * Targets Table\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst AssetSelector = require(\"./asset-selector\")\nconst Dialog = require(\"../helpers/dialog\")\n\n/**\n * Definition\n */\n\nmodule.exports = class TargetsTable extends Gui {\n  constructor (target) {\n    super(`\n<section class=\"TargetsTable\">\n  <table>\n    <tr>\n      <th class=\"name\">${__(\"Name\")}</th>\n      <th align=\"right\">${__(\"Goal\")}</th>\n      <th align=\"right\">${__(\"Divergence\")}</th>\n      <th align=\"right\">${__(\"Operation\")}</th>\n    </tr>\n\n    %targets...\n\n    <tr><td colspan=\"4\" align=\"center\" onclick=%addAsset>\n      <h3>${__(\"Add Asset\")}</h3>\n    </td></tr>\n\n  </table>\n</section>\n    `)\n\n    this.target = target\n\n    this.targets = target.childs.mirror(child => this.toTargetRow(child))\n    this.selected = undefined\n\n    target.listen(\"update\", () => this.sortTargets())\n    this.sortTargets()\n  }\n\n  toTargetRow (target) {\n    const row = new TargetRow(target)\n    row.domNode.onclick = () => this.selected = target\n    return row\n  }\n\n  sortTargets () {\n    this.targets.sort((a, b) => {\n      a = a.target\n      b = b.target\n      if (b.mode === \"ignore\" && a.mode !== \"ignore\") return -1\n      else if (a.mode === \"ignore\" && b.mode !== \"ignore\") return 1\n      if (b.mode === \"remove\" && a.mode !== \"remove\") return -1\n      else if (a.mode === \"remove\" && b.mode !== \"remove\") return 1\n      return b.value - a.value || a.asset.code.localeCompare(b.asset.code)\n    })\n  }\n\n  async addAsset () {\n    const assets = this.target.portfolio.availableAssets().filter(a => a.show)\n\n    const assetSelector = new AssetSelector(assets)\n    const dialog = Dialog.confirm({\n      title: __(\"Pick an Asset\"),\n      content: assetSelector\n    })\n\n    if (await dialog && assetSelector.selected) {\n      this.target.addAsset(assetSelector.selected)\n    }\n  }\n}\n\nclass TargetRow extends Gui {\n  constructor (target) {\n    super(`\n<tr class=\"TargetRow\">\n  <td align=\"left\">\n    <img src=%image alt=\"\">\n    <span>%name</span>\n  </td>\n  <td align=\"right\">%command</td>\n  <td align=\"right\">%toPercent:shareDiff</td>\n  <td align=\"right\">%toDiv:description...</td>\n</tr>\n    `)\n\n    this.target = target\n    this.name = target.asset.code\n\n    this.define(\"command\", null, () => this.toCommand(target))\n    this.watch(target, [\"size\", \"mode\", \"share\"], () => this.compute(\"command\"))\n\n    target.asset.project(\"image\", this)\n    target.project(\"shareDiff\", this, x => -x)\n\n    if (target.order) target.order.project(\"description\", this)\n  }\n\n  toCommand (target) {\n    switch (target.mode) {\n    case \"ignore\":\n      return __(\"Ignore\")\n    case \"remove\":\n      return __(\"Remove\")\n    case \"amount\":\n      return `${target.size} ${target.asset.code}`\n    case \"weight\":\n      return `${target.size}  ${this.toPercent(target.share)}`\n    case \"percentage\":\n      return this.toPercent(target.share)\n    }\n  }\n\n  toPercent (x) {\n    return !x ? \"-\" : nice(x * 100, 2) + \"%\"\n  }\n\n  toDiv (obj) {\n    return html.create(\"div\", null, obj)\n  }\n}\n","\"use strict\"\n/**\n * Asset Selector\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst Mirrorable = require(\"@cosmic-plus/jsutils/es5/mirrorable\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\n/**\n * Definition\n */\n\nmodule.exports = class AssetSelector extends Gui {\n  constructor (assets) {\n    super(`\n<div class=\"AssetSelector\">\n  %groups...\n</div>\n    `)\n\n    this.groups = new Mirrorable()\n\n    const fiats = assets.filter(a => a.type === \"fiat\")\n    const cryptos = assets.filter(a => a.type === \"crypto\" && a.isTether)\n    const natives = assets.filter(a => a.type === \"crypto\" && !a.isTether)\n\n    this.addGroup(__(\"Fiat Tethers\"), fiats)\n    this.addGroup(__(\"Crypto Tethers\"), cryptos)\n    this.addGroup(__(\"Native Assets\"), natives)\n  }\n\n  addGroup (name, assets) {\n    if (!assets.length) return\n\n    const onselect = asset => this.selected = asset\n    const group = new AssetGroup(name, assets, onselect)\n    this.groups.push(group)\n  }\n}\n\n/**\n * Helpers\n */\n\nclass AssetGroup extends Gui {\n  constructor (name, assets, onselect) {\n    super(`\n<fieldset class=\"AssetGroup\">\n  <legend>%name</legend>\n  %toAssetRadio:assets...\n</fieldset>\n    `)\n\n    this.name = name\n    this.assets = assets\n    this.onselect = onselect\n  }\n\n  toAssetRadio (asset) {\n    return new AssetRadio(asset, () => this.onselect(asset))\n  }\n}\n\nclass AssetRadio extends Gui {\n  constructor (asset, onselect) {\n    super(`\n<span class=\"AssetRadio half\">\n  <input -ref=%radio type=\"radio\" name=\"asset-selector-group\" %onchange>\n  <label -ref=%label for=%radio>\n    <img src=%image>\n    %name\n  </label>\n</span>\n    `)\n\n    this.name = asset.name\n    this.image = asset.image\n    this.onchange = () => this.radio.checked && onselect()\n\n    this.label.for = this.radio\n    this.label.onclick = () => this.radio.click()\n  }\n}\n","module.exports = \"<section>\\n  <h2>What is Equilibre.io?</h2>\\n\\n  <section class=\\\"landing\\\">\\n    <h3>A Portfolio Balancer for Stellar</h3>\\n\\n    <div>\\n\\n    <p>\\n      Equilibre.io is a portfolio balancer for Stellar. In other words, it is\\n      a software which helps you to spread your funds across various\\n      currencies and crypto assets.\\n    </p>\\n\\n    <p>\\n      I initially created it to protect my funds against a possible bear market.\\n      As it proved reliable, I decided to make it publicly available.\\n    </p>\\n\\n    <p>\\n      Equilibre.io is merely a sophisticated front-end for the Stellar\\n      Decentralized exchange: your account, holdings & operations live on the\\n      blockchain.\\n    </p>\\n\\n    <p>\\n      It works a bit like a multi-currency bank account. Except there's no bank.\\n      And you are the only one in control.\\n    </p>\\n\\n    </div>\\n  </section>\\n\\n  <section class=\\\"landing\\\">\\n    <h3>A Risk Management Solution</h3>\\n\\n    <div>\\n    <p>\\n      Equilibre.io can help you to implement what is known as a \\\"balanced\\n      investment strategy\\\". Basically, the idea is that balancing funds over\\n      multiple assets will average a portfolio performance & mitigate the risks.\\n    </p>\\n\\n    <p>\\n      Here's how it works: we choose a number of assets we want to be exposed\\n      to, and we attribute a share of the portfolio to each of them (e.g: 20%\\n      each). Then, we \\\"rebalance\\\" the portfolio on a regular basis. This means\\n      that we pass trades that bring back each asset to its allocated share.\\n    </p>\\n\\n    <p>\\n      It is important to understand that Equilibre.io is not an automated\\n      trading bot, nor a magic-free-money scheme. It is a product made for\\n      people who can decide on their own strategy & who understand the risks\\n      they are taking.\\n    </p>\\n    </div>\\n  </section>\\n\\n  <section class=\\\"landing\\\">\\n    <h3>A Fancy Account Viewer</h3>\\n\\n    <div>\\n    <p>\\n      Equilibre.io offers a live view of the latest blockchain state. It is also\\n      in sync with the latest market data & displays values and historical data\\n      in your national currency.\\n    <p>\\n\\n    <p>\\n      It is one of the few applications (if not the only one) that can retrieves\\n      the complete history of any Stellar account, and pack that data into a\\n      fancy chart.\\n    </p>\\n    </div>\\n  </section>\\n\\n  <section class=\\\"landing\\\">\\n    <h3>A Sophisticated Trading Engine</h3>\\n\\n    <div>\\n    <p>\\n      Equilibre.io is, first of all, a collection of fine-tuned trading\\n      algorithms.  Since a year, I've crash-tested them in every way I could\\n      imagine and packed what worked the best in an easy-to-use interface.\\n    <p>\\n\\n    <p>\\n      It can transform templates such as \\\"I want 50% of my portfolio in BTC and\\n      50% in XLM\\\" into a transaction that passes the required orders. Forget\\n      about trust lines, order books and price picking: all that stuff is dealt\\n      with in the background.\\n    <p>\\n\\n    <p>\\n      The trading engine has a defensive behavior: it prioritizes not losing\\n      money over taking risks to make a profit.\\n    </p>\\n    </div>\\n  </section>\\n\\n\\n  <section class=\\\"landing\\\">\\n    <h3>A New Security Standard for the Years to Come</h3>\\n\\n    <div>\\n    <p>\\n      Equilibre.io strictly enforce cryptography good practices: I certainly\\n      don't want to know about your private key, nor to obtain any kind of\\n      control over your account. <em>Who can protect a house full of gold and\\n      jewels?</em>\\n    </p>\\n\\n    <p>\\n      When you want to rebalance your portfolio, Equilibre.io generates a\\n      transaction request that you can sign using your own wallet. This is\\n      possible thanks to protocols known as CosmicLink &SEP-0007.\\n    </p>\\n\\n    <p>\\n      Those protocols turn any compatible Stellar wallet into something like\\n      Metamask for Ethereum. At that time, only a few services are compatibles.\\n      However, a number of wallets announced their intention to support\\n      transactions requests in the future, including Keybase, Lobster, and\\n      Stargazer.\\n    <p>\\n    </div>\\n  </section>\\n\\n  <section class=\\\"landing\\\">\\n    <h3>A Free Software, as in Freedom</h3>\\n\\n    <div>\\n    <p>\\n      I think that the free software cooperative mindset can go a long way in\\n      improving a project such as Stellar. That's why I released Equilibre.io in\\n      the public domain. Here are some of the benefits of it:\\n    </p>\\n\\n    <p>\\n      Auditability: The software can be proven to contain no malware and no\\n      tracker. It can be audited for flaws & proven safe.\\n    </p>\\n\\n    <p>\\n      Forkability: Any feature implemented by the software becomes <em>de\\n      facto</em> available to every other developer. For example, the code I\\n      wrote to support Ledger Wallets is <a\\n      href=\\\"https://www.npmjs.com/package/@cosmic-plus/ledger-wallet\\\"\\n      target=\\\"_blank\\\" rel=\\\"noopener\\\">freely available to all</a>.\\n    </p>\\n    </div>\\n  </section>\\n\\n</section>\\n\"","module.exports = \"<section>\\n  <h2>Legal Disclaimer</h2>\\n\\n  <section>\\n    <h3>Risks Related to the Use of Equilibre.io</h3>\\n\\n    <p>\\n      The Application author will not be responsible for any losses, damages or\\n      claims arising from any event related to its use, including but not\\n      limited to:\\n    </p>\\n\\n    <p> Mistakes made by the users of the Application.</p>\\n\\n    <p> Software problems of the Application and/or any\\n    related software or service.</p>\\n\\n    <p> Technical failures in the hardware of the users.</p>\\n\\n    <p> Security problems experienced by the users.</p>\\n\\n    <p> Actions or inactions of third parties and/or events experienced by\\n    third parties.</p>\\n  </section>\\n\\n  <section>\\n    <h3>Not an Exchange</h3>\\n\\n    <p>\\n      The Application is not an exchange. It is an independent front-end for the\\n      Stellar Decentralized Exchange. The Application doesn't have any control\\n      over the user's account, assets that can be bought or sell or the exchange\\n      as a whole.\\n    </p>\\n\\n    <p>\\n      The assets made available through the Application have been selected on\\n      the sole basis of the thickness and the daily volumes of their order book.\\n      Their availability in the Application doesn't constitute a guarantee of\\n      any sort. In particular, no research has been conducted about their\\n      fundamentals or their compliance with national laws that may apply\\n      to them or to the users.\\n    </p>\\n\\n    <p>\\n      The Application doesn't pass any transaction on behalf of the users. The\\n      users are solely responsible for the transactions that they are signing\\n      and sending to the blockchain.\\n    </p>\\n  </section>\\n\\n  <section>\\n    <h3>No Guarantee of Profit</h3>\\n\\n    <p>\\n      Past performance may not be indicative of future results. Different types\\n      of investments involve varying degrees of risk, and there can be no\\n      assurance that the future performance of any specific investment,\\n      investment strategy, or product will be profitable, equal any\\n      corresponding indicated historical performance level(s), or be suitable\\n      for your portfolio.\\n   </p>\\n\\n    <p>\\n      The Application doesn't provide investment advice, financial advice,\\n      trading advice, or any other sort of advice, and none of the Application\\n      content should be treated as such. The users are responsible to conduct\\n      their own diligence and consult their financial advisory before making\\n      investment decisions.\\n    </p>\\n  </section>\\n\\n  <section>\\n    <h3>Compliance With Tax Obligations</h3>\\n\\n    <p>\\n      The users of the Application are solely responsible to determinate what,\\n      if any, taxes apply to their transactions. The author of the Application\\n      is NOT responsible for determining the taxes that apply to transactions.\\n    </p>\\n    \\n    <p>\\n      Some countries are taxing investments on a per-transaction basis, which\\n      can heavily affect the performance of strategies involving high quantities\\n      of micro-transactions.\\n    </p>\\n  </section>\\n\\n</section>\\n\\n\"","\"use strict\"\n/**\n * Footer\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst donate = require(\"./helpers/donate\")\nconst Icon = require(\"./helpers/icon\")\n\nconst global = require(\"./logic/global\")\n\n/**\n * Class\n */\n\nclass Footer extends Gui {\n  constructor (icons, links) {\n    super(\n      `\n<footer id=\"footer\" class=\"scrollable\">\n  <div class=\"nobreak\">%icons...</div>\n  %links\n</footer>\n    `,\n      { icons, links }\n    )\n  }\n}\n\n/**\n * Icons\n *\n * SVG from @fortawesome/font-awesome-free\n * CC BY 4.0 License (https://creativecommons.org/licenses/by/4.0/)\n */\n\nconst icons = [\n  new Icon(\n    require(\"@cosmic-plus/assets/svg/cosmic-plus.svg\"),\n    __(\"by Cosmic.plus\"),\n    \"https://cosmic.plus\"\n  ),\n  new Icon(\n    require(\"@fortawesome/fontawesome-free/svgs/brands/twitter.svg\"),\n    __(\"Follow on Twitter\"),\n    \"https://twitter.com/cosmic_plus\"\n  ),\n  new Icon(\n    require(\"@fortawesome/fontawesome-free/svgs/brands/reddit.svg\"),\n    __(\"Follow on Reddit\"),\n    \"https://reddit.com/r/cosmic_plus\"\n  ),\n  new Icon(\n    require(\"@fortawesome/fontawesome-free/svgs/brands/medium.svg\"),\n    __(\"Follow on Medium\"),\n    \"https://medium.com/cosmic-plus\"\n  ),\n  new Icon(\n    require(\"@fortawesome/fontawesome-free/svgs/brands/telegram-plane.svg\"),\n    __(\"Chat on Telegram\"),\n    \"https://t.me/cosmic_plus\"\n  ),\n  new Icon(\n    require(\"@fortawesome/fontawesome-free/svgs/brands/keybase.svg\"),\n    __(\"Chat on Keybase\"),\n    \"https://keybase.io/team/cosmic_plus\"\n  ),\n  new Icon(\n    require(\"@fortawesome/fontawesome-free/svgs/brands/github.svg\"),\n    __(\"GitHub Repository\"),\n    \"https://git.cosmic.plus\"\n  ),\n  new Icon(\n    require(\"@fortawesome/fontawesome-free/svgs/solid/envelope.svg\"),\n    __(\"Contact by Email\"),\n    \"mailto:mister.ticot@cosmic.plus\"\n  ),\n  new Icon(\n    require(\"@cosmic-plus/assets/svg/donate.svg\"),\n    __(\"Donate Lumens\"),\n    donate\n  )\n]\n\n/**\n * Links\n */\nconst links = new Gui(\n  `\n<p>\n  <a onclick=%displayLicense>${__(\"License\")}</a>\n   <a onclick=%displayDisclaimer>${__(\"Disclaimer\")}</a>\n   <a onclick=%displayAbout>${__(\"About\")}</a>\n</p>\n`,\n  {\n    displayLicense: () => global.tabs.select(\"#license\"),\n    displayDisclaimer: () => global.tabs.select(\"#disclaimer\"),\n    displayAbout: () => global.tabs.select(\"#about\")\n  }\n)\n\n/**\n * Create footer\n */\n\nconst footer = new Footer(icons, links)\nhtml.append(document.body, footer)\n","\"use strict\"\n/**\n * Donate Interface\n */\nconst { CosmicLink } = require(\"cosmic-lib\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst MYPUBKEY = \"GC6Z477WPMLJDLMBJPSCTIJA33V7F5EB7ZH5OIKZEUQUBAWKJZH42JVW\"\n\nmodule.exports = function promptDonation () {\n  const amount = prompt(`\\\n${__(\"Equilibre.io runs on donation.\")} \\\n${__(\"Each contribution matters to me.\")} \\\n${__(\"Thank you!\")}\n\n${__(\"Enter an amount (in Lumens)\")}:\\\n`)\n\n  if (amount === \"0\" || isNaN(+amount)) {\n    confirm(`${__(\"Not a valid amount\")}: ${amount}`)\n  } else if (amount) {\n    showDonateFrame(amount)\n  }\n}\n\nfunction showDonateFrame (amount) {\n  const memo = __(\"Donation to Cosmic.plus\")\n  const network = \"public\"\n  const cosmicLink = new CosmicLink({ memo, network }).addOperation(\"payment\", {\n    amount,\n    destination: MYPUBKEY\n  })\n\n  cosmicLink.open()\n}\n","\"use strict\"\n/**\n * Footer Icons\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\n\nclass Icon extends Gui {\n  constructor (image, name, action) {\n    super(`<a -ref=%link class=\"Icon\">%image</a>`)\n\n    this.image = typeof image === \"string\" ? new Gui(image) : image\n    this.link.title = name\n\n    if (typeof action === \"function\") {\n      this.link.onclick = action\n    } else if (typeof action === \"string\") {\n      this.link.href = action\n      if (action.match(/^http/)) {\n        this.link.target = \"_blank\"\n        this.link.rel = \"noopener\"\n      }\n    }\n  }\n}\n\nmodule.exports = Icon\n"],"sourceRoot":""}